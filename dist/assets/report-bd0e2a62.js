import{P as Q,a3 as Dt,r as i,j as e,M as ue,aV as Ke,am as gt,G as X,p as P,T as w,L as q,d as _,aB as yt,B as ft,aO as Ee,aP as jt,D as Ae,aS as mt,a9 as Ue,I as We,Z as wt,x as ye,H as Te}from"./index-76cbadce.js";import{C as Gt}from"./ComponentSkeleton-b7df70e0.js";import{L as Oe}from"./LoadingButton-adb431a8.js";import{_ as ce}from"./react-apexcharts.min-e8e31fda.js";import{u as St,S as Rt,f as Ie,b as Pt}from"./ScrollX-c2c073b0.js";import"./Filter-9d7b8708.js";import{E as Tt,R as Ct}from"./RowEditable-64a00098.js";import"./LinearWithLabel-29bf2ba4.js";import{T as vt,a as bt,b as Lt}from"./TableContainer-0496d285.js";import{T as kt}from"./TableHead-4d0ea02a.js";import{T as $e}from"./TableRow-46b3b72b.js";import{T as Fe}from"./TableCell-e1b69dbf.js";import{S as Et}from"./Slider-9f81ec77.js";import{S as At}from"./SendOutlined-87dacc3b.js";import"./Skeleton-de7aee3d.js";import"./DownloadOutlined-dd73438d.js";import"./CaretUpOutlined-abafc2dd.js";import"./CaretDownOutlined-18dbe8f1.js";import"./Pagination-a4de3615.js";import"./index-9e1f01bf.js";import"./Checkbox-60456d01.js";import"./MinusOutlined-0ba7cfc0.js";import"./visuallyHidden-14c3de6e.js";const Ne=({row:h,table:d})=>{var L;const u=(L=d==null?void 0:d.options)==null?void 0:L.meta,z=Y=>{u==null||u.setSelectedRow(O=>({...O,[h.id]:!O[h.id]})),u==null||u.revertData(h.index,(Y==null?void 0:Y.currentTarget.name)==="cancel")},b=()=>{u==null||u.saveData(h.index)};return e.jsxs(P,{direction:"row",spacing:1,alignItems:"center",children:[(u==null?void 0:u.selectedRow[h.id])&&e.jsx(Ue,{title:"Cancel",children:e.jsx(We,{color:"error",name:"cancel",onClick:z,children:e.jsx(wt,{})})}),e.jsx(Ue,{title:u!=null&&u.selectedRow[h.id]?"Save":"Edit",children:e.jsx(We,{color:u!=null&&u.selectedRow[h.id]?"success":"primary",onClick:u!=null&&u.selectedRow[h.id]?b:z,children:u!=null&&u.selectedRow[h.id]?e.jsx(At,{}):e.jsx(Tt,{})})})]})};Ne.propTypes={row:Q.object,table:Q.object,options:Q.array,id:Q.number,index:Q.number};Q.node,Q.number,Q.number;const Me=Dt("input")({display:"none"});Me.displayName="Input";const fe=h=>{let d=0,u=h.length-1;for(;d<h.length&&Number(h[d])===0;)d++;for(;u>=0&&Number(h[u])===0;)u--;return h.slice(d,u+1)},Ut=(h,d,u)=>h.map(b=>{const L=fe(b.data);return{...b,data:L.slice(0,14)}}),ge=({getValue:h})=>{const d=h();return`${Number((d||0).toFixed(2)).toLocaleString()}`};function re({columns:h,data:d,setData:u}){const[z,b]=i.useState(()=>[...d]),[L,Y]=i.useState({}),O=St({data:d,columns:h,defaultColumn:{cell:Ct},getCoreRowModel:Pt(),meta:{selectedRow:L,setSelectedRow:Y,revertData:(D,m)=>{m?u(V=>V.map((f,F)=>F===D?z[D]:f)):b(V=>V.map((f,F)=>F===D?d[D]:f))},updateData:(D,m,V)=>{u(f=>f.map((F,p)=>p===D?{...f[D],[m]:V}:F))},saveData:async D=>{try{const m=d[D],V=await ye.put(`/api/launchGames/${m._id}`,m);Te({open:!0,message:"Saved successfully!",variant:"alert",alert:{color:"success"}}),Y(f=>({...f,[D]:!1}))}catch{Te({open:!0,message:"Error!",variant:"alert",alert:{color:"error"}})}}},debugTable:!0});let B=[];return O.getAllColumns().map(D=>D.columnDef.accessorKey&&B.push({label:typeof D.columnDef.header=="string"?D.columnDef.header:"#",key:D.columnDef.accessorKey})),e.jsx(ue,{content:!1,children:e.jsx(Rt,{children:e.jsx(vt,{children:e.jsxs(bt,{children:[e.jsx(kt,{children:O.getHeaderGroups().map(D=>e.jsx($e,{children:D.headers.map(m=>e.jsx(Fe,{...m.column.columnDef.meta,children:m.isPlaceholder?null:Ie(m.column.columnDef.header,m.getContext())},m.id))},D.id))}),e.jsx(Lt,{children:O.getRowModel().rows.map(D=>e.jsx($e,{children:D.getVisibleCells().map(m=>e.jsx(Fe,{...m.column.columnDef.meta,children:Ie(m.column.columnDef.cell,m.getContext())},m.id))},D.id))})]})})})})}re.propTypes={columns:Q.array,data:Q.array,setData:Q.func};function Wt({data:h,games:d}){const u=Ke(),[z,b]=i.useState(u.pathname==="/admin/report"),[L,Y]=i.useState([]),[O,B]=i.useState([]),[D,m]=i.useState([]);i.useEffect(()=>{const p=n=>{const o=n.getUTCMonth();return Math.floor(o/3)+1},g=n=>{const K=n.map(W=>new Date(W.summary)).sort((W,U)=>W-U),oe=K[0],je=K[K.length-1],H=oe.getFullYear(),me=p(oe),pe=je.getFullYear(),we=p(je),te=[];for(let W=H;W<=pe;W++)for(let U=1;U<=4;U++)if(!(W===H&&U<me)){if(W===pe&&U>we)break;te.push(`${W}-Q${U}`)}return te},I=[...new Set(h.map(n=>n.summary.split("-")[0]))];if(B(I),h&&h.length>0){const n=g(h);console.log("allQuarters",n),m(n)}const k=Object.values(h.reduce((n,{game:o,summary:K,betsEuro:oe,winsEuro:je,ggrEuro:H,avgBet:me,spins:pe,uniquePlayers:we})=>{n[o]||(n[o]={_id:"",name:o,maxDate:K,years:{},totalGGR:0,latestWeekStart:"",secLatestWeekStart:"",latestWeekGGR:[],secLatestWeekGGR:[],remainDays:0,weekAverage:0,weekChange:0,weekChangeColor:"",dailyTotalGGR:0,projectedTotalGGR:0});const te=d.find(W=>W.name===o);if(n[o].launchDate=te.launchDate,n[o]._id=te._id,new Date(te.launchDate)<=new Date(K)){const W=new Date(n[o].maxDate)<new Date(K);n[o].maxDate=W?K:n[o].maxDate,n[o].dailyTotalGGR=W?H:n[o].dailyTotalGGR,n[o].totalGGR+=H;const U=K.split("-")[0];n[o].years[U]||(n[o].years[U]=0),n[o].years[U]+=H,n[o][`totalGGR_${U}`]||(n[o][`totalGGR_${U}`]=0),n[o][`totalGGR_${U}`]+=H;const Ge=p(new Date(K)),he=`${U}-Q${Ge}`;n[o][`totalGGR_${he}`]||(n[o][`totalGGR_${he}`]=0),n[o][`totalGGR_${he}`]+=H;const Se=new Date(n[o].maxDate),Ce=new Date(Se.getFullYear(),11,31);n[o].remainDays=Math.ceil((Ce-Se)/(1e3*60*60*24));const Re=new Date(n[o].maxDate),se=new Date(Re);se.setDate(se.getDate()-6);const le=new Date(se);le.setDate(le.getDate()-7);const xe=new Date(se);xe.setDate(xe.getDate()-1),n[o].latestWeekStart=se.toISOString().split("T")[0],n[o].secLatestWeekStart=le.toISOString().split("T")[0],n[o].latestWeekGGR=h.filter(T=>T.game===o&&new Date(T.summary)>=se&&new Date(T.summary)<=Re).map(T=>T.ggrEuro),n[o].secLatestWeekGGR=h.filter(T=>T.game===o&&new Date(T.summary)>=le&&new Date(T.summary)<=xe).map(T=>T.ggrEuro),n[o].weekAverage=n[o].latestWeekGGR.reduce((T,Z)=>T+Z,0)/n[o].latestWeekGGR.length,n[o].weekChange=(n[o].latestWeekGGR.reduce((T,Z)=>T+Z,0)-n[o].secLatestWeekGGR.reduce((T,Z)=>T+Z,0))/n[o].secLatestWeekGGR.reduce((T,Z)=>T+Z,0)*100,n[o].weekChangeColor=e.jsx("span",{style:{color:n[o].weekChange>0?"green":"red"},children:`${Number(n[o].weekChange.toFixed(2)).toLocaleString()} %`}),n[o].projectedTotalGGR=n[o].totalGGR+n[o].weekAverage*n[o].remainDays}return n},{}));console.log("gameDatagameDatagameData",k),Y(k)},[h,d]);const V=i.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text",cell:({getValue:p,row:g})=>{const I=p();return e.jsx(q,{style:{textDecoration:"none"},to:z?`/admin/report-one/${g.original._id}`:`/report-one/${g.original._id}`,children:I})}},{header:"Launch Date",accessorKey:"launchDate",dataType:"text",cell:({getValue:p,row:g,table:I})=>{var n;const k=p();return`${(n=k==null?void 0:k.split("T"))==null?void 0:n[0]}`}},{header:"Daily Total GGR",accessorKey:"dailyTotalGGR",dataType:"text",cell:ge},{header:"Projected Total GGR",accessorKey:"projectedTotalGGR",dataType:"text",cell:ge},...(O==null?void 0:O.map(p=>({header:`Total GGR ${p}`,accessorKey:`totalGGR_${p}`,dataType:"text",cell:ge})))||[],{header:"Lifetime GGR",accessorKey:"totalGGR",dataType:"text",cell:ge},{header:"7 Day Average",accessorKey:"weekAverage",dataType:"text",cell:ge},{header:"7 Day Change",accessorKey:"weekChangeColor",dataType:"text"},{header:"Latest Report Date",accessorKey:"maxDate",dataType:"text",cell:({getValue:p,row:g,table:I})=>{var n;const k=p();return`${(n=k==null?void 0:k.split("T"))==null?void 0:n[0]}`}}],[O]),f=i.useMemo(()=>{const p=[];return D.forEach(g=>{const I={quarter:g};L.forEach(k=>{const n=k[`totalGGR_${g}`]!==void 0?k[`totalGGR_${g}`].toFixed(2):0;I[k.name]=n}),p.push(I)}),p},[D,L]),F=i.useMemo(()=>{const p=d.map(g=>g.name);return[{header:"Quarter",accessorKey:"quarter",dataType:"text"},...p.map(g=>({header:g,accessorKey:g,dataType:"number",cell:I=>I.getValue()??0}))]},[d]);return e.jsxs(X,{item:!0,xs:12,lg:12,children:[e.jsxs(X,{container:!0,spacing:2,mb:5,children:[e.jsx(X,{item:!0,xs:6,lg:3,children:e.jsx(ue,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(P,{direction:"row",spacing:1,alignItems:"end",justifyContent:"center",children:[e.jsx(w,{variant:"h5",textAlign:"center",children:"Lifetime GGR - "}),e.jsx(w,{variant:"h6",textAlign:"center",children:Number(L.reduce((p,g)=>p+g.totalGGR,0)).toLocaleString()})]})})}),e.jsx(X,{item:!0,xs:6,lg:3,children:e.jsx(ue,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(P,{direction:"row",spacing:1,alignItems:"end",justifyContent:"center",children:[e.jsx(w,{variant:"h5",textAlign:"center",children:"Daily Total GGR -"}),e.jsx(w,{variant:"h6",textAlign:"center",children:Number(L.reduce((p,g)=>p+g.dailyTotalGGR,0)).toLocaleString()})]})})}),e.jsx(X,{item:!0,xs:6,lg:3,children:e.jsx(ue,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(P,{direction:"row",spacing:1,alignItems:"end",justifyContent:"center",children:[e.jsx(w,{variant:"h5",textAlign:"center",children:`Projected GGR ${O.reduce((p,g)=>Math.max(p,g),-1/0)} -`}),e.jsx(w,{variant:"h6",textAlign:"center",children:Number(L.reduce((p,g)=>p+g.projectedTotalGGR,0)).toLocaleString()})]})})}),e.jsx(X,{item:!0,xs:6,lg:3,children:e.jsx(ue,{sx:{height:"100%",display:"flex",alignItems:"center"},children:D==null?void 0:D.map((p,g)=>e.jsxs(P,{direction:"row",spacing:1,alignItems:"end",justifyContent:"start",children:[e.jsx(w,{variant:"h5",textAlign:"center",children:`Total GGR ${p} - `}),e.jsx(w,{variant:"h6",textAlign:"center",children:Number(L.reduce((I,k)=>I+(k[`totalGGR_${p}`]||0),0)).toLocaleString()})]},g))})})]}),e.jsxs(P,{mb:5,spacing:3,children:[e.jsx(w,{variant:"h2",textAlign:"center",children:"Games Data"}),e.jsx(re,{data:L,columns:V})]}),e.jsxs(P,{mb:5,spacing:3,children:[e.jsx(w,{variant:"h2",textAlign:"center",children:"TOTAL GGR - QAUTER"}),e.jsx(re,{data:f,columns:F,setData:()=>{}})]})]})}const de={chart:{height:100,type:"line",zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"straight",width:3},xaxis:{categories:[]}},is=()=>{const h=Ke(),[d,u]=i.useState(h.pathname==="/admin/report"),{user:z}=gt();i.useState(0);const[b,L]=i.useState(!1),[Y,O]=i.useState(!1),[B,D]=i.useState([]),[m,V]=i.useState([]),[f,F]=i.useState([]),[p,g]=i.useState(!0),[I,k]=i.useState(""),[n,o]=i.useState(""),[K,oe]=i.useState(!1),[je,H]=i.useState([]),[me,pe]=i.useState([]),[we,te]=i.useState([]),[W,U]=i.useState([]),[Ge,he]=i.useState([]),[Se,Ce]=i.useState(de),[Re,se]=i.useState(de),[le,xe]=i.useState(de),[T,Z]=i.useState(de),[_e,qe]=i.useState(de),[Qe,Ot]=i.useState(new Date().toISOString().split("T")[0]),[Ye,Be]=i.useState([]),[Ve,He]=i.useState(de),[Xe,ze]=i.useState([]),[Ze,Je]=i.useState([]),[et,tt]=i.useState([]),[st,nt]=i.useState([]),[$,be]=i.useState([1,37]),[at,rt]=i.useState(0),ot=(x,E)=>{console.log("newRange",E),be(E)},lt=i.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"Launch Date",accessorKey:"launchDate",dataType:"date",cell:({getValue:x,row:E,table:c})=>{var s,a;const A=(s=c==null?void 0:c.options)==null?void 0:s.meta,J=(a=A==null?void 0:A.selectedRow)==null?void 0:a[E.id],ne=x(),ae=ne?new Date(ne).toISOString().split("T")[0]:"";return J?e.jsx("input",{type:"date",value:ae,onChange:r=>A==null?void 0:A.updateData(E.index,"launchDate",r.target.value)}):ae}},{header:"Actions",id:"edit",cell:Ne,meta:{className:"cell-center"}}],[]),it=i.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"TOTAL GGR",accessorKey:"data",dataType:"text",cell:({getValue:x,row:E,table:c})=>{const A=x();return`${(Number(A[A.length-1])||0).toLocaleString()}`}}],[]),Le=i.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"GGR",accessorKey:"ggrEuro",dataType:"text"},{header:"SPINS",accessorKey:"spins",dataType:"text"},{header:"USERS",accessorKey:"uniquePlayers",dataType:"text"},{header:"SPU",accessorKey:"SPU",dataType:"text"},{header:"CWPP",accessorKey:"CWPP",dataType:"text"}],[]);i.useEffect(()=>{const x=[];for(let s=0;s<7;s++){const a=new Date;a.setDate(a.getDate()-s),x.push(a.toISOString().split("T")[0])}const E=m.reduce((s,{game:a,summary:r})=>{if(!s[a]){const G=f.find(S=>S.name===a);s[a]={...G,maxDate:r}}const y=new Date(s[a].maxDate)<new Date(r);return s[a].maxDate=y?r:s[a].maxDate,s},{}),c={},J=Object.values(m.reduce((s,{game:a,summary:r,ggrEuro:y,spins:G,uniquePlayers:S,betsEuro:C})=>{s[a]||(s[a]={name:a,ggrEuro:[],spins:[],uniquePlayers:[],SPU:[],CWPP:[]});const R=f.find(Pe=>Pe.name===a);new Date(R==null?void 0:R.launchDate)<new Date(r),c[a]&&new Date(c[a])<new Date(r.split("T")[0])?c[a]=r.split("T")[0]:c[a]||(c[a]=r.split("T")[0]);const ee=new Date(E[a].maxDate)||new Date,ie=new Date(ee);return ie.setDate(ie.getDate()-6),new Date(r)>=ie&&new Date(r)<=ee&&(s[a].ggrEuro.push(y),s[a].spins.push(G),s[a].uniquePlayers.push(S),s[a].SPU.push(G/S),s[a].CWPP.push(C/S)),s},{})).map(s=>{const a=s.ggrEuro,r=s.spins,y=s.uniquePlayers,G=s.SPU,S=s.CWPP;return{name:s.name,ggrEuro:Number((a.length>0?a.reduce((C,R)=>C+R,0)/a.length:0).toFixed(2)).toLocaleString(),spins:Number((r.length>0?r.reduce((C,R)=>C+R,0)/r.length:0).toFixed(2)).toLocaleString(),uniquePlayers:Number((y.length>0?y.reduce((C,R)=>C+R,0)/y.length:0).toFixed(2)).toLocaleString(),SPU:Number((G.length>0?G.reduce((C,R)=>C+R,0)/G.length:0).toFixed(2)).toLocaleString(),CWPP:Number((S.length>0?S.reduce((C,R)=>C+R,0)/S.length:0).toFixed(2)).toLocaleString()}});te(J);const ae=Object.values(m.reduce((s,{game:a,summary:r,ggrEuro:y,spins:G,uniquePlayers:S,betsEuro:C})=>{s[a]||(s[a]={name:a,ggrEuros:[],ggrEuro:0,ggrEuro2:0,spins:0,spins2:0,uniquePlayers:0,uniquePlayers2:0,SPU:0,SPU2:0,CWPP:0,CWPP2:0,arrSpins:[],arrSpins2:[]});const R=new Date(c[a]);R.setDate(R.getDate()-7);const ee=new Date(c[a]);return ee.setDate(ee.getDate()-14),R<new Date(r)?(s[a].ggrEuros.push(y),s[a].arrSpins.push(G),s[a].ggrEuro+=y,s[a].spins+=G,s[a].uniquePlayers+=S,s[a].SPU+=G/S,s[a].CWPP+=C/S):ee<new Date(r)&&new Date(r)<=R&&(s[a].arrSpins2.push(G),s[a].ggrEuro2+=y,s[a].spins2+=G,s[a].uniquePlayers2+=S,s[a].SPU2+=G/S,s[a].CWPP2+=C/S),s},{})).map(s=>{const a=(s.ggrEuro-s.ggrEuro2)/(s.ggrEuro2||1),r=(s.spins-s.spins2)/(s.spins2||1),y=(s.uniquePlayers-s.uniquePlayers2)/(s.uniquePlayers2||1),G=(s.SPU-s.SPU2)/(s.SPU2||1),S=(s.CWPP-s.CWPP2)/(s.CWPP2||1);return{name:s.name,ggrEuro:e.jsx("span",{style:{color:a>=0?"green":"red"},children:`${(a*100).toFixed(2)} %`}),spins:e.jsx("span",{style:{color:r>=0?"green":"red"},children:`${(r*100).toFixed(2)} %`}),uniquePlayers:e.jsx("span",{style:{color:y>=0?"green":"red"},children:`${(y*100).toFixed(2)} %`}),SPU:e.jsx("span",{style:{color:G>=0?"green":"red"},children:`${(G*100).toFixed(2)} %`}),CWPP:e.jsx("span",{style:{color:S>=0?"green":"red"},children:`${(S*100).toFixed(2)} %`})}});U(ae)},[me,m,f]);const ke=async()=>{var x,E;try{const c=await ye.get("api/reports");if(console.log("response.data.data",c.data.data),console.log("response.data.setGames",c.data.games),D(c.data.data),F(c.data.games),c.data.games.length>0){const A=c.data.games.length>0?(E=(x=c.data.games)==null?void 0:x.reduce((r,y)=>new Date(y.launchDate)<new Date(r.launchDate)?y:r).launchDate)==null?void 0:E.split("T")[0]:new Date().toISOString().split("T")[0],J=[...c.data.data].filter(r=>new Date(r.summary)>=new Date(A));J.sort((r,y)=>new Date(r.summary)-new Date(y.summary));const ne=[],ae=Object.values(J.reduce((r,{game:y,ggrEuro:G,summary:S})=>{r[y]||(r[y]={name:y,data:[],totalGGR:0});const C=c.data.games.find(R=>R.name===y);return r[y].totalGGR+=new Date(C==null?void 0:C.launchDate)>new Date(S)?0:G,r[y].data.push(r[y].totalGGR.toFixed(2)),ne.push(S.slice(0,10)),r},{}));let s=0;const a=ae.map(r=>(s=Math.max(s,r.data.length),{...r,data:fe(r.data)}));console.log("min, max",s),rt(s),be([1,s])}}catch{}},ct=async()=>{const x=localStorage.getItem("reportToken");g(x!=="true"),ke()};i.useEffect(()=>{ct()},[]);const dt=async x=>{if(x.target.files.length>0){const E=x.target.files[0];if(!E){alert("Please select a file first.");return}L(!0);const c=new FormData;c.append("file",E);try{const A=await ye.post("api/reports/upload",c,{headers:{"Content-Type":"multipart/form-data"}});Te({open:!0,message:"Excel uploaded successfully!",variant:"alert",alert:{color:"success"}}),ke(),L(!0)}catch(A){console.error("Upload Error:",A),alert("Error uploading file.")}finally{L(!1),x.target.value=""}}},ut=async()=>{O(!0);try{const x=await ye.get("api/reports/download",{responseType:"blob"}),E=window.URL.createObjectURL(new Blob([x.data])),c=document.createElement("a");c.href=E,c.setAttribute("download","report.xlsx"),document.body.appendChild(c),c.click(),document.body.removeChild(c)}catch(x){console.error("Download Error:",x),Te({open:!0,message:"Excel not exists!",variant:"alert",alert:{color:"error"}})}finally{O(!1)}};i.useEffect(()=>{var x;if(f.length>0){const E=f.length>0?(x=f==null?void 0:f.reduce((t,l)=>new Date(l.launchDate)<new Date(t.launchDate)?l:t).launchDate)==null?void 0:x.split("T")[0]:new Date().toISOString().split("T")[0],c=[...B].filter(t=>new Date(t.summary)>=new Date(E));c.sort((t,l)=>new Date(t.summary)-new Date(l.summary));const A=[],J=Object.values(c.reduce((t,{game:l,ggrEuro:j,summary:M})=>{t[l]||(t[l]={name:l,data:[],totalGGR:0});const v=f.find(N=>N.name===l);return t[l].totalGGR+=new Date(v==null?void 0:v.launchDate)>new Date(M)?0:j,t[l].data.push(t[l].totalGGR.toFixed(2)),A.push(M.slice(0,10)),t},{}));let ne=0;const s=J.map(t=>(ne=Math.max(ne,t.data.length),{...t,data:fe(t.data)})).map(t=>{const l=$[0]-1,j=$[1]-1;return t.data=t.data.slice(l,j+1),t});he(s);const a=[...new Set(A)];pe(a);const r=[];for(let t=$[0];t<=$[1];t++)r.push(`Day ${t}`);const y=B==null?void 0:B.map(t=>({...t,SPU:t.spins/t.uniquePlayers,CWPP:t.betsEuro/t.uniquePlayers}));V(y);const G=[];for(let t=0;t<14;t++)G.push(`Day ${t+1}`);He(t=>({...t,xaxis:{categories:G,labels:{show:!1}}})),Be(Ut(J));const C=Object.values(c.reduce((t,{game:l,summary:j,uniquePlayers:M})=>{t[l]||(t[l]={name:l,data:[]});const v=f.find(N=>N.name===l);return new Date(v==null?void 0:v.launchDate)<=new Date(j)&&t[l].data.push(M),t},{})).map(t=>{const l=$[0]-1,j=$[1]-1;return t.data=t.data.slice(l,j+1),t});console.log("filterUsersData1",C),ze(C);const R=t=>{if(t.length<6)return[];let l=new Array(5).fill(0);for(let j=5;j<t.length;j++){let M=t.slice(j-4,j+1).reduce((De,ve)=>De+ve,0),v=t.slice(j-5,j).reduce((De,ve)=>De+ve,0),N=((M-v)/(v||1)*100).toFixed(2);l.push(N)}return l},ee=Object.values(c.reduce((t,{game:l,summary:j,uniquePlayers:M})=>{t[l]||(t[l]={name:l,data:[]});const v=f.find(N=>N.name===l);return new Date(v==null?void 0:v.launchDate)<=new Date(j)&&t[l].data.push(M),t},{})),ie=ee.map(t=>({...t,data:R(t.data)}));console.log("usersData2",ie);const Pe=ie.map(t=>{const l=$[0]-1,j=$[1]-1;return t.data=t.data.slice(l,j+1),{...t,data:t.data}});console.log("filterUserChangesData",Pe),Je(Pe),console.log("usersData",ee);const ht=Object.values(c.reduce((t,{game:l,spins:j,summary:M})=>{t[l]||(t[l]={name:l,data:[]});const v=f.find(N=>N.name===l);return t[l].data.push(new Date(v==null?void 0:v.launchDate)>new Date(M)?0:j),t},{})).map(t=>{const l=$[0]-1,j=$[1]-1;return t.data=t.data.slice(l,j+1),{...t,data:fe(t.data)}});tt(ht);const xt=Object.values(c.reduce((t,{game:l,spins:j,uniquePlayers:M,summary:v})=>{t[l]||(t[l]={name:l,data:[]});const N=f.find(De=>De.name===l);return t[l].data.push(new Date(N==null?void 0:N.launchDate)>new Date(v)?0:(j/M).toFixed(2)),t},{})).map(t=>{const l=$[0]-1,j=$[1]-1;return t.data=t.data.slice(l,j+1),{...t,data:fe(t.data)}});H(r),console.log("days",r),Ce(t=>({...t,xaxis:{categories:r,labels:{show:!1}}})),se(t=>({...t,xaxis:{categories:r,labels:{show:!1}}})),xe(t=>({...t,xaxis:{categories:r,labels:{show:!1}}})),Z(t=>({...t,xaxis:{categories:r,labels:{show:!1}}})),qe(t=>({...t,xaxis:{categories:r,labels:{show:!1}}})),nt(xt)}},[B,Qe,f,$]);const pt=async()=>{try{const x=await ye.post("api/account/check",{email:d?z.email:n,password:I});localStorage.setItem("reportToken","true"),oe(!1),g(!1)}catch{oe(!0)}};return e.jsxs(Gt,{children:[e.jsx(ue,{children:!p&&e.jsxs(X,{item:!0,xs:12,lg:12,children:[e.jsxs(P,{mb:3,spacing:1,display:"flex",flexDirection:"row",alignItems:"center",gap:2,justifyContent:"space-between",children:[e.jsxs(X,{item:!0,children:[e.jsxs("label",{htmlFor:"contained-button-file",children:[e.jsx(Me,{accept:".xls,.xlsx",id:"contained-button-file",type:"file",onChange:dt}),e.jsx(Oe,{loading:b,variant:"contained",component:"span",children:"Upload Excel"})]}),e.jsx(Oe,{sx:{marginLeft:"10px"},loading:Y,variant:"contained",component:"span",onClick:ut,children:"Download Excel"})]}),e.jsxs(X,{sx:{marginTop:"0px !important"},gap:2,display:"flex",flexDirection:"row",alignItems:"center",children:[e.jsx(w,{variant:"h5",textAlign:"right",children:"LAUNCH"}),e.jsx(q,{Link:!0,to:d?"/admin/report-type/users/launch":"/report-type/users/launch",children:e.jsx(_,{loading:b,variant:"contained",component:"span",children:"Users"})}),e.jsx(q,{to:d?"/admin/report-type/totalGGR/launch":"/report-type/totalGGR/launch",children:e.jsx(_,{loading:b,variant:"contained",component:"span",children:"Total GGR"})}),e.jsx(q,{to:d?"/admin/report-type/spinsPerUser/launch":"/report-type/spinsPerUser/launch",children:e.jsx(_,{loading:b,variant:"contained",component:"span",children:"Spins Per User"})}),e.jsx(q,{to:d?"/admin/report-type/totalCoins/launch":"/report-type/totalCoins/launch",children:e.jsx(_,{loading:b,variant:"contained",component:"span",children:"Total Coins"})}),e.jsx(q,{to:d?"/admin/report-type/cwpp/launch":"/report-type/cwpp/launch",children:e.jsx(_,{loading:b,variant:"contained",component:"span",children:"CWPP"})})]})]}),e.jsx(P,{mb:3,spacing:1,display:"flex",flexDirection:"row",alignItems:"center",gap:2,justifyContent:"end",children:e.jsxs(X,{sx:{marginTop:"0px !important"},gap:2,display:"flex",flexDirection:"row",alignItems:"center",children:[e.jsx(w,{variant:"h5",textAlign:"right",children:"EXCLUSIVE"}),e.jsx(q,{to:d?"/admin/report-type/users/exclusive":"/report-type/users/exclusive",children:e.jsx(_,{loading:b,variant:"contained",component:"span",children:"Users"})}),e.jsx(q,{to:d?"/admin/report-type/totalGGR/exclusive":"/report-type/totalGGR/exclusive",children:e.jsx(_,{loading:b,variant:"contained",component:"span",children:"Total GGR"})}),e.jsx(q,{to:d?"/admin/report-type/spinsPerUser/exclusive":"/report-type/spinsPerUser/exclusive",children:e.jsx(_,{loading:b,variant:"contained",component:"span",children:"Spins Per User"})}),e.jsx(q,{to:d?"/admin/report-type/totalCoins/exclusive":"/report-type/totalCoins/exclusive",children:e.jsx(_,{loading:b,variant:"contained",component:"span",children:"Total Coins"})}),e.jsx(q,{to:d?"/admin/report-type/cwpp/exclusive":"/report-type/cwpp/exclusive",children:e.jsx(_,{loading:b,variant:"contained",component:"span",children:"CWPP"})})]})}),e.jsx(P,{mb:5,spacing:3,children:e.jsx(Wt,{data:B,games:f})}),e.jsxs(P,{mb:5,spacing:3,children:[e.jsx(w,{variant:"h2",textAlign:"center",children:"Launch Information"}),e.jsx(re,{data:f,columns:lt,setData:F})]}),e.jsxs(P,{mb:5,spacing:3,children:[e.jsx(w,{variant:"h2",textAlign:"center",children:"TOTAL REVENUE"}),e.jsx(re,{data:Ge,columns:it,setData:F})]}),e.jsxs(P,{mb:5,spacing:3,children:[e.jsx(w,{variant:"h2",textAlign:"center",children:"7 Day Averages"}),e.jsx(re,{data:we,columns:Le,setData:F})]}),e.jsxs(P,{mb:5,spacing:3,children:[e.jsx(w,{variant:"h2",textAlign:"center",children:"7 Day Change (%) "}),e.jsx(re,{data:W,columns:Le,setData:F})]}),e.jsxs(P,{mb:5,direction:"row",spacing:3,alignItems:"center",justifyContent:"center",children:[e.jsx(w,{variant:"h2",children:"Time Period"}),e.jsx(Et,{getAriaLabel:()=>"Temperature range",value:$,max:at,min:1,onChange:ot,valueLabelDisplay:"auto",valueLabelFormat:x=>`Day ${x}`,sx:{width:"40%"}})]}),e.jsxs(P,{mb:5,children:[e.jsx(w,{variant:"h2",textAlign:"center",children:"Total GGR"}),e.jsx(ce,{options:Se,series:Ge,type:"line",height:500})]}),e.jsxs(P,{mb:5,children:[e.jsx(w,{variant:"h2",textAlign:"center",children:"USERS"}),e.jsx(ce,{options:Re,series:Xe,type:"line",height:500})]}),e.jsxs(P,{mb:5,children:[e.jsx(w,{variant:"h2",textAlign:"center",children:"USER 5 Day Change (%)"}),e.jsx(ce,{options:le,series:Ze,type:"line",height:500})]}),e.jsxs(P,{mb:5,children:[e.jsx(w,{variant:"h2",textAlign:"center",children:"SPINS PER DAY"}),e.jsx(ce,{options:T,series:et,type:"line",height:500})]}),e.jsxs(P,{mb:5,children:[e.jsx(w,{variant:"h2",textAlign:"center",children:"SPINS PER PLAYER"}),e.jsx(ce,{options:_e,series:st,type:"line",height:500})]}),e.jsxs(P,{children:[e.jsx(w,{variant:"h2",textAlign:"center",children:"14 DAY LAUNCH"}),e.jsx(ce,{options:Ve,series:Ye,type:"line",height:500})]})]})}),e.jsx(yt,{open:p,maxWidth:"xs",children:e.jsxs(ft,{sx:{p:1,py:1.5},children:[d?e.jsx(Ee,{children:"Confirm Password"}):e.jsx(Ee,{children:"Login"}),e.jsxs(jt,{children:[e.jsxs(P,{spacing:1,mb:2,children:[!d&&e.jsx(Ae,{name:"email",placeholder:"Email",type:"email",fullWidth:!0,variant:"outlined",value:n,onChange:x=>o(x.target.value)}),e.jsx(Ae,{name:"password",placeholder:"Password",type:"password",fullWidth:!0,variant:"outlined",value:I,onChange:x=>k(x.target.value)})]}),K&&d&&e.jsx(w,{variant:"h6",color:"red",children:"Password is wrong."}),K&&!d&&e.jsx(w,{variant:"h6",color:"red",children:"Credentials is wrong."}),"          "]}),e.jsx(mt,{children:e.jsx(_,{variant:"contained",onClick:pt,children:"Confirm"})})]})})]})};export{re as ReactTable,is as default,ge as separateByComma};
