import{P as p,c as D,r as n,j as e,p as l,T as b,aE as E,L as M,a9 as C,I as w,b8 as F,x as k,ac as v,t as A,M as L,d as O,B as R,a6 as B,ai as H}from"./index-ae0c6fa9.js";import{u as J,g as V,a as K,b as N,c as _,d as z,S as $,f as T}from"./ScrollX-bdc6078a.js";import{r as G}from"./index-481cdf3e.js";import Q from"./empty-898d68be.js";import{D as U,S as X,R as q,H as W,T as Y}from"./Filter-5ef23403.js";import"./LinearWithLabel-008bb407.js";import"./CustomerModal-7459c0ee.js";import{E as Z}from"./ExpandingUserDetail-754f26f5.js";import{T as ee,a as te,b as oe}from"./TableContainer-a726524c.js";import{T as ae}from"./TableHead-01f8d5cc.js";import{T as S}from"./TableRow-a825f52e.js";import{T as y}from"./TableCell-fee530ec.js";import{E as se}from"./EditOutlined-30d52220.js";import{D as ne}from"./DeleteOutlined-9fbc60e3.js";import{P as re}from"./PlusOutlined-d01501fb.js";import"./TableFooter-0d5d4346.js";import"./DownloadOutlined-16291ccd.js";import"./CaretUpOutlined-57fef02b.js";import"./CaretDownOutlined-4c826e06.js";import"./Pagination-c81e691c.js";import"./index-032ef1ff.js";import"./Checkbox-97c9b269.js";import"./MinusOutlined-d52cc2d8.js";import"./react-number-format.es-611956b4.js";import"./MailOutlined-82843a41.js";import"./PhoneOutlined-62e8ab10.js";import"./EnvironmentOutlined-67ff003e.js";const le=(d,i,m,g)=>{const r=G(d.getValue(i),m);return g(r),r.passed};function I({data:d,columns:i,modalToggler:m}){const g=D(),r=v(g.breakpoints.down("sm")),[j,u]=n.useState([{id:"id",desc:!0}]),[c,h]=n.useState({}),[x,f]=n.useState(""),t=J({data:d,columns:i,state:{sorting:j,rowSelection:c,globalFilter:x},enableRowSelection:!0,onSortingChange:u,onRowSelectionChange:h,onGlobalFilterChange:f,getRowCanExpand:()=>!0,getSortedRowModel:V(),getFilteredRowModel:K(),getCoreRowModel:N(),getPaginationRowModel:_(),getExpandedRowModel:z(),globalFilterFn:le,debugTable:!0}),s=A(g.palette.primary.lighter,.1);let P=[];return i.map(a=>a.accessorKey&&P.push({label:typeof a.header=="string"?a.header:"#",key:a.accessorKey})),e.jsxs(L,{content:!1,children:[e.jsxs(l,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...r&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(U,{value:x??"",onFilterChange:a=>f(String(a)),placeholder:`Search ${d.length} records...`}),e.jsxs(l,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:[e.jsx(X,{getState:t.getState,getAllColumns:t.getAllColumns,setSorting:u}),e.jsx(l,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(M,{to:"/admin/job-create",children:e.jsx(O,{variant:"contained",startIcon:e.jsx(re,{}),onClick:m,children:"Add Job"})})})]})]}),e.jsx($,{children:e.jsxs(l,{children:[e.jsx(q,{selected:Object.keys(c).length}),e.jsx(ee,{children:e.jsxs(te,{children:[e.jsx(ae,{children:t.getHeaderGroups().map(a=>e.jsx(S,{children:a.headers.map(o=>(o.column.columnDef.meta!==void 0&&o.column.getCanSort()&&Object.assign(o.column.columnDef.meta,{className:o.column.columnDef.meta.className+" cursor-pointer prevent-select"}),e.jsx(y,{...o.column.columnDef.meta,onClick:o.column.getToggleSortingHandler(),...o.column.getCanSort()&&o.column.columnDef.meta===void 0&&{className:"cursor-pointer prevent-select"},children:o.isPlaceholder?null:e.jsxs(l,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(R,{children:T(o.column.columnDef.header,o.getContext())}),o.column.getCanSort()&&e.jsx(W,{column:o.column})]})},o.id)))},a.id))}),e.jsx(oe,{children:t.getRowModel().rows.map(a=>e.jsxs(n.Fragment,{children:[e.jsx(S,{children:a.getVisibleCells().map(o=>e.jsx(y,{...o.column.columnDef.meta,children:T(o.column.columnDef.cell,o.getContext())},o.id))}),a.getIsExpanded()&&e.jsx(S,{sx:{bgcolor:s,"&:hover":{bgcolor:`${s} !important`}},children:e.jsx(y,{colSpan:a.getVisibleCells().length,children:e.jsx(Z,{data:a.original})})})]},a.id))})]})}),e.jsxs(e.Fragment,{children:[e.jsx(B,{}),e.jsx(R,{sx:{p:2},children:e.jsx(Y,{setPageSize:t.setPageSize,setPageIndex:t.setPageIndex,getState:t.getState,getPageCount:t.getPageCount})})]})]})})]})}I.propTypes={columns:p.array,data:p.array,getHeaderProps:p.func,handleAdd:p.func,modalToggler:p.func,renderRowSubComponent:p.any};const Le=()=>{const d=D(),[i,m]=n.useState([]),[g,r]=n.useState(!1),[j,u]=n.useState(!1),[c,h]=n.useState(""),x=()=>{u(!j)};n.useEffect(()=>{(async()=>{try{r(!0);const{data:s}=await H("/api/job");m(s),r(!1)}catch{r(!1)}})()},[]);const f=n.useMemo(()=>[{header:"Job Name",accessorKey:"name",cell:({row:t,getValue:s})=>e.jsx(l,{direction:"row",spacing:1.5,alignItems:"center",children:e.jsx(b,{color:"text.secondary",children:t.original.name})})},{header:"Location",accessorKey:"location",cell:({row:t,getValue:s})=>e.jsx(l,{direction:"row",spacing:1.5,alignItems:"center",children:e.jsx(b,{color:"text.secondary",children:t.original.location})})},{header:"Date Applied",accessorKey:"created_at",cell:({row:t,getValue:s})=>e.jsx(b,{color:"text.secondary",children:E(new Date(t.original.created_at),"dd/MM/yyyy")})},{header:"Actions",meta:{className:"cell-center"},disableSortBy:!0,cell:({row:t})=>e.jsxs(l,{direction:"row",alignItems:"center",justifyContent:"center",spacing:0,children:[e.jsx(M,{to:`/admin/job-edit/${t.original._id}`,children:e.jsx(C,{title:"Edit",children:e.jsx(w,{color:"primary",children:e.jsx(se,{})})})}),e.jsx(C,{title:"Delete",children:e.jsx(w,{color:"error",onClick:s=>{s.stopPropagation(),x(),u(!0),h(t.original._id)},children:e.jsx(ne,{})})})]})}],[d]);return g?e.jsx(Q,{}):e.jsxs(e.Fragment,{children:[e.jsx(I,{data:i,columns:f,modalToggler:()=>{}}),e.jsx(F,{id:c,title:c,open:j,handleClose:x,deletehandler:async()=>{try{await k.delete(`/api/job/${c}`),m(i.filter(t=>t._id!==c)),u(!1),h("")}catch{}}})]})};export{Le as default,le as fuzzyFilter};
