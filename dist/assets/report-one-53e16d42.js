import{y as k,z as A,r as o,j as t,M as O,G as v,p,d as q,T as h,x as M}from"./index-753a7d60.js";import{_ as C}from"./react-apexcharts.min-8686e7f1.js";import{C as _}from"./ComponentSkeleton-437d0355.js";import{separateByComma as r}from"./report-e655c2c6.js";import{R as $}from"./ReactFixedHeaderTable-964d1b74.js";import"./Skeleton-12c184b4.js";import"./LoadingButton-7f4d1c42.js";import"./ScrollX-9ba80633.js";import"./Filter-b89e78b9.js";import"./DownloadOutlined-bfcff9d7.js";import"./CaretUpOutlined-e2fa5e38.js";import"./CaretDownOutlined-3028d4ee.js";import"./TableRow-b60b9c81.js";import"./TableCell-79ad539b.js";import"./Pagination-f08e9217.js";import"./index-f2e45a1e.js";import"./Checkbox-169b94f6.js";import"./MinusOutlined-1a48a8af.js";import"./RowEditable-02a3a550.js";import"./LinearWithLabel-f218b33a.js";import"./Slider-0630f89e.js";import"./visuallyHidden-14c3de6e.js";import"./TableContainer-06e18050.js";import"./TableHead-d2f9d13c.js";import"./SendOutlined-798b4ee8.js";const z={chart:{height:100,type:"line",zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"straight",width:3},xaxis:{categories:[]}},ye=()=>{var x,y,g,G;const{id:E}=k(),P=A(),[F,K]=o.useState(null),[S,R]=o.useState([]),[a,w]=o.useState([]),[d,W]=o.useState(z),U=o.useMemo(()=>[{header:"",accessorKey:"day",dataType:"text",cell:({getValue:l})=>t.jsx("div",{style:{textWrap:"nowrap"},children:l()})},{header:"Game",accessorKey:"game",dataType:"text",cell:({getValue:l})=>t.jsx("div",{style:{textWrap:"nowrap"},children:l()})},{header:"Bets Euro",accessorKey:"betsEuro",dataType:"text",cell:r},{header:"Wins Euro",accessorKey:"winsEuro",dataType:"text",cell:r},{header:"GGR Euro",accessorKey:"ggrEuro",dataType:"text",cell:r},{header:"Avg Bet",accessorKey:"avgBet",dataType:"text",cell:r},{header:"Spins",accessorKey:"spins",dataType:"text",cell:r},{header:"Unique Players",accessorKey:"uniquePlayers",dataType:"text",cell:r},{header:"Total GGR",accessorKey:"totalGGR",dataType:"text",cell:r},{header:"Spins Per User",accessorKey:"spinsPerUser",dataType:"text",cell:r},{header:"Coins Wagered Per User",accessorKey:"coinsWageredPerUser",dataType:"text",cell:r},{header:"Total Coins Wagered",accessorKey:"totalCoinsWagered",dataType:"text",cell:r}],[]);return o.useEffect(()=>{(async()=>{const m=await M.get(`/api/reports/${E}`);if(m.status===200){const c=m.data.game,n=[...m.data.reports].filter(e=>new Date(e.summary)>=new Date(c==null?void 0:c.launchDate));n.sort((e,s)=>new Date(e.summary)-new Date(s.summary));const u=Object.values(n.reduce((e,{game:s,ggrEuro:i,summary:D,uniquePlayers:B})=>(e[s]||(e[s]={name:s,data:[],totalGGR:0,dataSum:[]}),e[s].totalGGR+=i,e[s].dataSum.push(e[s].totalGGR.toFixed(2)),e[s].data.push(B),e),{}));if(u.length>0){w(u);const e=u[0].data.length;W({...d,xaxis:{categories:Array.from({length:e},(s,i)=>`Day ${i+1}`),labels:{show:!1}}})}K(c);let j=0,T=0,f=0;const b=n==null?void 0:n.map((e,s)=>{j+=e.ggrEuro,T+=e.betsEuro,f+=e.betsEuro;const i=e.spins/e.uniquePlayers,D=e.betsEuro/e.uniquePlayers;return{day:`Day ${s+1}`,totalGGR:j,totalCoins:T,spinsPerUser:i,coinsWageredPerUser:D,totalCoinsWagered:f,...e}});console.log(b),R(b)}})()},[]),t.jsx(_,{children:t.jsx(O,{title:"",children:t.jsxs(v,{item:!0,xs:12,lg:12,children:[t.jsx(p,{mb:3,spacing:1,children:t.jsx(v,{item:!0,children:t.jsx(q,{variant:"contained",onClick:()=>P(-1),children:"Back"})})}),t.jsxs(p,{mb:5,children:[t.jsx(h,{variant:"h2",textAlign:"center",children:"User Per Day Graph"}),t.jsx(C,{options:d,series:[{name:(x=a==null?void 0:a[0])==null?void 0:x.name,data:(y=a==null?void 0:a[0])==null?void 0:y.data}],type:"line",height:500})]}),t.jsxs(p,{mb:5,children:[t.jsx(h,{variant:"h2",textAlign:"center",children:"Total GGR Graph"}),t.jsx(C,{options:d,series:[{name:(g=a==null?void 0:a[0])==null?void 0:g.name,data:(G=a==null?void 0:a[0])==null?void 0:G.dataSum}],type:"line",height:500})]}),t.jsxs(p,{mb:5,spacing:3,children:[t.jsx(h,{variant:"h2",textAlign:"center",children:"Game Data"}),t.jsx($,{data:S,columns:U,setData:()=>{},height:"600px"})]})]})})})};export{ye as default};
