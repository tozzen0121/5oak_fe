import{P as u,c as D,r as n,j as e,p as l,k as E,g as F,T as S,aE as k,L as M,a9 as y,I as C,b8 as v,x as A,ac as N,t as O,M as B,d as H,B as T,a6 as L,ai as z}from"./index-4ec2acc9.js";import{u as _,g as $,a as K,b as V,c as G,d as U,S as Q,f as R}from"./ScrollX-181e09c3.js";import{r as X}from"./index-481cdf3e.js";import q from"./empty-c242f5b0.js";import{D as J,S as W,R as Y,H as Z,T as ee}from"./Filter-5fb6b047.js";import"./LinearWithLabel-a698b6a2.js";import"./CustomerModal-49896dba.js";import{E as te}from"./ExpandingUserDetail-b7a9f557.js";import{T as se,a as oe,b as ae}from"./TableContainer-79f96d07.js";import{T as ne}from"./TableHead-1c1d5f27.js";import{T as w}from"./TableRow-76b6232d.js";import{T as b}from"./TableCell-d56244c5.js";import{E as re}from"./EditOutlined-6b363669.js";import{D as le}from"./DeleteOutlined-1f490c1a.js";import{P as ie}from"./PlusOutlined-ad84ee30.js";import"./TableFooter-404fa31e.js";import"./DownloadOutlined-9f1bb88f.js";import"./CaretUpOutlined-bbb0220c.js";import"./CaretDownOutlined-2840e58c.js";import"./Pagination-1c1c147a.js";import"./index-cbfabe50.js";import"./Checkbox-ea9a3331.js";import"./MinusOutlined-52ffbb38.js";import"./react-number-format.es-ef5c2e2a.js";import"./MailOutlined-0ac5197f.js";import"./PhoneOutlined-f38fec67.js";import"./EnvironmentOutlined-8e72ed0f.js";const ce=(d,i,m,g)=>{const r=X(d.getValue(i),m);return g(r),r.passed};function I({data:d,columns:i,modalToggler:m}){const g=D(),r=N(g.breakpoints.down("sm")),[h,p]=n.useState([{id:"id",desc:!0}]),[c,j]=n.useState({}),[x,f]=n.useState(""),t=_({data:d,columns:i,state:{sorting:h,rowSelection:c,globalFilter:x},enableRowSelection:!0,onSortingChange:p,onRowSelectionChange:j,onGlobalFilterChange:f,getRowCanExpand:()=>!0,getSortedRowModel:$(),getFilteredRowModel:K(),getCoreRowModel:V(),getPaginationRowModel:G(),getExpandedRowModel:U(),globalFilterFn:ce,debugTable:!0}),a=O(g.palette.primary.lighter,.1);let P=[];return i.map(o=>o.accessorKey&&P.push({label:typeof o.header=="string"?o.header:"#",key:o.accessorKey})),e.jsxs(B,{content:!1,children:[e.jsxs(l,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",justifyContent:"space-between",sx:{padding:2,...r&&{"& .MuiOutlinedInput-root, & .MuiFormControl-root":{width:"100%"}}},children:[e.jsx(J,{value:x??"",onFilterChange:o=>f(String(o)),placeholder:`Search ${d.length} records...`}),e.jsxs(l,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",sx:{width:{xs:"100%",sm:"auto"}},children:[e.jsx(W,{getState:t.getState,getAllColumns:t.getAllColumns,setSorting:p}),e.jsx(l,{direction:"row",spacing:2,alignItems:"center",children:e.jsx(M,{to:"/admin/news-create",children:e.jsx(H,{variant:"contained",startIcon:e.jsx(ie,{}),onClick:m,children:"Add News"})})})]})]}),e.jsx(Q,{children:e.jsxs(l,{children:[e.jsx(Y,{selected:Object.keys(c).length}),e.jsx(se,{children:e.jsxs(oe,{children:[e.jsx(ne,{children:t.getHeaderGroups().map(o=>e.jsx(w,{children:o.headers.map(s=>(s.column.columnDef.meta!==void 0&&s.column.getCanSort()&&Object.assign(s.column.columnDef.meta,{className:s.column.columnDef.meta.className+" cursor-pointer prevent-select"}),e.jsx(b,{...s.column.columnDef.meta,onClick:s.column.getToggleSortingHandler(),...s.column.getCanSort()&&s.column.columnDef.meta===void 0&&{className:"cursor-pointer prevent-select"},children:s.isPlaceholder?null:e.jsxs(l,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(T,{children:R(s.column.columnDef.header,s.getContext())}),s.column.getCanSort()&&e.jsx(Z,{column:s.column})]})},s.id)))},o.id))}),e.jsx(ae,{children:t.getRowModel().rows.map(o=>e.jsxs(n.Fragment,{children:[e.jsx(w,{children:o.getVisibleCells().map(s=>e.jsx(b,{...s.column.columnDef.meta,children:R(s.column.columnDef.cell,s.getContext())},s.id))}),o.getIsExpanded()&&e.jsx(w,{sx:{bgcolor:a,"&:hover":{bgcolor:`${a} !important`}},children:e.jsx(b,{colSpan:o.getVisibleCells().length,children:e.jsx(te,{data:o.original})})})]},o.id))})]})}),e.jsxs(e.Fragment,{children:[e.jsx(L,{}),e.jsx(T,{sx:{p:2},children:e.jsx(ee,{setPageSize:t.setPageSize,setPageIndex:t.setPageIndex,getState:t.getState,getPageCount:t.getPageCount})})]})]})})]})}I.propTypes={columns:u.array,data:u.array,getHeaderProps:u.func,handleAdd:u.func,modalToggler:u.func,renderRowSubComponent:u.any};const Be=()=>{const d=D(),[i,m]=n.useState([]),[g,r]=n.useState(!1),[h,p]=n.useState(!1),[c,j]=n.useState(""),x=()=>{p(!h)};n.useEffect(()=>{(async()=>{try{r(!0);const{data:a}=await z("/api/news");m(a),r(!1)}catch{r(!1)}})()},[]);const f=n.useMemo(()=>[{header:"Title",accessorKey:"name",cell:({row:t,getValue:a})=>e.jsxs(l,{direction:"row",spacing:1.5,alignItems:"center",children:[e.jsx(E,{alt:"Avatar 1",size:"sm",src:F(`${t.original.imagePath}`)}),e.jsxs(l,{spacing:0,children:[e.jsx(S,{variant:"subtitle1",children:a()}),e.jsx(S,{color:"text.secondary",children:t.original.email})]})]})},{header:"Date Applied",accessorKey:"created_at",cell:({row:t,getValue:a})=>e.jsx(S,{color:"text.secondary",children:k(new Date(t.original.created_at),"dd/MM/yyyy")})},{header:"Actions",meta:{className:"cell-center"},disableSortBy:!0,cell:({row:t})=>e.jsxs(l,{direction:"row",alignItems:"center",justifyContent:"center",spacing:0,children:[e.jsx(M,{to:`/admin/news-edit/${t.original._id}`,children:e.jsx(y,{title:"Edit",children:e.jsx(C,{color:"primary",children:e.jsx(re,{})})})}),e.jsx(y,{title:"Delete",children:e.jsx(C,{color:"error",onClick:a=>{a.stopPropagation(),x(),p(!0),j(t.original._id)},children:e.jsx(le,{})})})]})}],[d]);return g?e.jsx(q,{}):e.jsxs(e.Fragment,{children:[e.jsx(I,{data:i,columns:f,modalToggler:()=>{}}),e.jsx(v,{id:c,title:c,open:h,handleClose:x,deletehandler:async()=>{try{await A.delete(`/api/news/${c}`),m(i.filter(t=>t._id!==c)),p(!1),j("")}catch{}}})]})};export{Be as default,ce as fuzzyFilter};
