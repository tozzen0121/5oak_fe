import{r as o,P as ie,a3 as Kt,j as e,M as pe,aV as vt,am as Mt,G as ne,p as j,T as f,L as se,d as te,aB as qt,B as _t,aO as ut,aP as zt,D as pt,aS as Yt,a9 as ht,I as gt,Z as Qt,x as $e,H as _e}from"./index-884300a6.js";import{C as Ht}from"./ComponentSkeleton-fe2914a1.js";import{L as yt}from"./LoadingButton-948fa2e3.js";import{_ as De}from"./react-apexcharts.min-996d9f90.js";import{u as Vt,S as Xt,f as mt,b as Zt}from"./ScrollX-e575bb26.js";import"./Filter-602d5861.js";import{E as Jt,R as es}from"./RowEditable-e8d94a1d.js";import"./LinearWithLabel-a4dc276d.js";import{T as ts,a as ss,b as ns}from"./TableContainer-70939d03.js";import{T as as}from"./TableHead-32dfae15.js";import{T as ft}from"./TableRow-7e199ecb.js";import{T as Dt}from"./TableCell-f00c7374.js";import{S as rs}from"./Slider-b1218a2d.js";import{S as is}from"./SendOutlined-3a1c4fc8.js";import"./Skeleton-5c7a6d8d.js";import"./DownloadOutlined-2d828a1f.js";import"./CaretUpOutlined-d3374051.js";import"./CaretDownOutlined-8a6a36d3.js";import"./Pagination-14811126.js";import"./index-4ecf95d6.js";import"./Checkbox-87e9ff88.js";import"./MinusOutlined-acdca845.js";import"./visuallyHidden-14c3de6e.js";function os(m,c,h,ee){var L=this,S=o.useRef(null),H=o.useRef(0),O=o.useRef(0),E=o.useRef(null),D=o.useRef([]),T=o.useRef(),q=o.useRef(),w=o.useRef(m),_=o.useRef(!0);w.current=m;var oe=typeof window<"u",le=!c&&c!==0&&oe;if(typeof m!="function")throw new TypeError("Expected a function");c=+c||0;var he=!!(h=h||{}).leading,Te=!("trailing"in h)||!!h.trailing,de="maxWait"in h,l="debounceOnServer"in h&&!!h.debounceOnServer,x=de?Math.max(+h.maxWait||0,c):null;o.useEffect(function(){return _.current=!0,function(){_.current=!1}},[]);var Y=o.useMemo(function(){var Q=function(r){var n=D.current,F=T.current;return D.current=T.current=null,H.current=r,O.current=O.current||r,q.current=w.current.apply(F,n)},V=function(r,n){le&&cancelAnimationFrame(E.current),E.current=le?requestAnimationFrame(r):setTimeout(r,n)},Se=function(r){if(!_.current)return!1;var n=r-S.current;return!S.current||n>=c||n<0||de&&r-H.current>=x},be=function(r){return E.current=null,Te&&D.current?Q(r):(D.current=T.current=null,q.current)},Ce=function r(){var n=Date.now();if(he&&O.current===H.current&&Re(),Se(n))return be(n);if(_.current){var F=c-(n-S.current),W=de?Math.min(F,x-(n-H.current)):F;V(r,W)}},Re=function(){ee&&ee({})},ge=function(){if(oe||l){var r=Date.now(),n=Se(r);if(D.current=[].slice.call(arguments),T.current=L,S.current=r,n){if(!E.current&&_.current)return H.current=S.current,V(Ce,c),he?Q(S.current):q.current;if(de)return V(Ce,c),Q(S.current)}return E.current||V(Ce,c),q.current}};return ge.cancel=function(){E.current&&(le?cancelAnimationFrame(E.current):clearTimeout(E.current)),H.current=0,D.current=S.current=T.current=E.current=null},ge.isPending=function(){return!!E.current},ge.flush=function(){return E.current?be(Date.now()):q.current},ge},[he,de,c,x,Te,le,oe,l,ee]);return Y}const wt=({row:m,table:c})=>{var S;const h=(S=c==null?void 0:c.options)==null?void 0:S.meta,ee=H=>{h==null||h.setSelectedRow(O=>({...O,[m.id]:!O[m.id]})),h==null||h.revertData(m.index,(H==null?void 0:H.currentTarget.name)==="cancel")},L=()=>{h==null||h.saveData(m.index)};return e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",children:[(h==null?void 0:h.selectedRow[m.id])&&e.jsx(ht,{title:"Cancel",children:e.jsx(gt,{color:"error",name:"cancel",onClick:ee,children:e.jsx(Qt,{})})}),e.jsx(ht,{title:h!=null&&h.selectedRow[m.id]?"Save":"Edit",children:e.jsx(gt,{color:h!=null&&h.selectedRow[m.id]?"success":"primary",onClick:h!=null&&h.selectedRow[m.id]?L:ee,children:h!=null&&h.selectedRow[m.id]?e.jsx(is,{}):e.jsx(Jt,{})})})]})};wt.propTypes={row:ie.object,table:ie.object,options:ie.array,id:ie.number,index:ie.number};ie.node,ie.number,ie.number;const St=Kt("input")({display:"none"});St.displayName="Input";const ve=m=>{let c=0,h=m.length-1;for(;c<m.length&&Number(m[c])===0;)c++;for(;h>=0&&Number(m[h])===0;)h--;return m.slice(c,h+1)},jt=(m,c,h)=>m.map(L=>{const S=ve(L.data);return{...L,data:S.slice(0,14)}}),Be=({getValue:m})=>{const c=m();return`${Number((c||0).toFixed(2)).toLocaleString()}`};function we({columns:m,data:c,setData:h}){const[ee,L]=o.useState(()=>[...c]),[S,H]=o.useState({}),O=Vt({data:c,columns:m,defaultColumn:{cell:es},getCoreRowModel:Zt(),meta:{selectedRow:S,setSelectedRow:H,revertData:(D,T)=>{T?h(q=>q.map((w,_)=>_===D?ee[D]:w)):L(q=>q.map((w,_)=>_===D?c[D]:w))},updateData:(D,T,q)=>{h(w=>w.map((_,oe)=>oe===D?{...w[D],[T]:q}:_))},saveData:async D=>{try{const T=c[D],q=await $e.put(`/api/launchGames/${T._id}`,T);_e({open:!0,message:"Saved successfully!",variant:"alert",alert:{color:"success"}}),H(w=>({...w,[D]:!1}))}catch{_e({open:!0,message:"Error!",variant:"alert",alert:{color:"error"}})}}},debugTable:!0});let E=[];return O.getAllColumns().map(D=>D.columnDef.accessorKey&&E.push({label:typeof D.columnDef.header=="string"?D.columnDef.header:"#",key:D.columnDef.accessorKey})),e.jsx(pe,{content:!1,children:e.jsx(Xt,{children:e.jsx(ts,{children:e.jsxs(ss,{children:[e.jsx(as,{children:O.getHeaderGroups().map(D=>e.jsx(ft,{children:D.headers.map(T=>e.jsx(Dt,{...T.column.columnDef.meta,children:T.isPlaceholder?null:mt(T.column.columnDef.header,T.getContext())},T.id))},D.id))}),e.jsx(ns,{children:O.getRowModel().rows.map(D=>e.jsx(ft,{children:D.getVisibleCells().map(T=>e.jsx(Dt,{...T.column.columnDef.meta,children:mt(T.column.columnDef.cell,T.getContext())},T.id))},D.id))})]})})})})}we.propTypes={columns:ie.array,data:ie.array,setData:ie.func};function ls({data:m,games:c}){const h=vt(),[ee,L]=o.useState(h.pathname==="/admin/report"),[S,H]=o.useState([]),[O,E]=o.useState([]),[D,T]=o.useState([]),[q,w]=o.useState({value:0,date:""}),[_,oe]=o.useState([]);o.useEffect(()=>{const l=r=>{const n=r.getUTCMonth();return Math.floor(n/3)+1},x=r=>{const F=r.map(B=>new Date(B.summary)).sort((B,re)=>B-re),W=F[0],Z=F[F.length-1],ae=W.getFullYear(),ye=l(W),Oe=Z.getFullYear(),Ee=l(Z),me=[];for(let B=ae;B<=Oe;B++)for(let re=1;re<=4;re++)if(!(B===ae&&re<ye)){if(B===Oe&&re>Ee)break;me.push(`${B}-Q${re}`)}return me},Y=[...new Set(m.map(r=>r.summary.split("-")[0]))];if(E(Y),m&&m.length>0){const r=x(m);T(r)}const Q=Object.values(m.reduce((r,{game:n,summary:F,betsEuro:W,winsEuro:Z,ggrEuro:ae,avgBet:ye,spins:Oe,uniquePlayers:Ee})=>{r[n]||(r[n]={_id:"",name:n,maxDate:F,years:{},totalGGR:0,latestWeekStart:"",secLatestWeekStart:"",latestWeekGGR:[],secLatestWeekGGR:[],latestWeekAvgBet:[],secLatestWeekAvgBet:[],remainDays:0,weekAverage:0,weekAvgBet:0,weekChange:0,weekSum1:0,weekSum2:0,weekChangeColor:"",dailyTotalGGR:0,projectedTotalGGR:0,LifeTimePayout:0,betsEuro:0,winsEuro:0,dailyAvgBet:0,totalAvgBet:0,avgBetCount:0}),r[n].betsEuro+=W,r[n].winsEuro+=Z;const me=c.find(Ae=>Ae.name===n);r[n].launchDate=me.launchDate,r[n]._id=me._id,r[n].totalGGR+=ae,ye&&ye>0&&(r[n].totalAvgBet+=ye,r[n].avgBetCount+=1,r[n].dailyAvgBet=r[n].totalAvgBet/r[n].avgBetCount);const B=F.split("-")[0];r[n].years[B]||(r[n].years[B]=0),r[n].years[B]+=ae,r[n][`totalGGR_${B}`]||(r[n][`totalGGR_${B}`]=0),r[n][`totalGGR_${B}`]+=ae;const re=l(new Date(F)),Pe=`${B}-Q${re}`;if(r[n][`totalGGR_${Pe}`]||(r[n][`totalGGR_${Pe}`]=0),r[n][`totalGGR_${Pe}`]+=ae,new Date(me.launchDate)<=new Date(F)){const Ae=new Date(r[n].maxDate)<new Date(F);r[n].maxDate=Ae?F:r[n].maxDate,r[n].dailyTotalGGR=Ae?ae:r[n].dailyTotalGGR;const We=new Date(r[n].maxDate),ze=new Date(We.getFullYear(),11,31);r[n].remainDays=Math.ceil((ze-We)/(1e3*60*60*24));const Ke=We.getFullYear().toString(),Ye=r[n][`totalGGR_${Ke}`]||0,Me=r[n].weekAverage*r[n].remainDays;r[n].projectedTotalGGR=Ye+Me;const Ue=new Date(r[n].maxDate),ce=new Date(Ue);ce.setDate(ce.getDate()-6);const Ge=new Date(ce);Ge.setDate(Ge.getDate()-7);const Ie=new Date(ce);Ie.setDate(Ie.getDate()-1),r[n].latestWeekStart=ce.toISOString().split("T")[0],r[n].secLatestWeekStart=Ge.toISOString().split("T")[0],r[n].latestWeekGGR=m.filter(y=>y.game===n&&new Date(y.summary)>=ce&&new Date(y.summary)<=Ue).map(y=>y.ggrEuro),r[n].secLatestWeekGGR=m.filter(y=>y.game===n&&new Date(y.summary)>=Ge&&new Date(y.summary)<=Ie).map(y=>y.ggrEuro),r[n].latestWeekAvgBet=m.filter(y=>y.game===n&&new Date(y.summary)>=ce&&new Date(y.summary)<=Ue).map(y=>y.avgBet||0),r[n].secLatestWeekAvgBet=m.filter(y=>y.game===n&&new Date(y.summary)>=Ge&&new Date(y.summary)<=Ie).map(y=>y.avgBet||0),r[n].weekSum1=r[n].latestWeekGGR.reduce((y,J)=>y+J,0),r[n].weekSum2=r[n].secLatestWeekGGR.reduce((y,J)=>y+J,0),r[n].weekAverage=r[n].latestWeekGGR.reduce((y,J)=>y+J,0)/r[n].latestWeekGGR.length;const Fe=r[n].latestWeekAvgBet.filter(y=>y>0);r[n].weekAvgBet=Fe.length>0?Fe.reduce((y,J)=>y+J,0)/Fe.length:0,r[n].weekChange=(r[n].latestWeekGGR.reduce((y,J)=>y+J,0)-r[n].secLatestWeekGGR.reduce((y,J)=>y+J,0))/r[n].secLatestWeekGGR.reduce((y,J)=>y+J,0)*100,r[n].weekChangeColor=e.jsx("span",{style:{color:r[n].weekChange>0?"green":"red"},children:`${Number(r[n].weekChange.toFixed(2)).toLocaleString()} %`}),r[n].LifeTimePayout=r[n].betsEuro>0?(r[n].winsEuro/r[n].betsEuro*100).toFixed(2):0}return r},{}));H(Q);const V=m.reduce((r,{summary:n,ggrEuro:F})=>(r[n]||(r[n]=0),r[n]+=F,r),{}),Se=Math.max(...Object.values(V)),be=Object.keys(V).find(r=>V[r]===Se);w({value:Se,date:be});const Re=new Date().toISOString().split("T")[0],ge=c.map(r=>{const n=m.find(Z=>Z.game===r.name&&Z.summary.split("T")[0]===Re),W=m.filter(Z=>Z.game===r.name&&Z.summary.split("T")[0]!==Re).sort((Z,ae)=>new Date(ae.summary)-new Date(Z.summary))[0];return{gameName:r.name,totalUsersToday:(n==null?void 0:n.uniquePlayers)||0,totalUsersPrevious:(W==null?void 0:W.uniquePlayers)||0,cwppToday:n?n.betsEuro/n.uniquePlayers:0,cwppPrevious:W?W.betsEuro/W.uniquePlayers:0,spuToday:n?n.spins/n.uniquePlayers:0,spuPrevious:W?W.spins/W.uniquePlayers:0,aveBetToday:(n==null?void 0:n.avgBet)||0,aveBetPrevious:(W==null?void 0:W.avgBet)||0,totalCoinsToday:(n==null?void 0:n.betsEuro)||0,totalCoinsPrevious:(W==null?void 0:W.betsEuro)||0}});oe(ge)},[m,c]);const le=o.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text",cell:({getValue:l,row:x})=>{const Y=l();return e.jsx(se,{style:{textDecoration:"none"},to:ee?`/admin/report-one/${x.original._id}`:`/report-one/${x.original._id}`,children:Y})}},{header:"Launch Date",accessorKey:"launchDate",dataType:"text",cell:({getValue:l,row:x,table:Y})=>{var V;const Q=l();return`${(V=Q==null?void 0:Q.split("T"))==null?void 0:V[0]}`}},{header:"Daily Total GGR",accessorKey:"dailyTotalGGR",dataType:"text",cell:Be},{header:"Projected Total GGR",accessorKey:"projectedTotalGGR",dataType:"text",cell:Be},...(O==null?void 0:O.map(l=>({header:`Total GGR ${l}`,accessorKey:`totalGGR_${l}`,dataType:"text",cell:Be})))||[],{header:"Lifetime GGR",accessorKey:"totalGGR",dataType:"text",cell:Be},{header:"7 Day Average",accessorKey:"weekAverage",dataType:"text",cell:Be},{header:"Daily Average Bet",accessorKey:"dailyAvgBet",dataType:"text",cell:({getValue:l})=>{const x=l();return x?`${Number(x.toFixed(2)).toLocaleString()}`:"0.00"}},{header:"7 Day Average Bet",accessorKey:"weekAvgBet",dataType:"text",cell:({getValue:l})=>{const x=l();return x?`${Number(x.toFixed(2)).toLocaleString()}`:"0.00"}},{header:"7 Day Change",accessorKey:"weekChangeColor",dataType:"text"},{header:"Lifetime Payout",accessorKey:"LifeTimePayout",dataType:"text",cell:({getValue:l})=>{const x=l();return x?`${x}%`:"0.00%"}}],[O]),he=o.useMemo(()=>{const l=[];return D.forEach(x=>{const Y={quarter:x};S.forEach(Q=>{const V=Q[`totalGGR_${x}`]!==void 0?Number(Q[`totalGGR_${x}`].toFixed(2)).toLocaleString():0;Y[Q.name]=V}),l.push(Y)}),l},[D,S]),Te=o.useMemo(()=>{const l=c.map(x=>x.name);return[{header:"Quarter",accessorKey:"quarter",dataType:"text"},...l.map(x=>({header:x,accessorKey:x,dataType:"number",cell:Y=>Y.getValue()??0}))]},[c]),de=o.useMemo(()=>[{header:"Game Name",accessorKey:"gameName",dataType:"text",cell:({getValue:l})=>l()},{header:e.jsxs("div",{style:{textAlign:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Total Users"}),e.jsxs("div",{style:{display:"flex",fontSize:"0.8em"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:"Today"})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#666"},children:"Previous"})})]})]}),accessorKey:"totalUsers",dataType:"text",cell:({row:l})=>e.jsxs("div",{style:{display:"flex",justifyContent:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:Number(l.original.totalUsersToday).toLocaleString()})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{color:"#666"},children:Number(l.original.totalUsersPrevious).toLocaleString()})})]})},{header:e.jsxs("div",{style:{textAlign:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"CWPP"}),e.jsxs("div",{style:{display:"flex",fontSize:"0.8em"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:"Today"})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#666"},children:"Previous"})})]})]}),accessorKey:"cwpp",dataType:"text",cell:({row:l})=>e.jsxs("div",{style:{display:"flex",justifyContent:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:Number(l.original.cwppToday.toFixed(2)).toLocaleString()})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{color:"#666"},children:Number(l.original.cwppPrevious.toFixed(2)).toLocaleString()})})]})},{header:e.jsxs("div",{style:{textAlign:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"SPU"}),e.jsxs("div",{style:{display:"flex",fontSize:"0.8em"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:"Today"})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#666"},children:"Previous"})})]})]}),accessorKey:"spu",dataType:"text",cell:({row:l})=>e.jsxs("div",{style:{display:"flex",justifyContent:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:Number(l.original.spuToday.toFixed(2)).toLocaleString()})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{color:"#666"},children:Number(l.original.spuPrevious.toFixed(2)).toLocaleString()})})]})},{header:e.jsxs("div",{style:{textAlign:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Ave Bet"}),e.jsxs("div",{style:{display:"flex",fontSize:"0.8em"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:"Today"})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#666"},children:"Previous"})})]})]}),accessorKey:"aveBet",dataType:"text",cell:({row:l})=>e.jsxs("div",{style:{display:"flex",justifyContent:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsxs("span",{style:{fontWeight:"bold",color:"#1976d2"},children:[Number(l.original.aveBetToday.toFixed(2)).toLocaleString(),"%"]})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsxs("span",{style:{color:"#666"},children:[Number(l.original.aveBetPrevious.toFixed(2)).toLocaleString(),"%"]})})]})},{header:e.jsxs("div",{style:{textAlign:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Total Coins"}),e.jsxs("div",{style:{display:"flex",fontSize:"0.8em"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:"Today"})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#666"},children:"Previous"})})]})]}),accessorKey:"totalCoins",dataType:"text",cell:({row:l})=>e.jsxs("div",{style:{display:"flex",justifyContent:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:Number(l.original.totalCoinsToday).toLocaleString()})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{color:"#666"},children:Number(l.original.totalCoinsPrevious).toLocaleString()})})]})}],[]);return e.jsxs(ne,{item:!0,xs:12,lg:12,children:[e.jsxs(ne,{container:!0,spacing:{xs:1,sm:2},mb:5,children:[e.jsx(ne,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(j,{direction:"column",spacing:1,alignItems:"center",justifyContent:"center",sx:{textAlign:"center"},children:[e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",children:[e.jsx(f,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:"Lifetime GGR - "}),e.jsx(f,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:Number(S.reduce((l,x)=>l+x.totalGGR,0)).toLocaleString()})]}),e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",children:[e.jsx(f,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:"Highest Daily GGR Record - "}),e.jsx(f,{variant:{xs:"h6",sm:"h6"},textAlign:"center",sx:{fontWeight:"bold",color:"primary.main"},children:Number(q.value).toLocaleString()})]}),e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",children:[e.jsx(f,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:"Date - "}),e.jsx(f,{variant:{xs:"h6",sm:"h6"},textAlign:"center",sx:{fontWeight:"bold"},children:q.date?q.date.split("T")[0]:""})]})]})})}),e.jsx(ne,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{textAlign:"center"},children:[e.jsx(f,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:"Daily Total GGR -"}),e.jsx(f,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:Number(S.reduce((l,x)=>l+x.dailyTotalGGR,0)).toLocaleString()})]})})}),e.jsx(ne,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{textAlign:"center"},children:[e.jsx(f,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:"7 Day Average GGR -"}),e.jsx(f,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:Number(S.reduce((l,x)=>l+x.weekAverage,0)).toLocaleString()})]})})}),e.jsx(ne,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{textAlign:"center"},children:[e.jsx(f,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:"7 Day Change -"}),e.jsx(f,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:((S.reduce((l,x)=>l+x.weekSum1,0)-S.reduce((l,x)=>l+x.weekSum2,0))/S.reduce((l,x)=>l+x.weekSum2,0)*100).toFixed(2)+"%"})]})})}),e.jsx(ne,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{textAlign:"center"},children:[e.jsx(f,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:`Projected GGR ${O.reduce((l,x)=>Math.max(l,x),-1/0)} -`}),e.jsx(f,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:Number(S.reduce((l,x)=>l+x.projectedTotalGGR,0)).toLocaleString()})]})})}),e.jsx(ne,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:D==null?void 0:D.map((l,x)=>e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"start",sx:{textAlign:"center"},children:[e.jsx(f,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:`Total GGR ${l} - `}),e.jsx(f,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:Number(S.reduce((Y,Q)=>Y+(Q[`totalGGR_${l}`]||0),0)).toLocaleString()})]},x))})}),e.jsx(ne,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:O==null?void 0:O.map((l,x)=>e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"start",sx:{textAlign:"center"},children:[e.jsx(f,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:`Total Revenue ${l} - `}),e.jsx(f,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:Number(S.reduce((Y,Q)=>Y+(Q[`totalGGR_${l}`]||0),0)).toLocaleString()})]},x))})})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"Games Data"}),e.jsx(we,{data:S,columns:le})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"Today vs Previous Day Comparison"}),e.jsx(we,{data:_,columns:de})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"TOTAL GGR - QUARTER"}),e.jsx(we,{data:he,columns:Te,setData:()=>{}})]})]})}const je={chart:{height:100,type:"line",zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"straight",width:3},xaxis:{categories:[]}},Ls=()=>{const m=vt(),[c,h]=o.useState(m.pathname==="/admin/report"),{user:ee}=Mt();o.useState(0);const[L,S]=o.useState(!1),[H,O]=o.useState(!1),[E,D]=o.useState([]),[T,q]=o.useState([]),[w,_]=o.useState([]),[oe,le]=o.useState(!0),[he,Te]=o.useState(""),[de,l]=o.useState(""),[x,Y]=o.useState(!1),[Q,V]=o.useState([]),[Se,be]=o.useState([]),[Ce,Re]=o.useState([]),[ge,r]=o.useState([]),[n,F]=o.useState([]),[W,Z]=o.useState(je),[ae,ye]=o.useState([]),[Oe,Ee]=o.useState(je),[me,B]=o.useState(je),[re,Pe]=o.useState(je),[Ae,We]=o.useState(je),[ze,Ke]=o.useState(je),[Ye,Me]=o.useState(je),[Ue,ce]=o.useState([]),[Ge,Ie]=o.useState(new Date().toISOString().split("T")[0]),[Fe,y]=o.useState([]),[J,Je]=o.useState(je),[bt,et]=o.useState([]),[Gt,tt]=o.useState([]),[Tt,st]=o.useState([]),[Ct,nt]=o.useState([]),[R,Qe]=o.useState([1,37]),[Rt,Pt]=o.useState(0),At=os((b,$)=>{Qe($)},300),Wt=(b,$)=>{Qe($),At(b,$)},Lt=o.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"Launch Date",accessorKey:"launchDate",dataType:"date",cell:({getValue:b,row:$,table:v})=>{var i,d;const G=(i=v==null?void 0:v.options)==null?void 0:i.meta,fe=(d=G==null?void 0:G.selectedRow)==null?void 0:d[$.id],X=b(),ue=X?new Date(X).toISOString().split("T")[0]:"";return fe?e.jsx("input",{type:"date",value:ue,onChange:P=>G==null?void 0:G.updateData($.index,"launchDate",P.target.value)}):ue}},{header:"Actions",id:"edit",cell:wt,meta:{className:"cell-center"}}],[]),kt=o.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"TOTAL GGR",accessorKey:"data",dataType:"text",cell:({getValue:b,row:$,table:v})=>{const G=b();return`${(Number(G[G.length-1])||0).toLocaleString()}`}}],[]),Ot=o.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"GGR",accessorKey:"ggrEuro",dataType:"text"},{header:"SPINS",accessorKey:"spins",dataType:"text"},{header:"USERS",accessorKey:"uniquePlayers",dataType:"text"},{header:"SPU",accessorKey:"SPU",dataType:"text"},{header:"CWPP",accessorKey:"CWPP",dataType:"text"},{header:"Coins Wagered",accessorKey:"CW",dataType:"text"},{header:"Lifetime Payout",accessorKey:"LP",dataType:"text"}],[]),Et=o.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"GGR",accessorKey:"ggrEuro",dataType:"text"},{header:"SPINS",accessorKey:"spins",dataType:"text"},{header:"USERS",accessorKey:"uniquePlayers",dataType:"text"},{header:"SPU",accessorKey:"SPU",dataType:"text"},{header:"CWPP",accessorKey:"CWPP",dataType:"text"}],[]),[He,Ut]=o.useState(null);o.useEffect(()=>{const b=[];for(let i=0;i<7;i++){const d=new Date;d.setDate(d.getDate()-i),b.push(d.toISOString().split("T")[0])}const $=T.reduce((i,{game:d,summary:P})=>{if(!i[d]){const U=w.find(k=>k.name===d);i[d]={...U,maxDate:P}}const K=new Date(i[d].maxDate)<new Date(P);return i[d].maxDate=K?P:i[d].maxDate,Ut(i[d].maxDate),i},{}),v={},fe=Object.values(T.reduce((i,{game:d,summary:P,ggrEuro:K,spins:U,uniquePlayers:k,betsEuro:I,winsEuro:N})=>{i[d]||(i[d]={name:d,ggrEuro:[],spins:[],uniquePlayers:[],SPU:[],CWPP:[],CW:[],LP:[]});const A=w.find(Ne=>Ne.name===d);new Date(A==null?void 0:A.launchDate)<new Date(P),v[d]&&new Date(v[d])<new Date(P.split("T")[0])?v[d]=P.split("T")[0]:v[d]||(v[d]=P.split("T")[0]);const M=new Date($[d].maxDate)||new Date,Le=new Date(M);return Le.setDate(Le.getDate()-6),new Date(P)>=Le&&new Date(P)<=M&&(i[d].ggrEuro.push(K),i[d].spins.push(U),i[d].uniquePlayers.push(k),i[d].SPU.push(U/k),i[d].CWPP.push(I/k),i[d].CW.push(I),i[d].LP.push(N/I)),i},{})).map(i=>{const d=i.ggrEuro,P=i.spins,K=i.uniquePlayers,U=i.SPU,k=i.CWPP,I=i.LP,N=i.CW;return{name:i.name,ggrEuro:Number((d.length>0?d.reduce((A,M)=>A+M,0)/d.length:0).toFixed(2)).toLocaleString(),spins:Number((P.length>0?P.reduce((A,M)=>A+M,0)/P.length:0).toFixed(2)).toLocaleString(),uniquePlayers:Number((K.length>0?K.reduce((A,M)=>A+M,0)/K.length:0).toFixed(2)).toLocaleString(),SPU:Number((U.length>0?U.reduce((A,M)=>A+M,0)/U.length:0).toFixed(2)).toLocaleString(),CWPP:Number((k.length>0?k.reduce((A,M)=>A+M,0)/k.length:0).toFixed(2)).toLocaleString(),CW:Number((N.length>0?N.reduce((A,M)=>A+M,0)/N.length:0).toFixed(2)).toLocaleString(),LP:Number((I.length>0?I.reduce((A,M)=>A+M,0)/I.length:0).toFixed(2)).toLocaleString()}});Re(fe);const ue=Object.values(T.reduce((i,{game:d,summary:P,ggrEuro:K,spins:U,uniquePlayers:k,betsEuro:I})=>{i[d]||(i[d]={name:d,ggrEuros:[],ggrEuro:0,ggrEuro2:0,spins:0,spins2:0,uniquePlayers:0,uniquePlayers2:0,SPU:0,SPU2:0,CWPP:0,CWPP2:0,arrSpins:[],arrSpins2:[]});const N=new Date(v[d]);N.setDate(N.getDate()-7);const A=new Date(v[d]);return A.setDate(A.getDate()-14),N<new Date(P)?(i[d].ggrEuros.push(K),i[d].arrSpins.push(U),i[d].ggrEuro+=K,i[d].spins+=U,i[d].uniquePlayers+=k,i[d].SPU+=U/k,i[d].CWPP+=I/k):A<new Date(P)&&new Date(P)<=N&&(i[d].arrSpins2.push(U),i[d].ggrEuro2+=K,i[d].spins2+=U,i[d].uniquePlayers2+=k,i[d].SPU2+=U/k,i[d].CWPP2+=I/k),i},{})).map(i=>{const d=(i.ggrEuro-i.ggrEuro2)/(i.ggrEuro2||1),P=(i.spins-i.spins2)/(i.spins2||1),K=(i.uniquePlayers-i.uniquePlayers2)/(i.uniquePlayers2||1),U=(i.SPU-i.SPU2)/(i.SPU2||1),k=(i.CWPP-i.CWPP2)/(i.CWPP2||1);return{name:i.name,ggrEuro:e.jsx("span",{style:{color:d>=0?"green":"red"},children:`${(d*100).toFixed(2)} %`}),spins:e.jsx("span",{style:{color:P>=0?"green":"red"},children:`${(P*100).toFixed(2)} %`}),uniquePlayers:e.jsx("span",{style:{color:K>=0?"green":"red"},children:`${(K*100).toFixed(2)} %`}),SPU:e.jsx("span",{style:{color:U>=0?"green":"red"},children:`${(U*100).toFixed(2)} %`}),CWPP:e.jsx("span",{style:{color:k>=0?"green":"red"},children:`${(k*100).toFixed(2)} %`})}});r(ue)},[Se,T,w]);const at=async()=>{var b,$,v;try{const G=await $e.get("api/reports");if(D(G.data.data),_(G.data.games),G.data.games.length>0){const fe=G.data.games.length>0?($=(b=G.data.games)==null?void 0:b.reduce((t,a)=>new Date(a.launchDate)<new Date(t.launchDate)?a:t).launchDate)==null?void 0:$.split("T")[0]:new Date().toISOString().split("T")[0],X=[...G.data.data].filter(t=>new Date(t.summary)>=new Date(fe));X.sort((t,a)=>new Date(t.summary)-new Date(a.summary));const ue=[],i=Object.values(X.reduce((t,{game:a,ggrEuro:u,summary:g})=>{t[a]||(t[a]={name:a,data:[],totalGGR:0});const p=G.data.games.find(C=>C.name===a);return t[a].totalGGR+=new Date(p==null?void 0:p.launchDate)>new Date(g)?0:u,t[a].data.push(t[a].totalGGR.toFixed(2)),ue.push(g.slice(0,10)),t},{})),d=X.reduce((t,{summary:a,betsEuro:u,game:g})=>{const p=w.find(C=>C.name===g);if(new Date(p==null?void 0:p.launchDate)<=new Date(a)){const C=a.slice(0,10);t[C]||(t[C]=0),t[C]+=u}return t},{}),P=[{name:"Total Coins Wagered",data:Object.entries(d).sort(([t],[a])=>new Date(t)-new Date(a)).map(([t,a])=>Number(a.toFixed(2)))}];let K=0;const U=i.map(t=>(K=Math.max(K,t.data.length),{...t,data:ve(t.data)})),k=P.map(t=>{const a=R[0]-1,u=R[1]-1;return t.data=t.data.slice(a,u+1),t});Pt(K),Qe([1,K]),F(U),ye(k);const I=[...new Set(ue)];be(I);const N=[];for(let t=R[0];t<=R[1];t++)N.push(`Day ${t}`);const A=(v=G.data.data)==null?void 0:v.map(t=>({...t,SPU:t.spins/t.uniquePlayers,CWPP:t.betsEuro/t.uniquePlayers}));q(A);const M=[];for(let t=0;t<14;t++)M.push(`Day ${t+1}`);Je(t=>({...t,xaxis:{categories:M,labels:{show:!1}}})),y(jt(i,G.data.games,I));const Ne=Object.values(X.reduce((t,{game:a,summary:u,uniquePlayers:g})=>{t[a]||(t[a]={name:a,data:[]});const p=G.data.games.find(C=>C.name===a);return new Date(p==null?void 0:p.launchDate)<=new Date(u)&&t[a].data.push(g),t},{})).map(t=>{const a=R[0]-1,u=R[1]-1;return t.data=t.data.slice(a,u+1),t});et(Ne);const rt=t=>{if(t.length<6)return[];let a=new Array(5).fill(0);for(let u=5;u<t.length;u++){let g=t.slice(u-4,u+1).reduce((z,xe)=>z+xe,0),p=t.slice(u-5,u).reduce((z,xe)=>z+xe,0),C=((g-p)/(p||1)*100).toFixed(2);a.push(C)}return a},ot=Object.values(X.reduce((t,{game:a,summary:u,uniquePlayers:g})=>{t[a]||(t[a]={name:a,data:[]});const p=G.data.games.find(C=>C.name===a);return new Date(p==null?void 0:p.launchDate)<=new Date(u)&&t[a].data.push(g),t},{})).map(t=>({...t,data:rt(t.data)})).map(t=>{const a=R[0]-1,u=R[1]-1;return t.data=t.data.slice(a,u+1),{...t,data:t.data}});tt(ot);const dt=Object.values(X.reduce((t,{game:a,spins:u,summary:g})=>{t[a]||(t[a]={name:a,data:[]});const p=G.data.games.find(C=>C.name===a);return t[a].data.push(new Date(p==null?void 0:p.launchDate)>new Date(g)?0:u),t},{})).map(t=>{const a=R[0]-1,u=R[1]-1;return t.data=t.data.slice(a,u+1),{...t,data:ve(t.data)}});st(dt);const Ve=Object.values(X.reduce((t,{game:a,spins:u,uniquePlayers:g,summary:p})=>{t[a]||(t[a]={name:a,data:[]});const C=G.data.games.find(z=>z.name===a);return t[a].data.push(new Date(C==null?void 0:C.launchDate)>new Date(p)?0:(u/g).toFixed(2)),t},{})).map(t=>{const a=R[0]-1,u=R[1]-1;return t.data=t.data.slice(a,u+1),{...t,data:ve(t.data)}});V(N),Z(t=>({...t,xaxis:{categories:N,labels:{show:!1}}})),Ee(t=>({...t,xaxis:{categories:N,labels:{show:!1}},title:{text:"Daily Total Coins Wagered (All Games)",align:"center"},yaxis:{title:{text:"Total Coins"}}})),B(t=>({...t,xaxis:{categories:N,labels:{show:!1}}})),Pe(t=>({...t,xaxis:{categories:N,labels:{show:!1}}})),We(t=>({...t,xaxis:{categories:N,labels:{show:!1}}})),Ke(t=>({...t,xaxis:{categories:N,labels:{show:!1}}})),nt(Ve);const Xe=Object.values(X.reduce((t,{game:a,summary:u,ggrEuro:g})=>{t[a]||(t[a]={name:a,data:[]});const p=G.data.games.find(ke=>ke.name===a),C=X.filter(ke=>ke.game===a).reduce((ke,xt)=>new Date(xt.summary)>new Date(ke)?xt.summary:ke,"1970-01-01"),z=new Date(C),xe=new Date(z);return xe.setDate(xe.getDate()-6),new Date(u)>=xe&&new Date(u)<=z&&t[a].data.push(g),t},{})),Ze=X.reduce((t,a)=>new Date(a.summary)>new Date(t)?a.summary:t,"1970-01-01"),qe=new Date(Ze),s=[];for(let t=6;t>=0;t--){const a=new Date(qe);a.setDate(a.getDate()-t),s.push(a.toISOString().split("T")[0])}ce(Xe),Me(t=>({...t,xaxis:{categories:s,labels:{show:!0}},title:{text:"7 Day GGR",align:"center"}}))}}catch{}},It=async()=>{const b=localStorage.getItem("reportToken");le(b!=="true"),at()};o.useEffect(()=>{It()},[]);const Ft=async b=>{if(b.target.files.length>0){const $=b.target.files[0];if(!$){alert("Please select a file first.");return}S(!0);const v=new FormData;v.append("file",$);try{const G=await $e.post("api/reports/upload",v,{headers:{"Content-Type":"multipart/form-data"}});_e({open:!0,message:"Excel uploaded successfully!",variant:"alert",alert:{color:"success"}}),at(),S(!0)}catch(G){console.error("Upload Error:",G),alert("Error uploading file.")}finally{S(!1),b.target.value=""}}},Nt=async()=>{O(!0);try{const b=await $e.get("api/reports/download",{responseType:"blob"}),$=window.URL.createObjectURL(new Blob([b.data])),v=document.createElement("a");v.href=$,v.setAttribute("download","report.xlsx"),document.body.appendChild(v),v.click(),document.body.removeChild(v)}catch(b){console.error("Download Error:",b),_e({open:!0,message:"Excel not exists!",variant:"alert",alert:{color:"error"}})}finally{O(!1)}};o.useEffect(()=>{var b;if(w.length>0){const $=w.length>0?(b=w==null?void 0:w.reduce((s,t)=>new Date(t.launchDate)<new Date(s.launchDate)?t:s).launchDate)==null?void 0:b.split("T")[0]:new Date().toISOString().split("T")[0],v=[...E].filter(s=>new Date(s.summary)>=new Date($));v.sort((s,t)=>new Date(s.summary)-new Date(t.summary));const G=[],fe=Object.values(v.reduce((s,{game:t,ggrEuro:a,summary:u})=>{s[t]||(s[t]={name:t,data:[],totalGGR:0});const g=w.find(p=>p.name===t);return s[t].totalGGR+=new Date(g==null?void 0:g.launchDate)>new Date(u)?0:a,s[t].data.push(s[t].totalGGR.toFixed(2)),G.push(u.slice(0,10)),s},{})),X=v.reduce((s,{summary:t,betsEuro:a,game:u})=>{const g=w.find(p=>p.name===u);if(new Date(g==null?void 0:g.launchDate)<=new Date(t)){const p=t.slice(0,10);s[p]||(s[p]=0),s[p]+=a}return s},{}),ue=[{name:"Total Coins Wagered",data:Object.entries(X).sort(([s],[t])=>new Date(s)-new Date(t)).map(([s,t])=>Number(t.toFixed(2)))}];let i=0;const P=fe.map(s=>(i=Math.max(i,s.data.length),{...s,data:ve(s.data)})).map(s=>{const t=R[0]-1,a=R[1]-1;return s.data=s.data.slice(t,a+1),s}),U=ue.map(s=>(i=Math.max(i,s.data.length),{...s,data:ve(s.data)})).map(s=>{const t=R[0]-1,a=R[1]-1;return s.data=s.data.slice(t,a+1),s});F(P),ye(U);const k=[...new Set(G)];be(k);const I=[];for(let s=R[0];s<=R[1];s++)I.push(`Day ${s}`);const N=E==null?void 0:E.map(s=>({...s,SPU:s.spins/s.uniquePlayers,CWPP:s.betsEuro/s.uniquePlayers}));q(N);const A=[];for(let s=0;s<14;s++)A.push(`Day ${s+1}`);Je(s=>({...s,xaxis:{categories:A,labels:{show:!1}}})),y(jt(fe));const Le=Object.values(v.reduce((s,{game:t,summary:a,uniquePlayers:u})=>{s[t]||(s[t]={name:t,data:[]});const g=w.find(p=>p.name===t);return new Date(g==null?void 0:g.launchDate)<=new Date(a)&&s[t].data.push(u),s},{})).map(s=>{const t=R[0]-1,a=R[1]-1;return s.data=s.data.slice(t,a+1),s});et(Le);const Ne=s=>{if(s.length<6)return[];let t=new Array(5).fill(0);for(let a=5;a<s.length;a++){let u=s.slice(a-4,a+1).reduce((C,z)=>C+z,0),g=s.slice(a-5,a).reduce((C,z)=>C+z,0),p=((u-g)/(g||1)*100).toFixed(2);t.push(p)}return t},it=Object.values(v.reduce((s,{game:t,summary:a,uniquePlayers:u})=>{s[t]||(s[t]={name:t,data:[]});const g=w.find(p=>p.name===t);return new Date(g==null?void 0:g.launchDate)<=new Date(a)&&s[t].data.push(u),s},{})).map(s=>({...s,data:Ne(s.data)})).map(s=>{const t=R[0]-1,a=R[1]-1;return s.data=s.data.slice(t,a+1),{...s,data:s.data}});tt(it);const lt=Object.values(v.reduce((s,{game:t,spins:a,summary:u})=>{s[t]||(s[t]={name:t,data:[]});const g=w.find(p=>p.name===t);return s[t].data.push(new Date(g==null?void 0:g.launchDate)>new Date(u)?0:a),s},{})).map(s=>{const t=R[0]-1,a=R[1]-1;return s.data=s.data.slice(t,a+1),{...s,data:ve(s.data)}});st(lt);const ct=Object.values(v.reduce((s,{game:t,spins:a,uniquePlayers:u,summary:g})=>{s[t]||(s[t]={name:t,data:[]});const p=w.find(C=>C.name===t);return s[t].data.push(new Date(p==null?void 0:p.launchDate)>new Date(g)?0:(a/u).toFixed(2)),s},{})).map(s=>{const t=R[0]-1,a=R[1]-1;return s.data=s.data.slice(t,a+1),{...s,data:ve(s.data)}});V(I),Z(s=>({...s,xaxis:{categories:I,labels:{show:!1}}})),Ee(s=>({...s,xaxis:{categories:I,labels:{show:!1}},title:{text:"Daily Total Coins Wagered (All Games)",align:"center"},yaxis:{title:{text:"Total Coins"}}})),B(s=>({...s,xaxis:{categories:I,labels:{show:!1}}})),Pe(s=>({...s,xaxis:{categories:I,labels:{show:!1}}})),We(s=>({...s,xaxis:{categories:I,labels:{show:!1}}})),Ke(s=>({...s,xaxis:{categories:I,labels:{show:!1}}})),nt(ct);const Ve=Object.values(v.reduce((s,{game:t,summary:a,ggrEuro:u})=>{s[t]||(s[t]={name:t,data:[]}),w.find(z=>z.name===t);const g=v.filter(z=>z.game===t).reduce((z,xe)=>new Date(xe.summary)>new Date(z)?xe.summary:z,"1970-01-01"),p=new Date(g),C=new Date(p);return C.setDate(C.getDate()-6),new Date(a)>=C&&new Date(a)<=p&&s[t].data.push(u),s},{})),Xe=v.reduce((s,t)=>new Date(t.summary)>new Date(s)?t.summary:s,"1970-01-01"),Ze=new Date(Xe),qe=[];for(let s=6;s>=0;s--){const t=new Date(Ze);t.setDate(t.getDate()-s),qe.push(t.toISOString().split("T")[0])}ce(Ve),Me(s=>({...s,xaxis:{categories:qe,labels:{show:!0}},title:{text:"7 Day GGR",align:"center"}}))}},[E,Ge,w,R]);const Bt=async()=>{try{const b=await $e.post("api/account/check",{email:c?ee.email:de,password:he});localStorage.setItem("reportToken","true"),Y(!1),le(!1)}catch{Y(!0)}};return e.jsxs(Ht,{children:[e.jsx(pe,{children:!oe&&e.jsxs(ne,{item:!0,xs:12,lg:12,children:[e.jsxs(j,{mb:3,spacing:1,display:"flex",flexDirection:"row",alignItems:"center",gap:2,justifyContent:"space-between",sx:{flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"}},children:[e.jsx(ne,{item:!0,children:e.jsxs(j,{spacing:1,children:[e.jsxs(j,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:"center",children:[e.jsxs("label",{htmlFor:"contained-button-file",children:[e.jsx(St,{accept:".xls,.xlsx",id:"contained-button-file",type:"file",onChange:Ft}),e.jsx(yt,{loading:L,variant:"contained",component:"span",children:"Upload Excel"})]}),e.jsx(yt,{sx:{marginLeft:{xs:0,sm:"10px"},marginTop:{xs:1,sm:0}},loading:H,variant:"contained",component:"span",onClick:Nt,children:"Download Excel"})]}),e.jsxs(j,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:"center",children:[e.jsx(f,{variant:{xs:"subtitle2",sm:"subtitle1"},color:"textSecondary",children:"Latest Report Date:"}),e.jsx(f,{variant:{xs:"h6",sm:"h5"},sx:{color:"red",fontWeight:"bold"},children:He==null?void 0:He.split("T")[0]})]})]})}),e.jsxs(ne,{gap:2,display:"flex",flexDirection:"row",alignItems:"center",sx:{flexDirection:{xs:"column",sm:"row"},gap:{xs:1,sm:2}},children:[e.jsx(f,{variant:{xs:"h6",sm:"h5"},textAlign:"center",children:"LAUNCH"}),e.jsxs(j,{direction:"row",spacing:1,flexWrap:"wrap",justifyContent:"center",children:[e.jsx(se,{Link:!0,to:c?"/admin/report-type/users/launch":"/report-type/users/launch",children:e.jsx(te,{loading:L,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Users"})}),e.jsx(se,{to:c?"/admin/report-type/totalGGR/launch":"/report-type/totalGGR/launch",children:e.jsx(te,{loading:L,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Total GGR"})}),e.jsx(se,{to:c?"/admin/report-type/spinsPerUser/launch":"/report-type/spinsPerUser/launch",children:e.jsx(te,{loading:L,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Spins Per User"})}),e.jsx(se,{to:c?"/admin/report-type/totalCoins/launch":"/report-type/totalCoins/launch",children:e.jsx(te,{loading:L,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Total Coins"})}),e.jsx(se,{to:c?"/admin/report-type/cwpp/launch":"/report-type/cwpp/launch",children:e.jsx(te,{loading:L,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"CWPP"})}),e.jsx(se,{to:c?"/admin/report-type/totalCoinsWageredPerDay/launch":"/report-type/totalCoinsWageredPerDay/launch",children:e.jsx(te,{loading:L,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Total Coins Wagered Per Day"})})]})]})]}),e.jsx(j,{mb:3,spacing:1,display:"flex",flexDirection:"row",alignItems:"center",gap:2,justifyContent:"end",sx:{flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"}},children:e.jsxs(ne,{gap:2,display:"flex",flexDirection:"row",alignItems:"center",sx:{flexDirection:{xs:"column",sm:"row"},gap:{xs:1,sm:2}},children:[e.jsx(f,{variant:{xs:"h6",sm:"h5"},textAlign:"center",children:"EXCLUSIVE"}),e.jsxs(j,{direction:"row",spacing:1,flexWrap:"wrap",justifyContent:"center",children:[e.jsx(se,{to:c?"/admin/report-type/users/exclusive":"/report-type/users/exclusive",children:e.jsx(te,{loading:L,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Users"})}),e.jsx(se,{to:c?"/admin/report-type/totalGGR/exclusive":"/report-type/totalGGR/exclusive",children:e.jsx(te,{loading:L,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Total GGR"})}),e.jsx(se,{to:c?"/admin/report-type/spinsPerUser/exclusive":"/report-type/spinsPerUser/exclusive",children:e.jsx(te,{loading:L,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Spins Per User"})}),e.jsx(se,{to:c?"/admin/report-type/totalCoins/exclusive":"/report-type/totalCoins/exclusive",children:e.jsx(te,{loading:L,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Total Coins"})}),e.jsx(se,{to:c?"/admin/report-type/cwpp/exclusive":"/report-type/cwpp/exclusive",children:e.jsx(te,{loading:L,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"CWPP"})}),e.jsx(se,{to:c?"/admin/report-type/totalCoinsWageredPerDay/exclusive":"/report-type/totalCoinsWageredPerDay/exclusive",children:e.jsx(te,{loading:L,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Total Coins Wagered Per Day"})})]})]})}),e.jsx(j,{mb:5,spacing:3,children:e.jsx(ls,{data:E,games:w})}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"Launch Information"}),e.jsx(we,{data:w,columns:Lt,setData:_})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"TOTAL REVENUE"}),e.jsx(we,{data:n,columns:kt,setData:_})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"7 Day Averages"}),e.jsx(we,{data:Ce,columns:Ot,setData:_})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"7 Day Change (%) "}),e.jsx(we,{data:ge,columns:Et,setData:_})]}),e.jsxs(j,{mb:5,direction:{xs:"column",sm:"row"},spacing:{xs:2,sm:3},alignItems:"center",justifyContent:"center",children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},children:"Time Period"}),e.jsx(rs,{getAriaLabel:()=>"Temperature range",value:R,max:Rt,min:1,onChange:Wt,valueLabelDisplay:"auto",valueLabelFormat:b=>`Day ${b}`,sx:{width:{xs:"90%",sm:"60%",md:"40%"}}})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"Total GGR"}),e.jsx(De,{options:W,series:n,type:"line",height:500})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"7 DAY GGR"}),e.jsx(De,{options:Ye,series:Ue,type:"line",height:500})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"Total Coins Wagered"}),e.jsx(De,{options:Oe,series:ae,type:"line",height:500})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"USERS"}),e.jsx(De,{options:me,series:bt,type:"line",height:500})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"USER 5 Day Change (%)"}),e.jsx(De,{options:re,series:Gt,type:"line",height:500})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"SPINS PER DAY"}),e.jsx(De,{options:Ae,series:Tt,type:"line",height:500})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"SPINS PER PLAYER"}),e.jsx(De,{options:ze,series:Ct,type:"line",height:500})]}),e.jsxs(j,{spacing:{xs:2,sm:3},children:[e.jsx(f,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"14 DAY LAUNCH"}),e.jsx(De,{options:J,series:Fe,type:"line",height:500})]})]})}),e.jsx(qt,{open:oe,maxWidth:"xs",children:e.jsxs(_t,{sx:{p:1,py:1.5},children:[c?e.jsx(ut,{children:"Confirm Password"}):e.jsx(ut,{children:"Login"}),e.jsxs(zt,{children:[e.jsxs(j,{spacing:1,mb:2,children:[!c&&e.jsx(pt,{name:"email",placeholder:"Email",type:"email",fullWidth:!0,variant:"outlined",value:de,onChange:b=>l(b.target.value)}),e.jsx(pt,{name:"password",placeholder:"Password",type:"password",fullWidth:!0,variant:"outlined",value:he,onChange:b=>Te(b.target.value)})]}),x&&c&&e.jsx(f,{variant:"h6",color:"red",children:"Password is wrong."}),x&&!c&&e.jsx(f,{variant:"h6",color:"red",children:"Credentials is wrong."}),"          "]}),e.jsx(Yt,{children:e.jsx(te,{variant:"contained",onClick:Bt,children:"Confirm"})})]})})]})};export{we as ReactTable,Ls as default,Be as separateByComma};
