import{j as e,r as j,a5 as y,M as B,bX as O,p as Y,B as Z,c3 as Q,P as $,G as S}from"./index-f4d20eae.js";import{u as I,b as _,g as ee,S as F,f as C}from"./ScrollX-46f3613b.js";import{u as A}from"./index-fdecdc28.js";import{L as E}from"./LinearWithLabel-51c0a481.js";import{C as W,H as te}from"./Filter-7bb6f22c.js";import{Q as se,i as k,h as ae,c as re,p as oe,u as le,a as ne,b as ie}from"./useBaseQuery-dbd67308.js";import{T as G,a as L,b as X}from"./TableContainer-eecff0d0.js";import{T as q}from"./TableHead-7f6ac4b6.js";import{T as b}from"./TableRow-be52b30f.js";import{T as v}from"./TableCell-c89ef8e0.js";import"./DownloadOutlined-038ac146.js";import"./CaretUpOutlined-e7b87724.js";import"./CaretDownOutlined-4d820c1b.js";import"./Pagination-91a78fe5.js";import"./index-8f90f5fa.js";import"./Checkbox-20ad8cf0.js";import"./MinusOutlined-1dcff4d0.js";class ce extends se{constructor(s,t){super(s,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(s,t){super.setOptions({...s,behavior:k()},t)}getOptimisticResult(s){return s.behavior=k(),super.getOptimisticResult(s)}fetchNextPage({pageParam:s,...t}={}){return this.fetch({...t,meta:{fetchMore:{direction:"forward",pageParam:s}}})}fetchPreviousPage({pageParam:s,...t}={}){return this.fetch({...t,meta:{fetchMore:{direction:"backward",pageParam:s}}})}createResult(s,t){var u,n,h,l,d,m;const{state:g}=s,f=super.createResult(s,t),{isFetching:p,isRefetching:x}=f,i=p&&((u=g.fetchMeta)==null||(n=u.fetchMore)==null?void 0:n.direction)==="forward",o=p&&((h=g.fetchMeta)==null||(l=h.fetchMore)==null?void 0:l.direction)==="backward";return{...f,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:ae(t,(d=g.data)==null?void 0:d.pages),hasPreviousPage:re(t,(m=g.data)==null?void 0:m.pages),isFetchingNextPage:i,isFetchingPreviousPage:o,isRefetching:x&&!i&&!o}}}function ue(c,s,t){const u=oe(c,s,t);return le(u,ce)}const H=25,he=new ne,me=(c,s,t)=>{const u=[...Q(1e3)];if(t.length){const n=t[0],{id:h,desc:l}=n;u.sort((d,m)=>l?d[h]<m[h]?1:-1:d[h]>m[h]?1:-1)}return{data:u.slice(c,c+s),meta:{totalRowCount:u.length}}},de=()=>{var N,T,z,V,K;const c=j.useRef(null),[s,t]=j.useState([]),u=j.useMemo(()=>[{header:"Name",accessorKey:"fullName"},{header:"Email",accessorKey:"email"},{header:"Age",accessorKey:"age",meta:{className:"cell-right"}},{header:"Role",accessorKey:"role"},{header:"Visits",accessorKey:"visits",meta:{className:"cell-right"}},{header:"Status",accessorKey:"status",cell:a=>{switch(a.getValue()){case"Complicated":return e.jsx(y,{color:"error",label:"Complicated",size:"small",variant:"light"});case"Relationship":return e.jsx(y,{color:"success",label:"Relationship",size:"small",variant:"light"});case"Single":default:return e.jsx(y,{color:"info",label:"Single",size:"small",variant:"light"})}}},{header:"Profile Progress",accessorKey:"progress",cell:a=>e.jsx(E,{value:a.getValue(),sx:{minWidth:75}})}],[]),{data:n,fetchNextPage:h,isFetching:l}=ue(["table-data",s],async({pageParam:a=0})=>{const r=a*H;return me(r,H,s)},{getNextPageParam:(a,r)=>r.length,keepPreviousData:!0,refetchOnWindowFocus:!1}),d=j.useMemo(()=>{var a;return((a=n==null?void 0:n.pages)==null?void 0:a.flatMap(r=>r.data))??[]},[n]),m=((z=(T=(N=n==null?void 0:n.pages)==null?void 0:N[0])==null?void 0:T.meta)==null?void 0:z.totalRowCount)??0,g=d.length,f=j.useCallback(a=>{if(a){const{scrollHeight:r,scrollTop:P,clientHeight:U}=a;r-P-U<300&&!l&&g<m&&h()}},[h,l,g,m]);j.useEffect(()=>{f(c.current)},[f]);const p=I({data:d,columns:u,state:{sorting:s},onSortingChange:t,getCoreRowModel:_(),getSortedRowModel:ee(),debugTable:!0}),{rows:x}=p.getRowModel(),i=A({parentRef:c,size:x.length,overscan:10}),{virtualItems:o,totalSize:w}=i,R=o.length>0&&((V=o==null?void 0:o[0])==null?void 0:V.start)||0,D=o.length>0?w-(((K=o==null?void 0:o[o.length-1])==null?void 0:K.end)||0):0;let M=[];return p.getAllColumns().map(a=>M.push({label:typeof a.columnDef.header=="string"?a.columnDef.header:"#",key:a.columnDef.accessorKey})),e.jsx(B,{content:!1,title:"Virtualized Infinite Scroll",secondary:e.jsx(W,{data:o.map(a=>x[a.index].original),headers:M,filename:"virtualized-ininite.csv"}),children:e.jsx(F,{children:e.jsx(G,{component:O,ref:c,onScroll:a=>f(a.target),sx:{maxHeight:544,overflow:"auto"},children:e.jsxs(L,{children:[e.jsx(q,{children:p.getHeaderGroups().map(a=>e.jsx(b,{children:a.headers.map(r=>(r.column.columnDef.meta!==void 0&&r.column.getCanSort()&&Object.assign(r.column.columnDef.meta,{className:r.column.columnDef.meta.className+" cursor-pointer prevent-select"}),e.jsx(v,{...r.column.columnDef.meta,onClick:r.column.getToggleSortingHandler(),...r.column.getCanSort()&&r.column.columnDef.meta===void 0&&{className:"cursor-pointer prevent-select"},children:r.isPlaceholder?null:e.jsxs(Y,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(Z,{children:C(r.column.columnDef.header,r.getContext())}),r.column.getCanSort()&&e.jsx(te,{column:r.column})]})},r.id)))},a.id))}),e.jsxs(X,{children:[R>0&&e.jsx(b,{children:e.jsx(v,{sx:{height:`${R}px`,whiteSpace:"nowrap"}})}),o.map(a=>{const r=x[a.index];return e.jsx(b,{children:r.getVisibleCells().map(P=>e.jsx(v,{sx:{whiteSpace:"nowrap"},...P.column.columnDef.meta,children:C(P.column.columnDef.cell,P.getContext())},P.id))},r.id)}),D>0&&e.jsx(b,{children:e.jsx(v,{sx:{height:`${D}px`,whiteSpace:"nowrap"}})})]})]})})})})},ge=()=>e.jsx(ie,{client:he,children:e.jsx(de,{})});function J({columns:c,data:s}){var p,x;const t=I({data:s,columns:c,getCoreRowModel:_()}),u=j.useRef(null),{rows:n}=t.getRowModel(),h=A({parentRef:u,size:n.length,overscan:10}),{virtualItems:l,totalSize:d}=h,m=l.length>0&&((p=l==null?void 0:l[0])==null?void 0:p.start)||0,g=l.length>0?d-(((x=l==null?void 0:l[l.length-1])==null?void 0:x.end)||0):0;let f=[];return t.getAllColumns().map(i=>f.push({label:typeof i.columnDef.header=="string"?i.columnDef.header:"#",key:i.columnDef.accessorKey})),e.jsx(B,{content:!1,title:"Virtualized Rows",secondary:e.jsx(W,{data:l.map(i=>n[i.index].original),headers:f,filename:"virtualized-row.csv"}),children:e.jsx(F,{children:e.jsx(G,{component:O,ref:u,sx:{maxHeight:544},children:e.jsxs(L,{children:[e.jsx(q,{className:"sticky-header",children:t.getHeaderGroups().map(i=>e.jsx(b,{children:i.headers.map(o=>e.jsx(v,{...o.column.columnDef.meta,children:o.isPlaceholder?null:C(o.column.columnDef.header,o.getContext())},o.id))},i.id))}),e.jsxs(X,{children:[m>0&&e.jsx(b,{children:e.jsx(v,{sx:{height:`${m}px`,whiteSpace:"nowrap"}})}),l.map(i=>{const o=n[i.index];return e.jsx(b,{children:o.getVisibleCells().map(w=>e.jsx(v,{sx:{whiteSpace:"nowrap"},...w.column.columnDef.meta,children:C(w.column.columnDef.cell,w.getContext())},w.id))},o.id)}),g>0&&e.jsx(b,{children:e.jsx(v,{sx:{height:`${g}px`,whiteSpace:"nowrap"}})})]})]})})})})}J.propTypes={columns:$.array,data:$.array};const fe=()=>{const c=Q(100),s=j.useMemo(()=>[{header:"Name",accessorKey:"fullName"},{header:"Email",accessorKey:"email"},{header:"Age",accessorKey:"age",meta:{className:"cell-right"}},{header:"Role",accessorKey:"role"},{header:"Visits",accessorKey:"visits",meta:{className:"cell-right"}},{header:"Status",accessorKey:"status",cell:t=>{switch(t.getValue()){case"Complicated":return e.jsx(y,{color:"error",label:"Complicated",size:"small",variant:"light"});case"Relationship":return e.jsx(y,{color:"success",label:"Relationship",size:"small",variant:"light"});case"Single":default:return e.jsx(y,{color:"info",label:"Single",size:"small",variant:"light"})}}},{header:"Profile Progress",accessorKey:"progress",cell:t=>e.jsx(E,{value:t.getValue(),sx:{minWidth:75}})}],[]);return e.jsx(J,{columns:s,data:c})},Ke=()=>e.jsxs(S,{container:!0,spacing:3,children:[e.jsx(S,{item:!0,xs:12,children:e.jsx(ge,{})}),e.jsx(S,{item:!0,xs:12,children:e.jsx(fe,{})})]});export{Ke as default};
