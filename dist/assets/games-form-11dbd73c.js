import{y,r as l,z as G,j as e,G as s,M as D,a2 as I,p as o,aQ as d,D as f,a6 as L,cF as M,L as b,d as v,x as F,H as k,ai as z,g as S}from"./index-d0b17951.js";import{S as E}from"./SingleFile-780a7363.js";import{M as N}from"./MultiFile-53aca481.js";import"./PlaceholderContent-9de91dba.js";import"./CloseCircleFilled-348b1503.js";function A(){const{id:i}=y(),[p,m]=l.useState(""),[h,u]=l.useState(""),[n,x]=l.useState(null),[r,j]=l.useState([]),w=G(),C=async()=>{const a=new FormData;a.append("name",p),a.append("description",h),(n==null?void 0:n.length)>0&&n[0]instanceof File&&a.append("image",n[0]),(r==null?void 0:r.length)>0&&r.forEach(t=>{t instanceof File?a.append("images[]",t):a.append("images_paths[]",t==null?void 0:t.path)});try{i?await F.putForm(`/api/game/${i}`,a):await F.postForm("/api/game",a),k({open:!0,message:i?"Game updated":"New Game created",variant:"alert",alert:{color:"success"},anchorOrigin:{vertical:"top",horizontal:"right"},transition:"SlideLeft"}),w("/admin/games")}catch{}};return l.useEffect(()=>{i&&(async t=>{try{const{data:c}=await z(`/api/game/${t}`);m(c.name),u(c.description),x([{preview:S(c.imagePath)}]),j(c.imagesPaths.map(g=>({preview:S(g),type:"image/jpeg",path:g})))}catch{}})(i)},[i]),e.jsx(s,{container:!0,spacing:3,justifyContent:"center",children:e.jsx(s,{item:!0,xs:12,md:6,lg:6,children:e.jsx(s,{container:!0,spacing:3,children:e.jsx(s,{item:!0,xs:12,children:e.jsxs(D,{title:"",content:!1,children:[e.jsx(I,{children:e.jsxs(s,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(s,{item:!0,xs:12,children:e.jsxs(o,{spacing:1,children:[e.jsx(d,{children:"Game Name"}),e.jsx(f,{fullWidth:!0,placeholder:"Game name",onChange:a=>m(a.target.value),value:p})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(o,{spacing:1,children:[e.jsx(d,{children:"Description"}),e.jsx(f,{fullWidth:!0,placeholder:"Description",onChange:a=>u(a.target.value),value:h,multiline:!0,rows:4})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(o,{spacing:1,children:[e.jsx(d,{children:"Main Image"}),e.jsx(s,{item:!0,xs:12,container:!0,justifyContent:"center",children:e.jsx(s,{item:!0,xs:7,children:e.jsx(E,{setFieldValue:(a,t)=>x(t),file:n})})})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(o,{spacing:1,children:[e.jsx(d,{children:"Game Images"}),e.jsx(N,{showList:!0,setFieldValue:(a,t)=>j(t),files:r})]})})]})}),e.jsx(L,{}),e.jsx(M,{children:e.jsxs(o,{direction:"row",spacing:1,justifyContent:"flex-end",sx:{width:1,px:1.5,py:.75},children:[e.jsx(b,{to:"/admin/games",children:e.jsx(v,{color:"error",size:"small",children:"Cancel"})}),e.jsx(v,{variant:"contained",size:"small",onClick:()=>C(),children:"Submit"})]})})]})})})})})}export{A as default};
