import{r as o,P as ie,a3 as Kt,j as e,M as pe,aV as wt,am as Mt,G as te,p as j,T as m,L as re,d as ae,aB as qt,B as _t,aO as pt,aP as zt,D as ht,aS as Yt,a9 as gt,I as ft,Z as Qt,x as Me,H as Ye}from"./index-385486e1.js";import{C as Ht}from"./ComponentSkeleton-5c04c834.js";import{L as yt}from"./LoadingButton-4c2515b9.js";import{_ as ve}from"./react-apexcharts.min-4111cbf3.js";import{u as Vt,S as Xt,f as mt,b as Zt}from"./ScrollX-24c9a4bb.js";import"./Filter-007e8884.js";import{E as Jt,R as es}from"./RowEditable-83d10018.js";import"./LinearWithLabel-d4faaa73.js";import{T as ts,a as ss,b as ns}from"./TableContainer-d302c391.js";import{T as as}from"./TableHead-ba18de85.js";import{T as Dt}from"./TableRow-b3d27e35.js";import{T as jt}from"./TableCell-a3c8540c.js";import{S as rs}from"./Slider-e735178d.js";import{S as is}from"./SendOutlined-d2c55364.js";import"./Skeleton-81b92fc8.js";import"./DownloadOutlined-8d61756c.js";import"./CaretUpOutlined-f2cd8683.js";import"./CaretDownOutlined-4190f126.js";import"./Pagination-ad14ccaa.js";import"./index-ccd6cfed.js";import"./Checkbox-ca253678.js";import"./MinusOutlined-9acd1004.js";import"./visuallyHidden-14c3de6e.js";function os(y,c,h,ee){var I=this,S=o.useRef(null),V=o.useRef(0),k=o.useRef(0),O=o.useRef(null),D=o.useRef([]),R=o.useRef(),M=o.useRef(),w=o.useRef(y),q=o.useRef(!0);w.current=y;var oe=typeof window<"u",le=!c&&c!==0&&oe;if(typeof y!="function")throw new TypeError("Expected a function");c=+c||0;var he=!!(h=h||{}).leading,We=!("trailing"in h)||!!h.trailing,de="maxWait"in h,l="debounceOnServer"in h&&!!h.debounceOnServer,x=de?Math.max(+h.maxWait||0,c):null;o.useEffect(function(){return q.current=!0,function(){q.current=!1}},[]);var Y=o.useMemo(function(){var Q=function(_){var H=D.current,r=R.current;return D.current=R.current=null,V.current=_,k.current=k.current||_,M.current=w.current.apply(r,H)},X=function(_,H){le&&cancelAnimationFrame(O.current),O.current=le?requestAnimationFrame(_):setTimeout(_,H)},Ge=function(_){if(!q.current)return!1;var H=_-S.current;return!S.current||H>=c||H<0||de&&_-V.current>=x},Re=function(_){return O.current=null,We&&D.current?Q(_):(D.current=R.current=null,M.current)},ge=function _(){var H=Date.now();if(he&&k.current===V.current&&Te(),Ge(H))return Re(H);if(q.current){var r=c-(H-S.current),a=de?Math.min(r,x-(H-V.current)):r;X(_,a)}},Te=function(){ee&&ee({})},fe=function(){if(oe||l){var _=Date.now(),H=Ge(_);if(D.current=[].slice.call(arguments),R.current=I,S.current=_,H){if(!O.current&&q.current)return V.current=S.current,X(ge,c),he?Q(S.current):M.current;if(de)return X(ge,c),Q(S.current)}return O.current||X(ge,c),M.current}};return fe.cancel=function(){O.current&&(le?cancelAnimationFrame(O.current):clearTimeout(O.current)),V.current=0,D.current=S.current=R.current=O.current=null},fe.isPending=function(){return!!O.current},fe.flush=function(){return O.current?Re(Date.now()):M.current},fe},[he,de,c,x,We,le,oe,l,ee]);return Y}const St=({row:y,table:c})=>{var S;const h=(S=c==null?void 0:c.options)==null?void 0:S.meta,ee=V=>{h==null||h.setSelectedRow(k=>({...k,[y.id]:!k[y.id]})),h==null||h.revertData(y.index,(V==null?void 0:V.currentTarget.name)==="cancel")},I=()=>{h==null||h.saveData(y.index)};return e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",children:[(h==null?void 0:h.selectedRow[y.id])&&e.jsx(gt,{title:"Cancel",children:e.jsx(ft,{color:"error",name:"cancel",onClick:ee,children:e.jsx(Qt,{})})}),e.jsx(gt,{title:h!=null&&h.selectedRow[y.id]?"Save":"Edit",children:e.jsx(ft,{color:h!=null&&h.selectedRow[y.id]?"success":"primary",onClick:h!=null&&h.selectedRow[y.id]?I:ee,children:h!=null&&h.selectedRow[y.id]?e.jsx(is,{}):e.jsx(Jt,{})})})]})};St.propTypes={row:ie.object,table:ie.object,options:ie.array,id:ie.number,index:ie.number};ie.node,ie.number,ie.number;const bt=Kt("input")({display:"none"});bt.displayName="Input";const Se=y=>{let c=0,h=y.length-1;for(;c<y.length&&Number(y[c])===0;)c++;for(;h>=0&&Number(y[h])===0;)h--;return y.slice(c,h+1)},vt=(y,c,h)=>y.map(I=>{const S=Se(I.data);return{...I,data:S.slice(0,14)}}),Ke=({getValue:y})=>{const c=y();return`${Number((c||0).toFixed(2)).toLocaleString()}`};function be({columns:y,data:c,setData:h}){const[ee,I]=o.useState(()=>[...c]),[S,V]=o.useState({}),k=Vt({data:c,columns:y,defaultColumn:{cell:es},getCoreRowModel:Zt(),meta:{selectedRow:S,setSelectedRow:V,revertData:(D,R)=>{R?h(M=>M.map((w,q)=>q===D?ee[D]:w)):I(M=>M.map((w,q)=>q===D?c[D]:w))},updateData:(D,R,M)=>{h(w=>w.map((q,oe)=>oe===D?{...w[D],[R]:M}:q))},saveData:async D=>{try{const R=c[D],M=await Me.put(`/api/launchGames/${R._id}`,R);Ye({open:!0,message:"Saved successfully!",variant:"alert",alert:{color:"success"}}),V(w=>({...w,[D]:!1}))}catch{Ye({open:!0,message:"Error!",variant:"alert",alert:{color:"error"}})}}},debugTable:!0});let O=[];return k.getAllColumns().map(D=>D.columnDef.accessorKey&&O.push({label:typeof D.columnDef.header=="string"?D.columnDef.header:"#",key:D.columnDef.accessorKey})),e.jsx(pe,{content:!1,children:e.jsx(Xt,{children:e.jsx(ts,{children:e.jsxs(ss,{children:[e.jsx(as,{children:k.getHeaderGroups().map(D=>e.jsx(Dt,{children:D.headers.map(R=>e.jsx(jt,{...R.column.columnDef.meta,children:R.isPlaceholder?null:mt(R.column.columnDef.header,R.getContext())},R.id))},D.id))}),e.jsx(ns,{children:k.getRowModel().rows.map(D=>e.jsx(Dt,{children:D.getVisibleCells().map(R=>e.jsx(jt,{...R.column.columnDef.meta,children:mt(R.column.columnDef.cell,R.getContext())},R.id))},D.id))})]})})})})}be.propTypes={columns:ie.array,data:ie.array,setData:ie.func};function ls({data:y,games:c}){const h=wt(),[ee,I]=o.useState(h.pathname==="/admin/report"),[S,V]=o.useState([]),[k,O]=o.useState([]),[D,R]=o.useState([]),[M,w]=o.useState({value:0,date:""}),[q,oe]=o.useState([]);o.useEffect(()=>{const l=r=>{const a=r.getUTCMonth();return Math.floor(a/3)+1},x=r=>{const T=r.map(N=>new Date(N.summary)).sort((N,ne)=>N-ne),se=T[0],Ce=T[T.length-1],ce=se.getFullYear(),ye=l(se),Ie=Ce.getFullYear(),Fe=l(Ce),me=[];for(let N=ce;N<=Ie;N++)for(let ne=1;ne<=4;ne++)if(!(N===ce&&ne<ye)){if(N===Ie&&ne>Fe)break;me.push(`${N}-Q${ne}`)}return me},Y=[...new Set(y.map(r=>r.summary.split("-")[0]))];if(O(Y),y&&y.length>0){const r=x(y);R(r)}const Q=Object.values(y.reduce((r,{game:a,summary:T,betsEuro:se,winsEuro:Ce,ggrEuro:ce,avgBet:ye,spins:Ie,uniquePlayers:Fe})=>{r[a]||(r[a]={_id:"",name:a,maxDate:T,years:{},totalGGR:0,latestWeekStart:"",secLatestWeekStart:"",latestWeekGGR:[],secLatestWeekGGR:[],latestWeekAvgBet:[],secLatestWeekAvgBet:[],remainDays:0,weekAverage:0,weekAvgBet:0,weekChange:0,weekSum1:0,weekSum2:0,weekChangeColor:"",dailyTotalGGR:0,projectedTotalGGR:0,LifeTimePayout:0,betsEuro:se,winsEuro:Ce,dailyAvgBet:0,totalAvgBet:0,avgBetCount:0});const me=c.find(ke=>ke.name===a);r[a].launchDate=me.launchDate,r[a]._id=me._id,r[a].totalGGR+=ce,ye&&ye>0&&(r[a].totalAvgBet+=ye,r[a].avgBetCount+=1,r[a].dailyAvgBet=r[a].totalAvgBet/r[a].avgBetCount);const N=T.split("-")[0];r[a].years[N]||(r[a].years[N]=0),r[a].years[N]+=ce,r[a][`totalGGR_${N}`]||(r[a][`totalGGR_${N}`]=0),r[a][`totalGGR_${N}`]+=ce;const ne=l(new Date(T)),Le=`${N}-Q${ne}`;if(r[a][`totalGGR_${Le}`]||(r[a][`totalGGR_${Le}`]=0),r[a][`totalGGR_${Le}`]+=ce,new Date(me.launchDate)<=new Date(T)){const ke=new Date(r[a].maxDate)<new Date(T);r[a].maxDate=ke?T:r[a].maxDate,r[a].dailyTotalGGR=ke?ce:r[a].dailyTotalGGR;const Oe=new Date(r[a].maxDate),Qe=new Date(Oe.getFullYear(),11,31);r[a].remainDays=Math.ceil((Qe-Oe)/(1e3*60*60*24));const qe=Oe.getFullYear().toString(),He=r[a][`totalGGR_${qe}`]||0,_e=r[a].weekAverage*r[a].remainDays;r[a].projectedTotalGGR=He+_e;const Ne=new Date(r[a].maxDate),De=new Date(Ne);De.setDate(De.getDate()-6);const Pe=new Date(De);Pe.setDate(Pe.getDate()-7);const Ae=new Date(De);Ae.setDate(Ae.getDate()-1),r[a].latestWeekStart=De.toISOString().split("T")[0],r[a].secLatestWeekStart=Pe.toISOString().split("T")[0],r[a].latestWeekGGR=y.filter(f=>f.game===a&&new Date(f.summary)>=De&&new Date(f.summary)<=Ne).map(f=>f.ggrEuro),r[a].secLatestWeekGGR=y.filter(f=>f.game===a&&new Date(f.summary)>=Pe&&new Date(f.summary)<=Ae).map(f=>f.ggrEuro),r[a].latestWeekAvgBet=y.filter(f=>f.game===a&&new Date(f.summary)>=De&&new Date(f.summary)<=Ne).map(f=>f.avgBet||0),r[a].secLatestWeekAvgBet=y.filter(f=>f.game===a&&new Date(f.summary)>=Pe&&new Date(f.summary)<=Ae).map(f=>f.avgBet||0),r[a].weekSum1=r[a].latestWeekGGR.reduce((f,J)=>f+J,0),r[a].weekSum2=r[a].secLatestWeekGGR.reduce((f,J)=>f+J,0),r[a].weekAverage=r[a].latestWeekGGR.reduce((f,J)=>f+J,0)/r[a].latestWeekGGR.length;const Be=r[a].latestWeekAvgBet.filter(f=>f>0);r[a].weekAvgBet=Be.length>0?Be.reduce((f,J)=>f+J,0)/Be.length:0,r[a].weekChange=(r[a].latestWeekGGR.reduce((f,J)=>f+J,0)-r[a].secLatestWeekGGR.reduce((f,J)=>f+J,0))/r[a].secLatestWeekGGR.reduce((f,J)=>f+J,0)*100,r[a].weekChangeColor=e.jsx("span",{style:{color:r[a].weekChange>0?"green":"red"},children:`${Number(r[a].weekChange.toFixed(2)).toLocaleString()} %`}),r[a].LifeTimePayout=r[a].betsEuro>0?(r[a].winsEuro/r[a].betsEuro*100).toFixed(2):0}return r},{}));V(Q);const X=y.reduce((r,{summary:a,ggrEuro:T})=>(r[a]||(r[a]=0),r[a]+=T,r),{}),Ge=Math.max(...Object.values(X)),Re=Object.keys(X).find(r=>X[r]===Ge);w({value:Ge,date:Re});const ge=new Date,Te=new Date(ge);Te.setDate(Te.getDate()-1);const fe=ge.toISOString().split("T")[0],_=Te.toISOString().split("T")[0],H=c.map(r=>{const a=y.find(se=>se.game===r.name&&se.summary.split("T")[0]===fe),T=y.find(se=>se.game===r.name&&se.summary.split("T")[0]===_);return{gameName:r.name,totalUsersToday:(a==null?void 0:a.uniquePlayers)||0,totalUsersPrevious:(T==null?void 0:T.uniquePlayers)||0,cwppToday:a?a.betsEuro/a.uniquePlayers:0,cwppPrevious:T?T.betsEuro/T.uniquePlayers:0,spuToday:a?a.spins/a.uniquePlayers:0,spuPrevious:T?T.spins/T.uniquePlayers:0,aveBetToday:(a==null?void 0:a.avgBet)||0,aveBetPrevious:(T==null?void 0:T.avgBet)||0,totalCoinsToday:(a==null?void 0:a.betsEuro)||0,totalCoinsPrevious:(T==null?void 0:T.betsEuro)||0}});oe(H)},[y,c]);const le=o.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text",cell:({getValue:l,row:x})=>{const Y=l();return e.jsx(re,{style:{textDecoration:"none"},to:ee?`/admin/report-one/${x.original._id}`:`/report-one/${x.original._id}`,children:Y})}},{header:"Launch Date",accessorKey:"launchDate",dataType:"text",cell:({getValue:l,row:x,table:Y})=>{var X;const Q=l();return`${(X=Q==null?void 0:Q.split("T"))==null?void 0:X[0]}`}},{header:"Daily Total GGR",accessorKey:"dailyTotalGGR",dataType:"text",cell:Ke},{header:"Projected Total GGR",accessorKey:"projectedTotalGGR",dataType:"text",cell:Ke},...(k==null?void 0:k.map(l=>({header:`Total GGR ${l}`,accessorKey:`totalGGR_${l}`,dataType:"text",cell:Ke})))||[],{header:"Lifetime GGR",accessorKey:"totalGGR",dataType:"text",cell:Ke},{header:"7 Day Average",accessorKey:"weekAverage",dataType:"text",cell:Ke},{header:"Daily Average Bet",accessorKey:"dailyAvgBet",dataType:"text",cell:({getValue:l})=>{const x=l();return x?`${Number(x.toFixed(2)).toLocaleString()}%`:"0%"}},{header:"7 Day Average Bet",accessorKey:"weekAvgBet",dataType:"text",cell:({getValue:l})=>{const x=l();return x?`${Number(x.toFixed(2)).toLocaleString()}%`:"0%"}},{header:"7 Day Change",accessorKey:"weekChangeColor",dataType:"text"},{header:"Lifetime Payout",accessorKey:"LifeTimePayout",dataType:"text",cell:({getValue:l})=>{const x=l();return x?`${x}%`:"0.00%"}}],[k]),he=o.useMemo(()=>{const l=[];return D.forEach(x=>{const Y={quarter:x};S.forEach(Q=>{const X=Q[`totalGGR_${x}`]!==void 0?Number(Q[`totalGGR_${x}`].toFixed(2)).toLocaleString():0;Y[Q.name]=X}),l.push(Y)}),l},[D,S]),We=o.useMemo(()=>{const l=c.map(x=>x.name);return[{header:"Quarter",accessorKey:"quarter",dataType:"text"},...l.map(x=>({header:x,accessorKey:x,dataType:"number",cell:Y=>Y.getValue()??0}))]},[c]),de=o.useMemo(()=>[{header:"Game Name",accessorKey:"gameName",dataType:"text",cell:({getValue:l})=>l()},{header:e.jsxs("div",{style:{textAlign:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Total Users"}),e.jsxs("div",{style:{display:"flex",fontSize:"0.8em"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:"Today"})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#666"},children:"Previous"})})]})]}),accessorKey:"totalUsers",dataType:"text",cell:({row:l})=>e.jsxs("div",{style:{display:"flex",justifyContent:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:Number(l.original.totalUsersToday).toLocaleString()})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{color:"#666"},children:Number(l.original.totalUsersPrevious).toLocaleString()})})]})},{header:e.jsxs("div",{style:{textAlign:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"CWPP"}),e.jsxs("div",{style:{display:"flex",fontSize:"0.8em"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:"Today"})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#666"},children:"Previous"})})]})]}),accessorKey:"cwpp",dataType:"text",cell:({row:l})=>e.jsxs("div",{style:{display:"flex",justifyContent:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:Number(l.original.cwppToday.toFixed(2)).toLocaleString()})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{color:"#666"},children:Number(l.original.cwppPrevious.toFixed(2)).toLocaleString()})})]})},{header:e.jsxs("div",{style:{textAlign:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"SPU"}),e.jsxs("div",{style:{display:"flex",fontSize:"0.8em"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:"Today"})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#666"},children:"Previous"})})]})]}),accessorKey:"spu",dataType:"text",cell:({row:l})=>e.jsxs("div",{style:{display:"flex",justifyContent:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:Number(l.original.spuToday.toFixed(2)).toLocaleString()})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{color:"#666"},children:Number(l.original.spuPrevious.toFixed(2)).toLocaleString()})})]})},{header:e.jsxs("div",{style:{textAlign:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Ave Bet"}),e.jsxs("div",{style:{display:"flex",fontSize:"0.8em"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:"Today"})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#666"},children:"Previous"})})]})]}),accessorKey:"aveBet",dataType:"text",cell:({row:l})=>e.jsxs("div",{style:{display:"flex",justifyContent:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsxs("span",{style:{fontWeight:"bold",color:"#1976d2"},children:[Number(l.original.aveBetToday.toFixed(2)).toLocaleString(),"%"]})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsxs("span",{style:{color:"#666"},children:[Number(l.original.aveBetPrevious.toFixed(2)).toLocaleString(),"%"]})})]})},{header:e.jsxs("div",{style:{textAlign:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Total Coins"}),e.jsxs("div",{style:{display:"flex",fontSize:"0.8em"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:"Today"})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#666"},children:"Previous"})})]})]}),accessorKey:"totalCoins",dataType:"text",cell:({row:l})=>e.jsxs("div",{style:{display:"flex",justifyContent:"center",border:"1px solid #d0d0d0",padding:"8px"},children:[e.jsx("div",{style:{flex:1,textAlign:"center",borderRight:"1px solid #d0d0d0",paddingRight:"8px"},children:e.jsx("span",{style:{fontWeight:"bold",color:"#1976d2"},children:Number(l.original.totalCoinsToday).toLocaleString()})}),e.jsx("div",{style:{flex:1,textAlign:"center",paddingLeft:"8px"},children:e.jsx("span",{style:{color:"#666"},children:Number(l.original.totalCoinsPrevious).toLocaleString()})})]})}],[]);return e.jsxs(te,{item:!0,xs:12,lg:12,children:[e.jsxs(te,{container:!0,spacing:{xs:1,sm:2},mb:5,children:[e.jsx(te,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(j,{direction:"column",spacing:1,alignItems:"center",justifyContent:"center",sx:{textAlign:"center"},children:[e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",children:[e.jsx(m,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:"Lifetime GGR - "}),e.jsx(m,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:Number(S.reduce((l,x)=>l+x.totalGGR,0)).toLocaleString()})]}),e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",children:[e.jsx(m,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:"Highest Daily GGR Record - "}),e.jsx(m,{variant:{xs:"h6",sm:"h6"},textAlign:"center",sx:{fontWeight:"bold",color:"primary.main"},children:Number(M.value).toLocaleString()})]}),e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",children:[e.jsx(m,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:"Date - "}),e.jsx(m,{variant:{xs:"h6",sm:"h6"},textAlign:"center",sx:{fontWeight:"bold"},children:M.date?M.date.split("T")[0]:""})]})]})})}),e.jsx(te,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{textAlign:"center"},children:[e.jsx(m,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:"Daily Total GGR -"}),e.jsx(m,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:Number(S.reduce((l,x)=>l+x.dailyTotalGGR,0)).toLocaleString()})]})})}),e.jsx(te,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{textAlign:"center"},children:[e.jsx(m,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:"7 Day Average GGR -"}),e.jsx(m,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:Number(S.reduce((l,x)=>l+x.weekAverage,0)).toLocaleString()})]})})}),e.jsx(te,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{textAlign:"center"},children:[e.jsx(m,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:"7 Day Change -"}),e.jsx(m,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:((S.reduce((l,x)=>l+x.weekSum1,0)-S.reduce((l,x)=>l+x.weekSum2,0))/S.reduce((l,x)=>l+x.weekSum2,0)*100).toFixed(2)+"%"})]})})}),e.jsx(te,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"center",sx:{textAlign:"center"},children:[e.jsx(m,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:`Projected GGR ${k.reduce((l,x)=>Math.max(l,x),-1/0)} -`}),e.jsx(m,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:Number(S.reduce((l,x)=>l+x.projectedTotalGGR,0)).toLocaleString()})]})})}),e.jsx(te,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:D==null?void 0:D.map((l,x)=>e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"start",sx:{textAlign:"center"},children:[e.jsx(m,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:`Total GGR ${l} - `}),e.jsx(m,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:Number(S.reduce((Y,Q)=>Y+(Q[`totalGGR_${l}`]||0),0)).toLocaleString()})]},x))})}),e.jsx(te,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(pe,{sx:{height:"100%",display:"flex",alignItems:"center"},children:k==null?void 0:k.map((l,x)=>e.jsxs(j,{direction:"row",spacing:1,alignItems:"center",justifyContent:"start",sx:{textAlign:"center"},children:[e.jsx(m,{variant:{xs:"h6",sm:"h5"},textAlign:"center",sx:{fontWeight:"bold"},children:`Total Revenue ${l} - `}),e.jsx(m,{variant:{xs:"h6",sm:"h6"},textAlign:"center",children:Number(S.reduce((Y,Q)=>Y+(Q[`totalGGR_${l}`]||0),0)).toLocaleString()})]},x))})})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"Games Data"}),e.jsx(be,{data:S,columns:le})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"Today vs Previous Day Comparison"}),e.jsx(be,{data:q,columns:de})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"TOTAL GGR - QUARTER"}),e.jsx(be,{data:he,columns:We,setData:()=>{}})]})]})}const we={chart:{height:100,type:"line",zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"straight",width:3},xaxis:{categories:[]}},Ls=()=>{const y=wt(),[c,h]=o.useState(y.pathname==="/admin/report"),{user:ee}=Mt();o.useState(0);const[I,S]=o.useState(!1),[V,k]=o.useState(!1),[O,D]=o.useState([]),[R,M]=o.useState([]),[w,q]=o.useState([]),[oe,le]=o.useState(!0),[he,We]=o.useState(""),[de,l]=o.useState(""),[x,Y]=o.useState(!1),[Q,X]=o.useState([]),[Ge,Re]=o.useState([]),[ge,Te]=o.useState([]),[fe,_]=o.useState([]),[H,r]=o.useState([]),[a,T]=o.useState(we),[se,Ce]=o.useState([]),[ce,ye]=o.useState(we),[Ie,Fe]=o.useState(we),[me,N]=o.useState(we),[ne,Le]=o.useState(we),[ke,Oe]=o.useState(we),[Qe,qe]=o.useState(we),[He,_e]=o.useState([]),[Ne,De]=o.useState(new Date().toISOString().split("T")[0]),[Pe,Ae]=o.useState([]),[Be,f]=o.useState(we),[J,tt]=o.useState([]),[Gt,st]=o.useState([]),[Rt,nt]=o.useState([]),[Tt,at]=o.useState([]),[P,Ve]=o.useState([1,37]),[Ct,Pt]=o.useState(0),At=os((b,B)=>{Ve(B)},300),Wt=(b,B)=>{Ve(B),At(b,B)},Lt=o.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"Launch Date",accessorKey:"launchDate",dataType:"date",cell:({getValue:b,row:B,table:v})=>{var i,d;const G=(i=v==null?void 0:v.options)==null?void 0:i.meta,je=(d=G==null?void 0:G.selectedRow)==null?void 0:d[B.id],Z=b(),ue=Z?new Date(Z).toISOString().split("T")[0]:"";return je?e.jsx("input",{type:"date",value:ue,onChange:A=>G==null?void 0:G.updateData(B.index,"launchDate",A.target.value)}):ue}},{header:"Actions",id:"edit",cell:St,meta:{className:"cell-center"}}],[]),kt=o.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"TOTAL GGR",accessorKey:"data",dataType:"text",cell:({getValue:b,row:B,table:v})=>{const G=b();return`${(Number(G[G.length-1])||0).toLocaleString()}`}}],[]),Ot=o.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"GGR",accessorKey:"ggrEuro",dataType:"text"},{header:"SPINS",accessorKey:"spins",dataType:"text"},{header:"USERS",accessorKey:"uniquePlayers",dataType:"text"},{header:"SPU",accessorKey:"SPU",dataType:"text"},{header:"CWPP",accessorKey:"CWPP",dataType:"text"},{header:"Coins Wagered",accessorKey:"CW",dataType:"text"},{header:"Lifetime Payout",accessorKey:"LP",dataType:"text"}],[]),Ut=o.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"GGR",accessorKey:"ggrEuro",dataType:"text"},{header:"SPINS",accessorKey:"spins",dataType:"text"},{header:"USERS",accessorKey:"uniquePlayers",dataType:"text"},{header:"SPU",accessorKey:"SPU",dataType:"text"},{header:"CWPP",accessorKey:"CWPP",dataType:"text"}],[]),[Xe,Et]=o.useState(null);o.useEffect(()=>{const b=[];for(let i=0;i<7;i++){const d=new Date;d.setDate(d.getDate()-i),b.push(d.toISOString().split("T")[0])}const B=R.reduce((i,{game:d,summary:A})=>{if(!i[d]){const U=w.find(L=>L.name===d);i[d]={...U,maxDate:A}}const $=new Date(i[d].maxDate)<new Date(A);return i[d].maxDate=$?A:i[d].maxDate,Et(i[d].maxDate),i},{}),v={},je=Object.values(R.reduce((i,{game:d,summary:A,ggrEuro:$,spins:U,uniquePlayers:L,betsEuro:E,winsEuro:F})=>{i[d]||(i[d]={name:d,ggrEuro:[],spins:[],uniquePlayers:[],SPU:[],CWPP:[],CW:[],LP:[]});const W=w.find($e=>$e.name===d);new Date(W==null?void 0:W.launchDate)<new Date(A),v[d]&&new Date(v[d])<new Date(A.split("T")[0])?v[d]=A.split("T")[0]:v[d]||(v[d]=A.split("T")[0]);const K=new Date(B[d].maxDate)||new Date,Ue=new Date(K);return Ue.setDate(Ue.getDate()-6),new Date(A)>=Ue&&new Date(A)<=K&&(i[d].ggrEuro.push($),i[d].spins.push(U),i[d].uniquePlayers.push(L),i[d].SPU.push(U/L),i[d].CWPP.push(E/L),i[d].CW.push(E),i[d].LP.push(F/E)),i},{})).map(i=>{const d=i.ggrEuro,A=i.spins,$=i.uniquePlayers,U=i.SPU,L=i.CWPP,E=i.LP,F=i.CW;return{name:i.name,ggrEuro:Number((d.length>0?d.reduce((W,K)=>W+K,0)/d.length:0).toFixed(2)).toLocaleString(),spins:Number((A.length>0?A.reduce((W,K)=>W+K,0)/A.length:0).toFixed(2)).toLocaleString(),uniquePlayers:Number(($.length>0?$.reduce((W,K)=>W+K,0)/$.length:0).toFixed(2)).toLocaleString(),SPU:Number((U.length>0?U.reduce((W,K)=>W+K,0)/U.length:0).toFixed(2)).toLocaleString(),CWPP:Number((L.length>0?L.reduce((W,K)=>W+K,0)/L.length:0).toFixed(2)).toLocaleString(),CW:Number((F.length>0?F.reduce((W,K)=>W+K,0)/F.length:0).toFixed(2)).toLocaleString(),LP:Number((E.length>0?E.reduce((W,K)=>W+K,0)/E.length:0).toFixed(2)).toLocaleString()}});Te(je);const ue=Object.values(R.reduce((i,{game:d,summary:A,ggrEuro:$,spins:U,uniquePlayers:L,betsEuro:E})=>{i[d]||(i[d]={name:d,ggrEuros:[],ggrEuro:0,ggrEuro2:0,spins:0,spins2:0,uniquePlayers:0,uniquePlayers2:0,SPU:0,SPU2:0,CWPP:0,CWPP2:0,arrSpins:[],arrSpins2:[]});const F=new Date(v[d]);F.setDate(F.getDate()-7);const W=new Date(v[d]);return W.setDate(W.getDate()-14),F<new Date(A)?(i[d].ggrEuros.push($),i[d].arrSpins.push(U),i[d].ggrEuro+=$,i[d].spins+=U,i[d].uniquePlayers+=L,i[d].SPU+=U/L,i[d].CWPP+=E/L):W<new Date(A)&&new Date(A)<=F&&(i[d].arrSpins2.push(U),i[d].ggrEuro2+=$,i[d].spins2+=U,i[d].uniquePlayers2+=L,i[d].SPU2+=U/L,i[d].CWPP2+=E/L),i},{})).map(i=>{const d=(i.ggrEuro-i.ggrEuro2)/(i.ggrEuro2||1),A=(i.spins-i.spins2)/(i.spins2||1),$=(i.uniquePlayers-i.uniquePlayers2)/(i.uniquePlayers2||1),U=(i.SPU-i.SPU2)/(i.SPU2||1),L=(i.CWPP-i.CWPP2)/(i.CWPP2||1);return{name:i.name,ggrEuro:e.jsx("span",{style:{color:d>=0?"green":"red"},children:`${(d*100).toFixed(2)} %`}),spins:e.jsx("span",{style:{color:A>=0?"green":"red"},children:`${(A*100).toFixed(2)} %`}),uniquePlayers:e.jsx("span",{style:{color:$>=0?"green":"red"},children:`${($*100).toFixed(2)} %`}),SPU:e.jsx("span",{style:{color:U>=0?"green":"red"},children:`${(U*100).toFixed(2)} %`}),CWPP:e.jsx("span",{style:{color:L>=0?"green":"red"},children:`${(L*100).toFixed(2)} %`})}});_(ue)},[Ge,R,w]);const rt=async()=>{var b,B,v;try{const G=await Me.get("api/reports");if(D(G.data.data),q(G.data.games),G.data.games.length>0){const je=G.data.games.length>0?(B=(b=G.data.games)==null?void 0:b.reduce((t,n)=>new Date(n.launchDate)<new Date(t.launchDate)?n:t).launchDate)==null?void 0:B.split("T")[0]:new Date().toISOString().split("T")[0],Z=[...G.data.data].filter(t=>new Date(t.summary)>=new Date(je));Z.sort((t,n)=>new Date(t.summary)-new Date(n.summary));const ue=[],i=Object.values(Z.reduce((t,{game:n,ggrEuro:u,summary:g})=>{t[n]||(t[n]={name:n,data:[],totalGGR:0});const p=G.data.games.find(C=>C.name===n);return t[n].totalGGR+=new Date(p==null?void 0:p.launchDate)>new Date(g)?0:u,t[n].data.push(t[n].totalGGR.toFixed(2)),ue.push(g.slice(0,10)),t},{})),d=Z.reduce((t,{summary:n,betsEuro:u,game:g})=>{const p=w.find(C=>C.name===g);if(new Date(p==null?void 0:p.launchDate)<=new Date(n)){const C=n.slice(0,10);t[C]||(t[C]=0),t[C]+=u}return t},{}),A=[{name:"Total Coins Wagered",data:Object.entries(d).sort(([t],[n])=>new Date(t)-new Date(n)).map(([t,n])=>Number(n.toFixed(2)))}];let $=0;const U=i.map(t=>($=Math.max($,t.data.length),{...t,data:Se(t.data)})),L=A.map(t=>{const n=P[0]-1,u=P[1]-1;return t.data=t.data.slice(n,u+1),t});Pt($),Ve([1,$]),r(U),Ce(L);const E=[...new Set(ue)];Re(E);const F=[];for(let t=P[0];t<=P[1];t++)F.push(`Day ${t}`);const W=(v=G.data.data)==null?void 0:v.map(t=>({...t,SPU:t.spins/t.uniquePlayers,CWPP:t.betsEuro/t.uniquePlayers}));M(W);const K=[];for(let t=0;t<14;t++)K.push(`Day ${t+1}`);f(t=>({...t,xaxis:{categories:K,labels:{show:!1}}})),Ae(vt(i,G.data.games,E));const $e=Object.values(Z.reduce((t,{game:n,summary:u,uniquePlayers:g})=>{t[n]||(t[n]={name:n,data:[]});const p=G.data.games.find(C=>C.name===n);return new Date(p==null?void 0:p.launchDate)<=new Date(u)&&t[n].data.push(g),t},{})).map(t=>{const n=P[0]-1,u=P[1]-1;return t.data=t.data.slice(n,u+1),t});tt($e);const it=t=>{if(t.length<6)return[];let n=new Array(5).fill(0);for(let u=5;u<t.length;u++){let g=t.slice(u-4,u+1).reduce((z,xe)=>z+xe,0),p=t.slice(u-5,u).reduce((z,xe)=>z+xe,0),C=((g-p)/(p||1)*100).toFixed(2);n.push(C)}return n},lt=Object.values(Z.reduce((t,{game:n,summary:u,uniquePlayers:g})=>{t[n]||(t[n]={name:n,data:[]});const p=G.data.games.find(C=>C.name===n);return new Date(p==null?void 0:p.launchDate)<=new Date(u)&&t[n].data.push(g),t},{})).map(t=>({...t,data:it(t.data)})).map(t=>{const n=P[0]-1,u=P[1]-1;return t.data=t.data.slice(n,u+1),{...t,data:t.data}});st(lt);const ct=Object.values(Z.reduce((t,{game:n,spins:u,summary:g})=>{t[n]||(t[n]={name:n,data:[]});const p=G.data.games.find(C=>C.name===n);return t[n].data.push(new Date(p==null?void 0:p.launchDate)>new Date(g)?0:u),t},{})).map(t=>{const n=P[0]-1,u=P[1]-1;return t.data=t.data.slice(n,u+1),{...t,data:Se(t.data)}});nt(ct);const Ze=Object.values(Z.reduce((t,{game:n,spins:u,uniquePlayers:g,summary:p})=>{t[n]||(t[n]={name:n,data:[]});const C=G.data.games.find(z=>z.name===n);return t[n].data.push(new Date(C==null?void 0:C.launchDate)>new Date(p)?0:(u/g).toFixed(2)),t},{})).map(t=>{const n=P[0]-1,u=P[1]-1;return t.data=t.data.slice(n,u+1),{...t,data:Se(t.data)}});X(F),T(t=>({...t,xaxis:{categories:F,labels:{show:!1}}})),ye(t=>({...t,xaxis:{categories:F,labels:{show:!1}},title:{text:"Daily Total Coins Wagered (All Games)",align:"center"},yaxis:{title:{text:"Total Coins"}}})),Fe(t=>({...t,xaxis:{categories:F,labels:{show:!1}}})),N(t=>({...t,xaxis:{categories:F,labels:{show:!1}}})),Le(t=>({...t,xaxis:{categories:F,labels:{show:!1}}})),Oe(t=>({...t,xaxis:{categories:F,labels:{show:!1}}})),at(Ze);const Je=Object.values(Z.reduce((t,{game:n,summary:u,ggrEuro:g})=>{t[n]||(t[n]={name:n,data:[]});const p=G.data.games.find(Ee=>Ee.name===n),C=Z.filter(Ee=>Ee.game===n).reduce((Ee,ut)=>new Date(ut.summary)>new Date(Ee)?ut.summary:Ee,"1970-01-01"),z=new Date(C),xe=new Date(z);return xe.setDate(xe.getDate()-6),new Date(u)>=xe&&new Date(u)<=z&&t[n].data.push(g),t},{})),et=Z.reduce((t,n)=>new Date(n.summary)>new Date(t)?n.summary:t,"1970-01-01"),ze=new Date(et),s=[];for(let t=6;t>=0;t--){const n=new Date(ze);n.setDate(n.getDate()-t),s.push(n.toISOString().split("T")[0])}_e(Je),qe(t=>({...t,xaxis:{categories:s,labels:{show:!0}},title:{text:"7 Day GGR",align:"center"}}))}}catch{}},It=async()=>{const b=localStorage.getItem("reportToken");le(b!=="true"),rt()};o.useEffect(()=>{It()},[]);const Ft=async b=>{if(b.target.files.length>0){const B=b.target.files[0];if(!B){alert("Please select a file first.");return}S(!0);const v=new FormData;v.append("file",B);try{const G=await Me.post("api/reports/upload",v,{headers:{"Content-Type":"multipart/form-data"}});Ye({open:!0,message:"Excel uploaded successfully!",variant:"alert",alert:{color:"success"}}),rt(),S(!0)}catch(G){console.error("Upload Error:",G),alert("Error uploading file.")}finally{S(!1),b.target.value=""}}},Nt=async()=>{k(!0);try{const b=await Me.get("api/reports/download",{responseType:"blob"}),B=window.URL.createObjectURL(new Blob([b.data])),v=document.createElement("a");v.href=B,v.setAttribute("download","report.xlsx"),document.body.appendChild(v),v.click(),document.body.removeChild(v)}catch(b){console.error("Download Error:",b),Ye({open:!0,message:"Excel not exists!",variant:"alert",alert:{color:"error"}})}finally{k(!1)}};o.useEffect(()=>{var b;if(w.length>0){const B=w.length>0?(b=w==null?void 0:w.reduce((s,t)=>new Date(t.launchDate)<new Date(s.launchDate)?t:s).launchDate)==null?void 0:b.split("T")[0]:new Date().toISOString().split("T")[0],v=[...O].filter(s=>new Date(s.summary)>=new Date(B));v.sort((s,t)=>new Date(s.summary)-new Date(t.summary));const G=[],je=Object.values(v.reduce((s,{game:t,ggrEuro:n,summary:u})=>{s[t]||(s[t]={name:t,data:[],totalGGR:0});const g=w.find(p=>p.name===t);return s[t].totalGGR+=new Date(g==null?void 0:g.launchDate)>new Date(u)?0:n,s[t].data.push(s[t].totalGGR.toFixed(2)),G.push(u.slice(0,10)),s},{})),Z=v.reduce((s,{summary:t,betsEuro:n,game:u})=>{const g=w.find(p=>p.name===u);if(new Date(g==null?void 0:g.launchDate)<=new Date(t)){const p=t.slice(0,10);s[p]||(s[p]=0),s[p]+=n}return s},{}),ue=[{name:"Total Coins Wagered",data:Object.entries(Z).sort(([s],[t])=>new Date(s)-new Date(t)).map(([s,t])=>Number(t.toFixed(2)))}];let i=0;const A=je.map(s=>(i=Math.max(i,s.data.length),{...s,data:Se(s.data)})).map(s=>{const t=P[0]-1,n=P[1]-1;return s.data=s.data.slice(t,n+1),s}),U=ue.map(s=>(i=Math.max(i,s.data.length),{...s,data:Se(s.data)})).map(s=>{const t=P[0]-1,n=P[1]-1;return s.data=s.data.slice(t,n+1),s});r(A),Ce(U);const L=[...new Set(G)];Re(L);const E=[];for(let s=P[0];s<=P[1];s++)E.push(`Day ${s}`);const F=O==null?void 0:O.map(s=>({...s,SPU:s.spins/s.uniquePlayers,CWPP:s.betsEuro/s.uniquePlayers}));M(F);const W=[];for(let s=0;s<14;s++)W.push(`Day ${s+1}`);f(s=>({...s,xaxis:{categories:W,labels:{show:!1}}})),Ae(vt(je));const Ue=Object.values(v.reduce((s,{game:t,summary:n,uniquePlayers:u})=>{s[t]||(s[t]={name:t,data:[]});const g=w.find(p=>p.name===t);return new Date(g==null?void 0:g.launchDate)<=new Date(n)&&s[t].data.push(u),s},{})).map(s=>{const t=P[0]-1,n=P[1]-1;return s.data=s.data.slice(t,n+1),s});tt(Ue);const $e=s=>{if(s.length<6)return[];let t=new Array(5).fill(0);for(let n=5;n<s.length;n++){let u=s.slice(n-4,n+1).reduce((C,z)=>C+z,0),g=s.slice(n-5,n).reduce((C,z)=>C+z,0),p=((u-g)/(g||1)*100).toFixed(2);t.push(p)}return t},ot=Object.values(v.reduce((s,{game:t,summary:n,uniquePlayers:u})=>{s[t]||(s[t]={name:t,data:[]});const g=w.find(p=>p.name===t);return new Date(g==null?void 0:g.launchDate)<=new Date(n)&&s[t].data.push(u),s},{})).map(s=>({...s,data:$e(s.data)})).map(s=>{const t=P[0]-1,n=P[1]-1;return s.data=s.data.slice(t,n+1),{...s,data:s.data}});st(ot);const dt=Object.values(v.reduce((s,{game:t,spins:n,summary:u})=>{s[t]||(s[t]={name:t,data:[]});const g=w.find(p=>p.name===t);return s[t].data.push(new Date(g==null?void 0:g.launchDate)>new Date(u)?0:n),s},{})).map(s=>{const t=P[0]-1,n=P[1]-1;return s.data=s.data.slice(t,n+1),{...s,data:Se(s.data)}});nt(dt);const xt=Object.values(v.reduce((s,{game:t,spins:n,uniquePlayers:u,summary:g})=>{s[t]||(s[t]={name:t,data:[]});const p=w.find(C=>C.name===t);return s[t].data.push(new Date(p==null?void 0:p.launchDate)>new Date(g)?0:(n/u).toFixed(2)),s},{})).map(s=>{const t=P[0]-1,n=P[1]-1;return s.data=s.data.slice(t,n+1),{...s,data:Se(s.data)}});X(E),T(s=>({...s,xaxis:{categories:E,labels:{show:!1}}})),ye(s=>({...s,xaxis:{categories:E,labels:{show:!1}},title:{text:"Daily Total Coins Wagered (All Games)",align:"center"},yaxis:{title:{text:"Total Coins"}}})),Fe(s=>({...s,xaxis:{categories:E,labels:{show:!1}}})),N(s=>({...s,xaxis:{categories:E,labels:{show:!1}}})),Le(s=>({...s,xaxis:{categories:E,labels:{show:!1}}})),Oe(s=>({...s,xaxis:{categories:E,labels:{show:!1}}})),at(xt);const Ze=Object.values(v.reduce((s,{game:t,summary:n,ggrEuro:u})=>{s[t]||(s[t]={name:t,data:[]}),w.find(z=>z.name===t);const g=v.filter(z=>z.game===t).reduce((z,xe)=>new Date(xe.summary)>new Date(z)?xe.summary:z,"1970-01-01"),p=new Date(g),C=new Date(p);return C.setDate(C.getDate()-6),new Date(n)>=C&&new Date(n)<=p&&s[t].data.push(u),s},{})),Je=v.reduce((s,t)=>new Date(t.summary)>new Date(s)?t.summary:s,"1970-01-01"),et=new Date(Je),ze=[];for(let s=6;s>=0;s--){const t=new Date(et);t.setDate(t.getDate()-s),ze.push(t.toISOString().split("T")[0])}_e(Ze),qe(s=>({...s,xaxis:{categories:ze,labels:{show:!0}},title:{text:"7 Day GGR",align:"center"}}))}},[O,Ne,w,P]);const Bt=async()=>{try{const b=await Me.post("api/account/check",{email:c?ee.email:de,password:he});localStorage.setItem("reportToken","true"),Y(!1),le(!1)}catch{Y(!0)}};return e.jsxs(Ht,{children:[e.jsx(pe,{children:!oe&&e.jsxs(te,{item:!0,xs:12,lg:12,children:[e.jsxs(j,{mb:3,spacing:1,display:"flex",flexDirection:"row",alignItems:"center",gap:2,justifyContent:"space-between",sx:{flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"}},children:[e.jsx(te,{item:!0,children:e.jsxs(j,{spacing:1,children:[e.jsxs(j,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:"center",children:[e.jsxs("label",{htmlFor:"contained-button-file",children:[e.jsx(bt,{accept:".xls,.xlsx",id:"contained-button-file",type:"file",onChange:Ft}),e.jsx(yt,{loading:I,variant:"contained",component:"span",children:"Upload Excel"})]}),e.jsx(yt,{sx:{marginLeft:{xs:0,sm:"10px"},marginTop:{xs:1,sm:0}},loading:V,variant:"contained",component:"span",onClick:Nt,children:"Download Excel"})]}),e.jsxs(j,{direction:{xs:"column",sm:"row"},spacing:1,alignItems:"center",children:[e.jsx(m,{variant:{xs:"subtitle2",sm:"subtitle1"},color:"textSecondary",children:"Latest Report Date:"}),e.jsx(m,{variant:{xs:"h6",sm:"h5"},sx:{color:"red",fontWeight:"bold"},children:Xe==null?void 0:Xe.split("T")[0]})]})]})}),e.jsxs(te,{gap:2,display:"flex",flexDirection:"row",alignItems:"center",sx:{flexDirection:{xs:"column",sm:"row"},gap:{xs:1,sm:2}},children:[e.jsx(m,{variant:{xs:"h6",sm:"h5"},textAlign:"center",children:"LAUNCH"}),e.jsxs(j,{direction:"row",spacing:1,flexWrap:"wrap",justifyContent:"center",children:[e.jsx(re,{Link:!0,to:c?"/admin/report-type/users/launch":"/report-type/users/launch",children:e.jsx(ae,{loading:I,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Users"})}),e.jsx(re,{to:c?"/admin/report-type/totalGGR/launch":"/report-type/totalGGR/launch",children:e.jsx(ae,{loading:I,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Total GGR"})}),e.jsx(re,{to:c?"/admin/report-type/spinsPerUser/launch":"/report-type/spinsPerUser/launch",children:e.jsx(ae,{loading:I,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Spins Per User"})}),e.jsx(re,{to:c?"/admin/report-type/totalCoins/launch":"/report-type/totalCoins/launch",children:e.jsx(ae,{loading:I,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Total Coins"})}),e.jsx(re,{to:c?"/admin/report-type/cwpp/launch":"/report-type/cwpp/launch",children:e.jsx(ae,{loading:I,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"CWPP"})})]})]})]}),e.jsx(j,{mb:3,spacing:1,display:"flex",flexDirection:"row",alignItems:"center",gap:2,justifyContent:"end",sx:{flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"stretch",sm:"center"}},children:e.jsxs(te,{gap:2,display:"flex",flexDirection:"row",alignItems:"center",sx:{flexDirection:{xs:"column",sm:"row"},gap:{xs:1,sm:2}},children:[e.jsx(m,{variant:{xs:"h6",sm:"h5"},textAlign:"center",children:"EXCLUSIVE"}),e.jsxs(j,{direction:"row",spacing:1,flexWrap:"wrap",justifyContent:"center",children:[e.jsx(re,{to:c?"/admin/report-type/users/exclusive":"/report-type/users/exclusive",children:e.jsx(ae,{loading:I,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Users"})}),e.jsx(re,{to:c?"/admin/report-type/totalGGR/exclusive":"/report-type/totalGGR/exclusive",children:e.jsx(ae,{loading:I,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Total GGR"})}),e.jsx(re,{to:c?"/admin/report-type/spinsPerUser/exclusive":"/report-type/spinsPerUser/exclusive",children:e.jsx(ae,{loading:I,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Spins Per User"})}),e.jsx(re,{to:c?"/admin/report-type/totalCoins/exclusive":"/report-type/totalCoins/exclusive",children:e.jsx(ae,{loading:I,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"Total Coins"})}),e.jsx(re,{to:c?"/admin/report-type/cwpp/exclusive":"/report-type/cwpp/exclusive",children:e.jsx(ae,{loading:I,variant:"contained",component:"span",sx:{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}},children:"CWPP"})})]})]})}),e.jsx(j,{mb:5,spacing:3,children:e.jsx(ls,{data:O,games:w})}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"Launch Information"}),e.jsx(be,{data:w,columns:Lt,setData:q})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"TOTAL REVENUE"}),e.jsx(be,{data:H,columns:kt,setData:q})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"7 Day Averages"}),e.jsx(be,{data:ge,columns:Ot,setData:q})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"7 Day Change (%) "}),e.jsx(be,{data:fe,columns:Ut,setData:q})]}),e.jsxs(j,{mb:5,direction:{xs:"column",sm:"row"},spacing:{xs:2,sm:3},alignItems:"center",justifyContent:"center",children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},children:"Time Period"}),e.jsx(rs,{getAriaLabel:()=>"Temperature range",value:P,max:Ct,min:1,onChange:Wt,valueLabelDisplay:"auto",valueLabelFormat:b=>`Day ${b}`,sx:{width:{xs:"90%",sm:"60%",md:"40%"}}})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"Total GGR"}),e.jsx(ve,{options:a,series:H,type:"line",height:500})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"7 DAY GGR"}),e.jsx(ve,{options:Qe,series:He,type:"line",height:500})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"Total Coins Wagered"}),e.jsx(ve,{options:ce,series:se,type:"line",height:500})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"USERS"}),e.jsx(ve,{options:Ie,series:J,type:"line",height:500})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"USER 5 Day Change (%)"}),e.jsx(ve,{options:me,series:Gt,type:"line",height:500})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"SPINS PER DAY"}),e.jsx(ve,{options:ne,series:Rt,type:"line",height:500})]}),e.jsxs(j,{mb:5,spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"SPINS PER PLAYER"}),e.jsx(ve,{options:ke,series:Tt,type:"line",height:500})]}),e.jsxs(j,{spacing:{xs:2,sm:3},children:[e.jsx(m,{variant:{xs:"h4",sm:"h3",md:"h2"},textAlign:"center",children:"14 DAY LAUNCH"}),e.jsx(ve,{options:Be,series:Pe,type:"line",height:500})]})]})}),e.jsx(qt,{open:oe,maxWidth:"xs",children:e.jsxs(_t,{sx:{p:1,py:1.5},children:[c?e.jsx(pt,{children:"Confirm Password"}):e.jsx(pt,{children:"Login"}),e.jsxs(zt,{children:[e.jsxs(j,{spacing:1,mb:2,children:[!c&&e.jsx(ht,{name:"email",placeholder:"Email",type:"email",fullWidth:!0,variant:"outlined",value:de,onChange:b=>l(b.target.value)}),e.jsx(ht,{name:"password",placeholder:"Password",type:"password",fullWidth:!0,variant:"outlined",value:he,onChange:b=>We(b.target.value)})]}),x&&c&&e.jsx(m,{variant:"h6",color:"red",children:"Password is wrong."}),x&&!c&&e.jsx(m,{variant:"h6",color:"red",children:"Credentials is wrong."}),"          "]}),e.jsx(Yt,{children:e.jsx(ae,{variant:"contained",onClick:Bt,children:"Confirm"})})]})})]})};export{be as ReactTable,Ls as default,Ke as separateByComma};
