import{P as Y,a3 as Dt,r as i,j as e,M as ae,aV as Ne,am as gt,G as _,p as G,T as j,L as Q,d as q,aB as yt,B as jt,aO as Ae,aP as ft,D as Ee,aS as mt,a9 as Ue,I as We,Z as wt,x as ye,H as Pe}from"./index-4ec2acc9.js";import{C as Gt}from"./ComponentSkeleton-8ac3d3ba.js";import{L as Oe}from"./LoadingButton-2e7379a8.js";import{_ as de}from"./react-apexcharts.min-88a424fd.js";import{u as St,S as Rt,f as Ie,b as Ct}from"./ScrollX-181e09c3.js";import"./Filter-5fb6b047.js";import{E as Pt,R as vt}from"./RowEditable-3288f1f7.js";import"./LinearWithLabel-a698b6a2.js";import{T as Tt,a as bt,b as Lt}from"./TableContainer-79f96d07.js";import{T as kt}from"./TableHead-1c1d5f27.js";import{T as $e}from"./TableRow-76b6232d.js";import{T as Fe}from"./TableCell-d56244c5.js";import{S as At}from"./Slider-8b4bda1e.js";import{S as Et}from"./SendOutlined-326b2503.js";import"./Skeleton-2744104e.js";import"./DownloadOutlined-9f1bb88f.js";import"./CaretUpOutlined-bbb0220c.js";import"./CaretDownOutlined-2840e58c.js";import"./Pagination-1c1c147a.js";import"./index-cbfabe50.js";import"./Checkbox-ea9a3331.js";import"./MinusOutlined-52ffbb38.js";import"./visuallyHidden-14c3de6e.js";const Ke=({row:x,table:d})=>{var T;const p=(T=d==null?void 0:d.options)==null?void 0:T.meta,z=B=>{p==null||p.setSelectedRow(O=>({...O,[x.id]:!O[x.id]})),p==null||p.revertData(x.index,(B==null?void 0:B.currentTarget.name)==="cancel")},L=()=>{p==null||p.saveData(x.index)};return e.jsxs(G,{direction:"row",spacing:1,alignItems:"center",children:[(p==null?void 0:p.selectedRow[x.id])&&e.jsx(Ue,{title:"Cancel",children:e.jsx(We,{color:"error",name:"cancel",onClick:z,children:e.jsx(wt,{})})}),e.jsx(Ue,{title:p!=null&&p.selectedRow[x.id]?"Save":"Edit",children:e.jsx(We,{color:p!=null&&p.selectedRow[x.id]?"success":"primary",onClick:p!=null&&p.selectedRow[x.id]?L:z,children:p!=null&&p.selectedRow[x.id]?e.jsx(Et,{}):e.jsx(Pt,{})})})]})};Ke.propTypes={row:Y.object,table:Y.object,options:Y.array,id:Y.number,index:Y.number};Y.node,Y.number,Y.number;const Me=Dt("input")({display:"none"});Me.displayName="Input";const je=x=>{let d=0,p=x.length-1;for(;d<x.length&&Number(x[d])===0;)d++;for(;p>=0&&Number(x[p])===0;)p--;return x.slice(d,p+1)},Ut=(x,d,p)=>x.map(L=>{const T=je(L.data);return{...L,data:T.slice(0,14)}}),ge=({getValue:x})=>{const d=x();return`${Number((d||0).toFixed(2)).toLocaleString()}`};function oe({columns:x,data:d,setData:p}){const[z,L]=i.useState(()=>[...d]),[T,B]=i.useState({}),O=St({data:d,columns:x,defaultColumn:{cell:vt},getCoreRowModel:Ct(),meta:{selectedRow:T,setSelectedRow:B,revertData:(g,w)=>{w?p(H=>H.map((f,F)=>F===g?z[g]:f)):L(H=>H.map((f,F)=>F===g?d[g]:f))},updateData:(g,w,H)=>{p(f=>f.map((F,u)=>u===g?{...f[g],[w]:H}:F))},saveData:async g=>{try{const w=d[g],H=await ye.put(`/api/launchGames/${w._id}`,w);Pe({open:!0,message:"Saved successfully!",variant:"alert",alert:{color:"success"}}),B(f=>({...f,[g]:!1}))}catch{Pe({open:!0,message:"Error!",variant:"alert",alert:{color:"error"}})}}},debugTable:!0});let V=[];return O.getAllColumns().map(g=>g.columnDef.accessorKey&&V.push({label:typeof g.columnDef.header=="string"?g.columnDef.header:"#",key:g.columnDef.accessorKey})),e.jsx(ae,{content:!1,children:e.jsx(Rt,{children:e.jsx(Tt,{children:e.jsxs(bt,{children:[e.jsx(kt,{children:O.getHeaderGroups().map(g=>e.jsx($e,{children:g.headers.map(w=>e.jsx(Fe,{...w.column.columnDef.meta,children:w.isPlaceholder?null:Ie(w.column.columnDef.header,w.getContext())},w.id))},g.id))}),e.jsx(Lt,{children:O.getRowModel().rows.map(g=>e.jsx($e,{children:g.getVisibleCells().map(w=>e.jsx(Fe,{...w.column.columnDef.meta,children:Ie(w.column.columnDef.cell,w.getContext())},w.id))},g.id))})]})})})})}oe.propTypes={columns:Y.array,data:Y.array,setData:Y.func};function Wt({data:x,games:d}){const p=Ne(),[z,L]=i.useState(p.pathname==="/admin/report"),[T,B]=i.useState([]),[O,V]=i.useState([]),[g,w]=i.useState([]);i.useEffect(()=>{const u=s=>{const o=s.getUTCMonth();return Math.floor(o/3)+1},h=s=>{const N=s.map(W=>new Date(W.summary)).sort((W,U)=>W-U),le=N[0],fe=N[N.length-1],X=le.getFullYear(),me=u(le),pe=fe.getFullYear(),we=u(fe),te=[];for(let W=X;W<=pe;W++)for(let U=1;U<=4;U++)if(!(W===X&&U<me)){if(W===pe&&U>we)break;te.push(`${W}-Q${U}`)}return te},I=[...new Set(x.map(s=>s.summary.split("-")[0]))];if(V(I),x&&x.length>0){const s=h(x);console.log("allQuarters",s),w(s)}const k=Object.values(x.reduce((s,{game:o,summary:N,betsEuro:le,winsEuro:fe,ggrEuro:X,avgBet:me,spins:pe,uniquePlayers:we})=>{s[o]||(s[o]={_id:"",name:o,maxDate:N,years:{},totalGGR:0,latestWeekStart:"",secLatestWeekStart:"",latestWeekGGR:[],secLatestWeekGGR:[],remainDays:0,weekAverage:0,weekChange:0,weekChangeColor:"",dailyTotalGGR:0,projectedTotalGGR:0});const te=d.find(W=>W.name===o);if(s[o].launchDate=te.launchDate,s[o]._id=te._id,new Date(te.launchDate)<=new Date(N)){const W=new Date(s[o].maxDate)<new Date(N);s[o].maxDate=W?N:s[o].maxDate,s[o].dailyTotalGGR=W?X:s[o].dailyTotalGGR,s[o].totalGGR+=X;const U=N.split("-")[0];s[o].years[U]||(s[o].years[U]=0),s[o].years[U]+=X,s[o][`totalGGR_${U}`]||(s[o][`totalGGR_${U}`]=0),s[o][`totalGGR_${U}`]+=X;const Ge=u(new Date(N)),he=`${U}-Q${Ge}`;s[o][`totalGGR_${he}`]||(s[o][`totalGGR_${he}`]=0),s[o][`totalGGR_${he}`]+=X;const Se=new Date(s[o].maxDate),ve=new Date(Se.getFullYear(),11,31);s[o].remainDays=Math.ceil((ve-Se)/(1e3*60*60*24));const Re=new Date(s[o].maxDate),ne=new Date(Re);ne.setDate(ne.getDate()-6);const ie=new Date(ne);ie.setDate(ie.getDate()-7);const xe=new Date(ne);xe.setDate(xe.getDate()-1),s[o].latestWeekStart=ne.toISOString().split("T")[0],s[o].secLatestWeekStart=ie.toISOString().split("T")[0],s[o].latestWeekGGR=x.filter(P=>P.game===o&&new Date(P.summary)>=ne&&new Date(P.summary)<=Re).map(P=>P.ggrEuro),s[o].secLatestWeekGGR=x.filter(P=>P.game===o&&new Date(P.summary)>=ie&&new Date(P.summary)<=xe).map(P=>P.ggrEuro),s[o].weekAverage=s[o].latestWeekGGR.reduce((P,Z)=>P+Z,0)/s[o].latestWeekGGR.length,s[o].weekChange=(s[o].latestWeekGGR.reduce((P,Z)=>P+Z,0)-s[o].secLatestWeekGGR.reduce((P,Z)=>P+Z,0))/s[o].secLatestWeekGGR.reduce((P,Z)=>P+Z,0)*100,s[o].weekChangeColor=e.jsx("span",{style:{color:s[o].weekChange>0?"green":"red"},children:`${Number(s[o].weekChange.toFixed(2)).toLocaleString()} %`}),s[o].projectedTotalGGR=s[o].totalGGR+s[o].weekAverage*s[o].remainDays}return s},{}));console.log("gameDatagameDatagameData",k),B(k)},[x,d]);const H=i.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text",cell:({getValue:u,row:h})=>{const I=u();return e.jsx(Q,{style:{textDecoration:"none"},to:z?`/admin/report-one/${h.original._id}`:`/report-one/${h.original._id}`,children:I})}},{header:"Launch Date",accessorKey:"launchDate",dataType:"text",cell:({getValue:u,row:h,table:I})=>{var s;const k=u();return`${(s=k==null?void 0:k.split("T"))==null?void 0:s[0]}`}},{header:"Daily Total GGR",accessorKey:"dailyTotalGGR",dataType:"text",cell:ge},{header:"Projected Total GGR",accessorKey:"projectedTotalGGR",dataType:"text",cell:ge},...(O==null?void 0:O.map(u=>({header:`Total GGR ${u}`,accessorKey:`totalGGR_${u}`,dataType:"text",cell:ge})))||[],{header:"Lifetime GGR",accessorKey:"totalGGR",dataType:"text",cell:ge},{header:"7 Day Average",accessorKey:"weekAverage",dataType:"text",cell:ge},{header:"7 Day Change",accessorKey:"weekChangeColor",dataType:"text"},{header:"Latest Report Date",accessorKey:"maxDate",dataType:"text",cell:({getValue:u,row:h,table:I})=>{var s;const k=u();return`${(s=k==null?void 0:k.split("T"))==null?void 0:s[0]}`}}],[O]),f=i.useMemo(()=>{const u=[];return g.forEach(h=>{const I={quarter:h};T.forEach(k=>{const s=k[`totalGGR_${h}`]!==void 0?Number(k[`totalGGR_${h}`].toFixed(2)).toLocaleString():0;console.log("gameTotalGGR",s),I[k.name]=s}),u.push(I)}),u},[g,T]),F=i.useMemo(()=>{const u=d.map(h=>h.name);return[{header:"Quarter",accessorKey:"quarter",dataType:"text"},...u.map(h=>({header:h,accessorKey:h,dataType:"number",cell:I=>I.getValue()??0}))]},[d]);return e.jsxs(_,{item:!0,xs:12,lg:12,children:[e.jsxs(_,{container:!0,spacing:2,mb:5,children:[e.jsx(_,{item:!0,xs:6,lg:3,children:e.jsx(ae,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(G,{direction:"row",spacing:1,alignItems:"end",justifyContent:"center",children:[e.jsx(j,{variant:"h5",textAlign:"center",children:"Lifetime GGR - "}),e.jsx(j,{variant:"h6",textAlign:"center",children:Number(T.reduce((u,h)=>u+h.totalGGR,0)).toLocaleString()})]})})}),e.jsx(_,{item:!0,xs:6,lg:3,children:e.jsx(ae,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(G,{direction:"row",spacing:1,alignItems:"end",justifyContent:"center",children:[e.jsx(j,{variant:"h5",textAlign:"center",children:"Daily Total GGR -"}),e.jsx(j,{variant:"h6",textAlign:"center",children:Number(T.reduce((u,h)=>u+h.dailyTotalGGR,0)).toLocaleString()})]})})}),e.jsx(_,{item:!0,xs:6,lg:3,children:e.jsx(ae,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(G,{direction:"row",spacing:1,alignItems:"end",justifyContent:"center",children:[e.jsx(j,{variant:"h5",textAlign:"center",children:"7 Day Average GGR -"}),e.jsx(j,{variant:"h6",textAlign:"center",children:Number(T.reduce((u,h)=>u+h.weekAverage,0)).toLocaleString()})]})})}),e.jsx(_,{item:!0,xs:6,lg:3,children:e.jsx(ae,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(G,{direction:"row",spacing:1,alignItems:"end",justifyContent:"center",children:[e.jsx(j,{variant:"h5",textAlign:"center",children:"7 Day Change -"}),e.jsx(j,{variant:"h6",textAlign:"center",children:T.reduce((u,h)=>u+h.weekChange,0).toFixed(2)+"%"})]})})}),e.jsx(_,{item:!0,xs:6,lg:3,children:e.jsx(ae,{sx:{height:"100%",display:"flex",alignItems:"center"},children:e.jsxs(G,{direction:"row",spacing:1,alignItems:"end",justifyContent:"center",children:[e.jsx(j,{variant:"h5",textAlign:"center",children:`Projected GGR ${O.reduce((u,h)=>Math.max(u,h),-1/0)} -`}),e.jsx(j,{variant:"h6",textAlign:"center",children:Number(T.reduce((u,h)=>u+h.projectedTotalGGR,0)).toLocaleString()})]})})}),e.jsx(_,{item:!0,xs:6,lg:3,children:e.jsx(ae,{sx:{height:"100%",display:"flex",alignItems:"center"},children:g==null?void 0:g.map((u,h)=>e.jsxs(G,{direction:"row",spacing:1,alignItems:"end",justifyContent:"start",children:[e.jsx(j,{variant:"h5",textAlign:"center",children:`Total GGR ${u} - `}),e.jsx(j,{variant:"h6",textAlign:"center",children:Number(T.reduce((I,k)=>I+(k[`totalGGR_${u}`]||0),0)).toLocaleString()})]},h))})})]}),e.jsxs(G,{mb:5,spacing:3,children:[e.jsx(j,{variant:"h2",textAlign:"center",children:"Games Data"}),e.jsx(oe,{data:T,columns:H})]}),e.jsxs(G,{mb:5,spacing:3,children:[e.jsx(j,{variant:"h2",textAlign:"center",children:"TOTAL GGR - QAUTER"}),e.jsx(oe,{data:f,columns:F,setData:()=>{}})]})]})}const ue={chart:{height:100,type:"line",zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"straight",width:3},xaxis:{categories:[]}},cn=()=>{const x=Ne(),[d,p]=i.useState(x.pathname==="/admin/report"),{user:z}=gt();i.useState(0);const[L,T]=i.useState(!1),[B,O]=i.useState(!1),[V,g]=i.useState([]),[w,H]=i.useState([]),[f,F]=i.useState([]),[u,h]=i.useState(!0),[I,k]=i.useState(""),[s,o]=i.useState(""),[N,le]=i.useState(!1),[fe,X]=i.useState([]),[me,pe]=i.useState([]),[we,te]=i.useState([]),[W,U]=i.useState([]),[Ge,he]=i.useState([]),[Se,ve]=i.useState(ue),[Re,ne]=i.useState(ue),[ie,xe]=i.useState(ue),[P,Z]=i.useState(ue),[_e,qe]=i.useState(ue),[Qe,Ot]=i.useState(new Date().toISOString().split("T")[0]),[Ye,Be]=i.useState([]),[Ve,He]=i.useState(ue),[Xe,ze]=i.useState([]),[Ze,Je]=i.useState([]),[et,tt]=i.useState([]),[nt,st]=i.useState([]),[$,be]=i.useState([1,37]),[at,rt]=i.useState(0),ot=(D,A)=>{console.log("newRange",A),be(A)},lt=i.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"Launch Date",accessorKey:"launchDate",dataType:"date",cell:({getValue:D,row:A,table:c})=>{var n,a;const E=(n=c==null?void 0:c.options)==null?void 0:n.meta,J=(a=E==null?void 0:E.selectedRow)==null?void 0:a[A.id],se=D(),re=se?new Date(se).toISOString().split("T")[0]:"";return J?e.jsx("input",{type:"date",value:re,onChange:r=>E==null?void 0:E.updateData(A.index,"launchDate",r.target.value)}):re}},{header:"Actions",id:"edit",cell:Ke,meta:{className:"cell-center"}}],[]),it=i.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"TOTAL GGR",accessorKey:"data",dataType:"text",cell:({getValue:D,row:A,table:c})=>{const E=D();return`${(Number(E[E.length-1])||0).toLocaleString()}`}}],[]),Le=i.useMemo(()=>[{header:"Game",accessorKey:"name",dataType:"text"},{header:"GGR",accessorKey:"ggrEuro",dataType:"text"},{header:"SPINS",accessorKey:"spins",dataType:"text"},{header:"USERS",accessorKey:"uniquePlayers",dataType:"text"},{header:"SPU",accessorKey:"SPU",dataType:"text"},{header:"CWPP",accessorKey:"CWPP",dataType:"text"}],[]);i.useEffect(()=>{const D=[];for(let n=0;n<7;n++){const a=new Date;a.setDate(a.getDate()-n),D.push(a.toISOString().split("T")[0])}const A=w.reduce((n,{game:a,summary:r})=>{if(!n[a]){const S=f.find(R=>R.name===a);n[a]={...S,maxDate:r}}const y=new Date(n[a].maxDate)<new Date(r);return n[a].maxDate=y?r:n[a].maxDate,n},{}),c={},J=Object.values(w.reduce((n,{game:a,summary:r,ggrEuro:y,spins:S,uniquePlayers:R,betsEuro:v})=>{n[a]||(n[a]={name:a,ggrEuro:[],spins:[],uniquePlayers:[],SPU:[],CWPP:[]});const C=f.find(Ce=>Ce.name===a);new Date(C==null?void 0:C.launchDate)<new Date(r),c[a]&&new Date(c[a])<new Date(r.split("T")[0])?c[a]=r.split("T")[0]:c[a]||(c[a]=r.split("T")[0]);const ee=new Date(A[a].maxDate)||new Date,ce=new Date(ee);return ce.setDate(ce.getDate()-6),new Date(r)>=ce&&new Date(r)<=ee&&(n[a].ggrEuro.push(y),n[a].spins.push(S),n[a].uniquePlayers.push(R),n[a].SPU.push(S/R),n[a].CWPP.push(v/R)),n},{})).map(n=>{const a=n.ggrEuro,r=n.spins,y=n.uniquePlayers,S=n.SPU,R=n.CWPP;return{name:n.name,ggrEuro:Number((a.length>0?a.reduce((v,C)=>v+C,0)/a.length:0).toFixed(2)).toLocaleString(),spins:Number((r.length>0?r.reduce((v,C)=>v+C,0)/r.length:0).toFixed(2)).toLocaleString(),uniquePlayers:Number((y.length>0?y.reduce((v,C)=>v+C,0)/y.length:0).toFixed(2)).toLocaleString(),SPU:Number((S.length>0?S.reduce((v,C)=>v+C,0)/S.length:0).toFixed(2)).toLocaleString(),CWPP:Number((R.length>0?R.reduce((v,C)=>v+C,0)/R.length:0).toFixed(2)).toLocaleString()}});te(J);const re=Object.values(w.reduce((n,{game:a,summary:r,ggrEuro:y,spins:S,uniquePlayers:R,betsEuro:v})=>{n[a]||(n[a]={name:a,ggrEuros:[],ggrEuro:0,ggrEuro2:0,spins:0,spins2:0,uniquePlayers:0,uniquePlayers2:0,SPU:0,SPU2:0,CWPP:0,CWPP2:0,arrSpins:[],arrSpins2:[]});const C=new Date(c[a]);C.setDate(C.getDate()-7);const ee=new Date(c[a]);return ee.setDate(ee.getDate()-14),C<new Date(r)?(n[a].ggrEuros.push(y),n[a].arrSpins.push(S),n[a].ggrEuro+=y,n[a].spins+=S,n[a].uniquePlayers+=R,n[a].SPU+=S/R,n[a].CWPP+=v/R):ee<new Date(r)&&new Date(r)<=C&&(n[a].arrSpins2.push(S),n[a].ggrEuro2+=y,n[a].spins2+=S,n[a].uniquePlayers2+=R,n[a].SPU2+=S/R,n[a].CWPP2+=v/R),n},{})).map(n=>{const a=(n.ggrEuro-n.ggrEuro2)/(n.ggrEuro2||1),r=(n.spins-n.spins2)/(n.spins2||1),y=(n.uniquePlayers-n.uniquePlayers2)/(n.uniquePlayers2||1),S=(n.SPU-n.SPU2)/(n.SPU2||1),R=(n.CWPP-n.CWPP2)/(n.CWPP2||1);return{name:n.name,ggrEuro:e.jsx("span",{style:{color:a>=0?"green":"red"},children:`${(a*100).toFixed(2)} %`}),spins:e.jsx("span",{style:{color:r>=0?"green":"red"},children:`${(r*100).toFixed(2)} %`}),uniquePlayers:e.jsx("span",{style:{color:y>=0?"green":"red"},children:`${(y*100).toFixed(2)} %`}),SPU:e.jsx("span",{style:{color:S>=0?"green":"red"},children:`${(S*100).toFixed(2)} %`}),CWPP:e.jsx("span",{style:{color:R>=0?"green":"red"},children:`${(R*100).toFixed(2)} %`})}});U(re)},[me,w,f]);const ke=async()=>{var D,A;try{const c=await ye.get("api/reports");if(console.log("response.data.data",c.data.data),console.log("response.data.setGames",c.data.games),g(c.data.data),F(c.data.games),c.data.games.length>0){const E=c.data.games.length>0?(A=(D=c.data.games)==null?void 0:D.reduce((r,y)=>new Date(y.launchDate)<new Date(r.launchDate)?y:r).launchDate)==null?void 0:A.split("T")[0]:new Date().toISOString().split("T")[0],J=[...c.data.data].filter(r=>new Date(r.summary)>=new Date(E));J.sort((r,y)=>new Date(r.summary)-new Date(y.summary));const se=[],re=Object.values(J.reduce((r,{game:y,ggrEuro:S,summary:R})=>{r[y]||(r[y]={name:y,data:[],totalGGR:0});const v=c.data.games.find(C=>C.name===y);return r[y].totalGGR+=new Date(v==null?void 0:v.launchDate)>new Date(R)?0:S,r[y].data.push(r[y].totalGGR.toFixed(2)),se.push(R.slice(0,10)),r},{}));let n=0;const a=re.map(r=>(n=Math.max(n,r.data.length),{...r,data:je(r.data)}));console.log("min, max",n),rt(n),be([1,n])}}catch{}},ct=async()=>{const D=localStorage.getItem("reportToken");h(D!=="true"),ke()};i.useEffect(()=>{ct()},[]);const dt=async D=>{if(D.target.files.length>0){const A=D.target.files[0];if(!A){alert("Please select a file first.");return}T(!0);const c=new FormData;c.append("file",A);try{const E=await ye.post("api/reports/upload",c,{headers:{"Content-Type":"multipart/form-data"}});Pe({open:!0,message:"Excel uploaded successfully!",variant:"alert",alert:{color:"success"}}),ke(),T(!0)}catch(E){console.error("Upload Error:",E),alert("Error uploading file.")}finally{T(!1),D.target.value=""}}},ut=async()=>{O(!0);try{const D=await ye.get("api/reports/download",{responseType:"blob"}),A=window.URL.createObjectURL(new Blob([D.data])),c=document.createElement("a");c.href=A,c.setAttribute("download","report.xlsx"),document.body.appendChild(c),c.click(),document.body.removeChild(c)}catch(D){console.error("Download Error:",D),Pe({open:!0,message:"Excel not exists!",variant:"alert",alert:{color:"error"}})}finally{O(!1)}};i.useEffect(()=>{var D;if(f.length>0){const A=f.length>0?(D=f==null?void 0:f.reduce((t,l)=>new Date(l.launchDate)<new Date(t.launchDate)?l:t).launchDate)==null?void 0:D.split("T")[0]:new Date().toISOString().split("T")[0],c=[...V].filter(t=>new Date(t.summary)>=new Date(A));c.sort((t,l)=>new Date(t.summary)-new Date(l.summary));const E=[],J=Object.values(c.reduce((t,{game:l,ggrEuro:m,summary:M})=>{t[l]||(t[l]={name:l,data:[],totalGGR:0});const b=f.find(K=>K.name===l);return t[l].totalGGR+=new Date(b==null?void 0:b.launchDate)>new Date(M)?0:m,t[l].data.push(t[l].totalGGR.toFixed(2)),E.push(M.slice(0,10)),t},{}));let se=0;const n=J.map(t=>(se=Math.max(se,t.data.length),{...t,data:je(t.data)})).map(t=>{const l=$[0]-1,m=$[1]-1;return t.data=t.data.slice(l,m+1),t});he(n);const a=[...new Set(E)];pe(a);const r=[];for(let t=$[0];t<=$[1];t++)r.push(`Day ${t}`);const y=V==null?void 0:V.map(t=>({...t,SPU:t.spins/t.uniquePlayers,CWPP:t.betsEuro/t.uniquePlayers}));H(y);const S=[];for(let t=0;t<14;t++)S.push(`Day ${t+1}`);He(t=>({...t,xaxis:{categories:S,labels:{show:!1}}})),Be(Ut(J));const v=Object.values(c.reduce((t,{game:l,summary:m,uniquePlayers:M})=>{t[l]||(t[l]={name:l,data:[]});const b=f.find(K=>K.name===l);return new Date(b==null?void 0:b.launchDate)<=new Date(m)&&t[l].data.push(M),t},{})).map(t=>{const l=$[0]-1,m=$[1]-1;return t.data=t.data.slice(l,m+1),t});console.log("filterUsersData1",v),ze(v);const C=t=>{if(t.length<6)return[];let l=new Array(5).fill(0);for(let m=5;m<t.length;m++){let M=t.slice(m-4,m+1).reduce((De,Te)=>De+Te,0),b=t.slice(m-5,m).reduce((De,Te)=>De+Te,0),K=((M-b)/(b||1)*100).toFixed(2);l.push(K)}return l},ee=Object.values(c.reduce((t,{game:l,summary:m,uniquePlayers:M})=>{t[l]||(t[l]={name:l,data:[]});const b=f.find(K=>K.name===l);return new Date(b==null?void 0:b.launchDate)<=new Date(m)&&t[l].data.push(M),t},{})),ce=ee.map(t=>({...t,data:C(t.data)}));console.log("usersData2",ce);const Ce=ce.map(t=>{const l=$[0]-1,m=$[1]-1;return t.data=t.data.slice(l,m+1),{...t,data:t.data}});console.log("filterUserChangesData",Ce),Je(Ce),console.log("usersData",ee);const ht=Object.values(c.reduce((t,{game:l,spins:m,summary:M})=>{t[l]||(t[l]={name:l,data:[]});const b=f.find(K=>K.name===l);return t[l].data.push(new Date(b==null?void 0:b.launchDate)>new Date(M)?0:m),t},{})).map(t=>{const l=$[0]-1,m=$[1]-1;return t.data=t.data.slice(l,m+1),{...t,data:je(t.data)}});tt(ht);const xt=Object.values(c.reduce((t,{game:l,spins:m,uniquePlayers:M,summary:b})=>{t[l]||(t[l]={name:l,data:[]});const K=f.find(De=>De.name===l);return t[l].data.push(new Date(K==null?void 0:K.launchDate)>new Date(b)?0:(m/M).toFixed(2)),t},{})).map(t=>{const l=$[0]-1,m=$[1]-1;return t.data=t.data.slice(l,m+1),{...t,data:je(t.data)}});X(r),console.log("days",r),ve(t=>({...t,xaxis:{categories:r,labels:{show:!1}}})),ne(t=>({...t,xaxis:{categories:r,labels:{show:!1}}})),xe(t=>({...t,xaxis:{categories:r,labels:{show:!1}}})),Z(t=>({...t,xaxis:{categories:r,labels:{show:!1}}})),qe(t=>({...t,xaxis:{categories:r,labels:{show:!1}}})),st(xt)}},[V,Qe,f,$]);const pt=async()=>{try{const D=await ye.post("api/account/check",{email:d?z.email:s,password:I});localStorage.setItem("reportToken","true"),le(!1),h(!1)}catch{le(!0)}};return e.jsxs(Gt,{children:[e.jsx(ae,{children:!u&&e.jsxs(_,{item:!0,xs:12,lg:12,children:[e.jsxs(G,{mb:3,spacing:1,display:"flex",flexDirection:"row",alignItems:"center",gap:2,justifyContent:"space-between",children:[e.jsxs(_,{item:!0,children:[e.jsxs("label",{htmlFor:"contained-button-file",children:[e.jsx(Me,{accept:".xls,.xlsx",id:"contained-button-file",type:"file",onChange:dt}),e.jsx(Oe,{loading:L,variant:"contained",component:"span",children:"Upload Excel"})]}),e.jsx(Oe,{sx:{marginLeft:"10px"},loading:B,variant:"contained",component:"span",onClick:ut,children:"Download Excel"})]}),e.jsxs(_,{sx:{marginTop:"0px !important"},gap:2,display:"flex",flexDirection:"row",alignItems:"center",children:[e.jsx(j,{variant:"h5",textAlign:"right",children:"LAUNCH"}),e.jsx(Q,{Link:!0,to:d?"/admin/report-type/users/launch":"/report-type/users/launch",children:e.jsx(q,{loading:L,variant:"contained",component:"span",children:"Users"})}),e.jsx(Q,{to:d?"/admin/report-type/totalGGR/launch":"/report-type/totalGGR/launch",children:e.jsx(q,{loading:L,variant:"contained",component:"span",children:"Total GGR"})}),e.jsx(Q,{to:d?"/admin/report-type/spinsPerUser/launch":"/report-type/spinsPerUser/launch",children:e.jsx(q,{loading:L,variant:"contained",component:"span",children:"Spins Per User"})}),e.jsx(Q,{to:d?"/admin/report-type/totalCoins/launch":"/report-type/totalCoins/launch",children:e.jsx(q,{loading:L,variant:"contained",component:"span",children:"Total Coins"})}),e.jsx(Q,{to:d?"/admin/report-type/cwpp/launch":"/report-type/cwpp/launch",children:e.jsx(q,{loading:L,variant:"contained",component:"span",children:"CWPP"})})]})]}),e.jsx(G,{mb:3,spacing:1,display:"flex",flexDirection:"row",alignItems:"center",gap:2,justifyContent:"end",children:e.jsxs(_,{sx:{marginTop:"0px !important"},gap:2,display:"flex",flexDirection:"row",alignItems:"center",children:[e.jsx(j,{variant:"h5",textAlign:"right",children:"EXCLUSIVE"}),e.jsx(Q,{to:d?"/admin/report-type/users/exclusive":"/report-type/users/exclusive",children:e.jsx(q,{loading:L,variant:"contained",component:"span",children:"Users"})}),e.jsx(Q,{to:d?"/admin/report-type/totalGGR/exclusive":"/report-type/totalGGR/exclusive",children:e.jsx(q,{loading:L,variant:"contained",component:"span",children:"Total GGR"})}),e.jsx(Q,{to:d?"/admin/report-type/spinsPerUser/exclusive":"/report-type/spinsPerUser/exclusive",children:e.jsx(q,{loading:L,variant:"contained",component:"span",children:"Spins Per User"})}),e.jsx(Q,{to:d?"/admin/report-type/totalCoins/exclusive":"/report-type/totalCoins/exclusive",children:e.jsx(q,{loading:L,variant:"contained",component:"span",children:"Total Coins"})}),e.jsx(Q,{to:d?"/admin/report-type/cwpp/exclusive":"/report-type/cwpp/exclusive",children:e.jsx(q,{loading:L,variant:"contained",component:"span",children:"CWPP"})})]})}),e.jsx(G,{mb:5,spacing:3,children:e.jsx(Wt,{data:V,games:f})}),e.jsxs(G,{mb:5,spacing:3,children:[e.jsx(j,{variant:"h2",textAlign:"center",children:"Launch Information"}),e.jsx(oe,{data:f,columns:lt,setData:F})]}),e.jsxs(G,{mb:5,spacing:3,children:[e.jsx(j,{variant:"h2",textAlign:"center",children:"TOTAL REVENUE"}),e.jsx(oe,{data:Ge,columns:it,setData:F})]}),e.jsxs(G,{mb:5,spacing:3,children:[e.jsx(j,{variant:"h2",textAlign:"center",children:"7 Day Averages"}),e.jsx(oe,{data:we,columns:Le,setData:F})]}),e.jsxs(G,{mb:5,spacing:3,children:[e.jsx(j,{variant:"h2",textAlign:"center",children:"7 Day Change (%) "}),e.jsx(oe,{data:W,columns:Le,setData:F})]}),e.jsxs(G,{mb:5,direction:"row",spacing:3,alignItems:"center",justifyContent:"center",children:[e.jsx(j,{variant:"h2",children:"Time Period"}),e.jsx(At,{getAriaLabel:()=>"Temperature range",value:$,max:at,min:1,onChange:ot,valueLabelDisplay:"auto",valueLabelFormat:D=>`Day ${D}`,sx:{width:"40%"}})]}),e.jsxs(G,{mb:5,children:[e.jsx(j,{variant:"h2",textAlign:"center",children:"Total GGR"}),e.jsx(de,{options:Se,series:Ge,type:"line",height:500})]}),e.jsxs(G,{mb:5,children:[e.jsx(j,{variant:"h2",textAlign:"center",children:"USERS"}),e.jsx(de,{options:Re,series:Xe,type:"line",height:500})]}),e.jsxs(G,{mb:5,children:[e.jsx(j,{variant:"h2",textAlign:"center",children:"USER 5 Day Change (%)"}),e.jsx(de,{options:ie,series:Ze,type:"line",height:500})]}),e.jsxs(G,{mb:5,children:[e.jsx(j,{variant:"h2",textAlign:"center",children:"SPINS PER DAY"}),e.jsx(de,{options:P,series:et,type:"line",height:500})]}),e.jsxs(G,{mb:5,children:[e.jsx(j,{variant:"h2",textAlign:"center",children:"SPINS PER PLAYER"}),e.jsx(de,{options:_e,series:nt,type:"line",height:500})]}),e.jsxs(G,{children:[e.jsx(j,{variant:"h2",textAlign:"center",children:"14 DAY LAUNCH"}),e.jsx(de,{options:Ve,series:Ye,type:"line",height:500})]})]})}),e.jsx(yt,{open:u,maxWidth:"xs",children:e.jsxs(jt,{sx:{p:1,py:1.5},children:[d?e.jsx(Ae,{children:"Confirm Password"}):e.jsx(Ae,{children:"Login"}),e.jsxs(ft,{children:[e.jsxs(G,{spacing:1,mb:2,children:[!d&&e.jsx(Ee,{name:"email",placeholder:"Email",type:"email",fullWidth:!0,variant:"outlined",value:s,onChange:D=>o(D.target.value)}),e.jsx(Ee,{name:"password",placeholder:"Password",type:"password",fullWidth:!0,variant:"outlined",value:I,onChange:D=>k(D.target.value)})]}),N&&d&&e.jsx(j,{variant:"h6",color:"red",children:"Password is wrong."}),N&&!d&&e.jsx(j,{variant:"h6",color:"red",children:"Credentials is wrong."}),"          "]}),e.jsx(mt,{children:e.jsx(q,{variant:"contained",onClick:pt,children:"Confirm"})})]})})]})};export{oe as ReactTable,cn as default,ge as separateByComma};
