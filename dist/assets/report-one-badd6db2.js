import{y as I,z as J,r as u,j as a,M as Q,G as K,p as g,d as X,T as S,x as Y}from"./index-d0b17951.js";import{_ as B}from"./react-apexcharts.min-7beaa26f.js";import{C as Z}from"./ComponentSkeleton-f03cc944.js";import{separateByComma as i}from"./report-603af492.js";import{R as ee}from"./ReactFixedHeaderTable-0a4a1867.js";import{T as ae,a as P}from"./ToggleButtonGroup-4dc7f3b6.js";import"./Skeleton-84a6586b.js";import"./LoadingButton-45879bf8.js";import"./ScrollX-00dab5a6.js";import"./Filter-45f8d73b.js";import"./DownloadOutlined-848f0ea3.js";import"./CaretUpOutlined-6d609e45.js";import"./CaretDownOutlined-b5faa291.js";import"./TableRow-268bbf52.js";import"./TableCell-345434c5.js";import"./Pagination-71b20370.js";import"./index-68b0537f.js";import"./Checkbox-9309c8e8.js";import"./MinusOutlined-d0cda07d.js";import"./RowEditable-5084598a.js";import"./LinearWithLabel-6febc93f.js";import"./Slider-e8b8f8e8.js";import"./visuallyHidden-14c3de6e.js";import"./TableContainer-75c619ee.js";import"./TableHead-8e2726af.js";import"./SendOutlined-76e046b2.js";const te={chart:{height:100,type:"line",zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{curve:"straight",width:3},xaxis:{categories:[]}},Ae=()=>{var w,A,R,U;const{id:q}=I(),k=J(),[se,O]=u.useState(null),[$,f]=u.useState([]),[o,D]=u.useState([]),[m,T]=u.useState(te),[_,M]=u.useState("all"),[h,z]=u.useState([]),[n,L]=u.useState([]),V=u.useMemo(()=>[{header:"",accessorKey:"day",dataType:"text",cell:({getValue:c,row:l})=>{const t=l.original.isSeparator;return a.jsx("div",{style:{textWrap:"nowrap",fontWeight:t?"bold":"normal",backgroundColor:t?"#f0f0f0":"transparent",padding:t?"8px":"0",textAlign:"center"},children:c()})}},{header:"Game",accessorKey:"game",dataType:"text",cell:({getValue:c})=>a.jsx("div",{style:{textWrap:"nowrap"},children:c()})},{header:"Bets Euro",accessorKey:"betsEuro",dataType:"text",cell:i},{header:"Wins Euro",accessorKey:"winsEuro",dataType:"text",cell:i},{header:"GGR Euro",accessorKey:"ggrEuro",dataType:"text",cell:i},{header:"Avg Bet",accessorKey:"avgBet",dataType:"text",cell:i},{header:"Spins",accessorKey:"spins",dataType:"text",cell:i},{header:"Unique Players",accessorKey:"uniquePlayers",dataType:"text",cell:i},{header:"Total GGR",accessorKey:"totalGGR",dataType:"text",cell:i},{header:"Spins Per User",accessorKey:"spinsPerUser",dataType:"text",cell:i},{header:"Coins Wagered Per User",accessorKey:"coinsWageredPerUser",dataType:"text",cell:i},{header:"Total Coins Wagered",accessorKey:"totalCoinsWagered",dataType:"text",cell:i}],[]);u.useEffect(()=>{(async()=>{const l=await Y.get(`/api/reports/${q}`);if(l.status===200){const t=l.data.game,s=l.data.reports,d=[...s].filter(e=>new Date(e.summary)<new Date(t==null?void 0:t.launchDate)),x=[...s].filter(e=>new Date(e.summary)>=new Date(t==null?void 0:t.launchDate));d.sort((e,r)=>new Date(e.summary)-new Date(r.summary)),x.sort((e,r)=>new Date(e.summary)-new Date(r.summary));const C=[...d,...x],v=Object.values(C.reduce((e,{game:r,ggrEuro:p,summary:j,uniquePlayers:N})=>(e[r]||(e[r]={name:r,data:[],totalGGR:0,dataSum:[]}),e[r].totalGGR+=p,e[r].dataSum.push(e[r].totalGGR.toFixed(2)),e[r].data.push(N),e),{}));if(v.length>0){D(v),L(v);const e=v[0].data.length;T({...m,xaxis:{categories:Array.from({length:e},(r,p)=>`Day ${p+1}`),labels:{show:!1}}})}O(t);let G=0,b=0,E=0,W=1;const y=[];d.forEach((e,r)=>{G+=e.ggrEuro,b+=e.betsEuro,E+=e.betsEuro;const p=e.spins/e.uniquePlayers,j=e.betsEuro/e.uniquePlayers;y.push({day:`Exclusive Day ${r+1}`,totalGGR:G,totalCoins:b,spinsPerUser:p,coinsWageredPerUser:j,totalCoinsWagered:E,...e})}),d.length>0&&y.push({day:"--- LAUNCH DATA ---",game:"",betsEuro:"",winsEuro:"",ggrEuro:"",avgBet:"",spins:"",uniquePlayers:"",totalGGR:"",spinsPerUser:"",coinsWageredPerUser:"",totalCoinsWagered:"",isSeparator:!0}),x.forEach((e,r)=>{G+=e.ggrEuro,b+=e.betsEuro,E+=e.betsEuro;const p=e.spins/e.uniquePlayers,j=e.betsEuro/e.uniquePlayers;y.push({day:`Day ${W}`,totalGGR:G,totalCoins:b,spinsPerUser:p,coinsWageredPerUser:j,totalCoinsWagered:E,...e}),W++}),console.log(y),z(y),f(y)}})()},[]);const F=c=>{if(h.length){if(c==="all")f(h),D(n);else if(c==="exclusive"){const l=h.filter(s=>s.day.includes("Exclusive Day")||s.isSeparator);f(l);const t=h.filter(s=>s.day.includes("Exclusive Day")).length;if(n.length>0){const s=[{...n[0],data:n[0].data.slice(0,t),dataSum:n[0].dataSum.slice(0,t)}];D(s),T({...m,xaxis:{categories:Array.from({length:t},(d,x)=>`Exclusive Day ${x+1}`),labels:{show:!1}}})}}else if(c==="launch"){const l=h.filter(s=>s.day.includes("Day ")&&!s.day.includes("Exclusive Day")&&!s.isSeparator);f(l);const t=h.filter(s=>s.day.includes("Exclusive Day")).length;if(n.length>0){const s=[{...n[0],data:n[0].data.slice(t),dataSum:n[0].dataSum.slice(t)}];D(s);const d=n[0].data.length-t;T({...m,xaxis:{categories:Array.from({length:d},(x,C)=>`Day ${C+1}`),labels:{show:!1}}})}}}},H=(c,l)=>{l!==null&&(M(l),F(l))};return a.jsx(Z,{children:a.jsx(Q,{title:"",children:a.jsxs(K,{item:!0,xs:12,lg:12,children:[a.jsx(g,{mb:3,spacing:1,children:a.jsx(K,{item:!0,children:a.jsx(X,{variant:"contained",onClick:()=>k(-1),children:"Back"})})}),a.jsxs(g,{mb:3,spacing:2,alignItems:"center",children:[a.jsx(S,{variant:"h6",textAlign:"center",children:"Data View Options"}),a.jsxs(ae,{value:_,exclusive:!0,onChange:H,"aria-label":"data view selection",sx:{"& .MuiToggleButton-root":{fontSize:{xs:"0.75rem",sm:"0.875rem"},padding:{xs:"6px 12px",sm:"8px 16px"}}},children:[a.jsx(P,{value:"all","aria-label":"all data",children:"All Data"}),a.jsx(P,{value:"exclusive","aria-label":"exclusive data",children:"Exclusive Data"}),a.jsx(P,{value:"launch","aria-label":"launch data",children:"Launch Data"})]})]}),a.jsxs(g,{mb:5,children:[a.jsx(S,{variant:"h2",textAlign:"center",children:"User Per Day Graph"}),a.jsx(B,{options:m,series:[{name:(w=o==null?void 0:o[0])==null?void 0:w.name,data:(A=o==null?void 0:o[0])==null?void 0:A.data}],type:"line",height:500})]}),a.jsxs(g,{mb:5,children:[a.jsx(S,{variant:"h2",textAlign:"center",children:"Total GGR Graph"}),a.jsx(B,{options:m,series:[{name:(R=o==null?void 0:o[0])==null?void 0:R.name,data:(U=o==null?void 0:o[0])==null?void 0:U.dataSum}],type:"line",height:500})]}),a.jsxs(g,{mb:5,spacing:3,children:[a.jsx(S,{variant:"h2",textAlign:"center",children:"Game Data"}),a.jsx(ee,{data:$,columns:V,setData:()=>{},height:"600px"})]})]})})})};export{Ae as default};
